<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.78.2"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Dubbo Integrates with Nacos to Become a Registry | Apache Dubbo</title><meta property="og:title" content="Dubbo Integrates with Nacos to Become a Registry"><meta property="og:description" content="This article introduces how to use Nacos in Dubbo application."><meta property="og:type" content="article"><meta property="og:url" content="/blog/2018/11/07/dubbo-integrates-with-nacos-to-become-a-registry/"><meta property="article:published_time" content="2018-11-07T00:00:00+00:00"><meta property="article:modified_time" content="2020-11-18T12:22:31+08:00"><meta property="og:site_name" content="Apache Dubbo"><meta itemprop=name content="Dubbo Integrates with Nacos to Become a Registry"><meta itemprop=description content="This article introduces how to use Nacos in Dubbo application."><meta itemprop=datePublished content="2018-11-07T00:00:00+00:00"><meta itemprop=dateModified content="2020-11-18T12:22:31+08:00"><meta itemprop=wordCount content="1806"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Dubbo Integrates with Nacos to Become a Registry"><meta name=twitter:description content="This article introduces how to use Nacos in Dubbo application."><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-112489517-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><link rel=preload href=/scss/main.min.7b6e720573a9e91e946ab0a302450a2e3baad4af648f63bdc75f35544f351ca8.css as=style><link href=/scss/main.min.7b6e720573a9e91e946ab0a302450a2e3baad4af648f63bdc75f35544f351ca8.css rel=stylesheet integrity><script src=/js/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css></head><body class="td-page td-blog"><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 321.39 78.54"><title id="title19">DUBBO LOGO</title><path class="cls-1" d="M68.46 50.38c0 14.06 11.39 22.11 25.45 22.11s25.45-8.05 25.45-22.11V7.25H68.46zm21.24-28h8.6V31H89.7zm0 22.25h8.6v8.6H89.7zM33.24 7.25H4.06v64H33.24c10.95.0 19.3-7.18 23.29-17.15a45.12 45.12.0 002.38-14.87A45.12 45.12.0 0056.53 24.4C52.84 14.62 44.19 7.25 33.24 7.25zm.43 14.63H30.34a3.44 3.44.0 00-3.44 3.44V53.23a3.44 3.44.0 003.44 3.44h3.33v4.63h-8.3a6.87 6.87.0 01-6.87-6.87V24.12a6.87 6.87.0 016.87-6.87h8.3zM285.51 6.06c-17.05.0-30.88 10.28-30.88 33.21s13.83 33.21 30.88 33.21 30.88-10.28 30.88-33.21S302.56 6.06 285.51 6.06zm7.59 48.36a6.87 6.87.0 01-6.87 6.87h-8.3V56.67h3.33a3.44 3.44.0 003.44-3.44V25.31a3.44 3.44.0 00-3.44-3.44h-3.33V17.25h8.3a6.87 6.87.0 016.87 6.87zm-53.4-17.56A17.39 17.39.0 00227.31 7.25H195.1v64h32.21a19.44 19.44.0 0012.38-34.44zM211.63 61.29h-6.08l18.68-44h6.08zM177 36.85A17.39 17.39.0 00164.65 7.25H132.43v64h32.21A19.44 19.44.0 00177 36.85zM149 61.29h-6.08l18.68-44h6.08z" style="fill:#fff;fill-opacity:1"/></svg></span><span class="text-uppercase font-weight-bold">Apache Dubbo</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/><span>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/blog/><span class=active>Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><span>Community</span></a></li><li class="nav-item dropdown d-none d-lg-block"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/zh/blog/2018/11/07/dubbo-%E8%9E%8D%E5%90%88-nacos-%E6%88%90%E4%B8%BA%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83/>中文</a></div></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002 Search this site…" aria-label="Search this site…" autocomplete=off></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><div id=content-mobile><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002 Search this site…" aria-label="Search this site…" autocomplete=off>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form></div><div id=content-desktop></div><nav class="collapse td-sidebar-nav" id=td-section-nav><div class="nav-item dropdown d-block d-lg-none"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/zh/blog/2018/11/07/dubbo-%E8%9E%8D%E5%90%88-nacos-%E6%88%90%E4%B8%BA%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83/>中文</a></div></div><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/blog/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Blog</a></li><ul><li class="collapse show" id=blog><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/blog/news/ class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Articles</a></li><ul><li class="collapse show" id=blognews><a class="td-sidebar-link td-sidebar-link__page" id=m-blog20190826service-test href=/blog/2019/08/26/service-test/>Service test in dubbo admin</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20190811tracing-dubbo-service-with-apache-skywalking href=/blog/2019/08/11/tracing-dubbo-service-with-apache-skywalking/>Use apache skywalking in dubbo</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20190502dubbo-extensible-mechanism-source-code-analysis-part-2 href=/blog/2019/05/02/dubbo-extensible-mechanism-source-code-analysis-part-2/>Dubbo extensible mechanism - part 2</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20190425dubbo-extensible-mechanism-source-code-analysis-part-1 href=/blog/2019/04/25/dubbo-extensible-mechanism-source-code-analysis-part-1/>Dubbo extensible mechanism - part 1</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20190220implementation-background-and-practice-of-dubbo-client-asynchronous-interface href=/blog/2019/02/20/implementation-background-and-practice-of-dubbo-client-asynchronous-interface/>Dubbo Async Client</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20190220implementation-background-and-practice-of-dubbo-server-asynchronous-interface href=/blog/2019/02/20/implementation-background-and-practice-of-dubbo-server-asynchronous-interface/>Dubbo Async Server</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20190117how-to-use-fescar-to-ensure-consistency-between-dubbo-microservices href=/blog/2019/01/17/how-to-use-fescar-to-ensure-consistency-between-dubbo-microservices/>Use Fescar in Dubbo</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20181210the-fifth-dubbo-meetup-has-been-held-in-hangzhou href=/blog/2018/12/10/the-fifth-dubbo-meetup-has-been-held-in-hangzhou/>The fifth Dubbo meetup</a>
<a class="td-sidebar-link td-sidebar-link__page active" id=m-blog20181107dubbo-integrates-with-nacos-to-become-a-registry href=/blog/2018/11/07/dubbo-integrates-with-nacos-to-become-a-registry/>Use Dubbo with Nacos</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20181005introduction-to-the-dubbo-protocol href=/blog/2018/10/05/introduction-to-the-dubbo-protocol/>Introduction to the Dubbo protocol</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180930integrate-dubbo-with-kubernetes href=/blog/2018/09/30/integrate-dubbo-with-kubernetes/>Integrate Dubbo with Kubernetes</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180902how-to-prepare-an-apache-release href=/blog/2018/09/02/how-to-prepare-an-apache-release/>How to prepare an Apache Release</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180902how-to-implement-a-fully-asynchronous-calls-chain-based-on-dubbo href=/blog/2018/09/02/how-to-implement-a-fully-asynchronous-calls-chain-based-on-dubbo/>New Async Call</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180826the-fourth-dubbo-meetup-has-been-held-in-chengdu href=/blog/2018/08/26/the-fourth-dubbo-meetup-has-been-held-in-chengdu/>The fourth Dubbo meetup</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180814dubbo-basic-usage-dubbo-consumer-configuration href=/blog/2018/08/14/dubbo-basic-usage-dubbo-consumer-configuration/>Dubbo Consumer Configuration</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180814dubbo-several-ways-about-synchronousasynchronous-invoke href=/blog/2018/08/14/dubbo-several-ways-about-synchronous/asynchronous-invoke/>Dubbo Invoke</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180814dubbo-basic-usage-dubbo-provider-configuration href=/blog/2018/08/14/dubbo-basic-usage-dubbo-provider-configuration/>Dubbo Provider Configuration</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180814manipulating-services-dynamically-via-qos href=/blog/2018/08/14/manipulating-services-dynamically-via-qos/>Dubbo QoS Introduction</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180814source-code-analysis-of-spring-boot-dubbo-app-start-and-stop href=/blog/2018/08/14/source-code-analysis-of-spring-boot-dubbo-app-start-and-stop/>Dubbo start/stop in spring boot</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180814implementation-of-cross-language-calls-by-dubbo2js href=/blog/2018/08/14/implementation-of-cross-language-calls-by-dubbo2.js/>dubbo2.js introduction</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180814generic-invoke-of-dubbo href=/blog/2018/08/14/generic-invoke-of-dubbo/>Generic invoke</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180810dubbos-load-balance href=/blog/2018/08/10/dubbos-load-balance/>Dubbo's Load Balance</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180807use-annotations-in-dubbo href=/blog/2018/08/07/use-annotations-in-dubbo/>Use Annotations In Dubbo</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180807using-zookeeper-in-dubbo href=/blog/2018/08/07/using-zookeeper-in-dubbo/>Using Zookeeper in Dubbo</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180807dubbo-101 href=/blog/2018/08/07/dubbo-101/>Your First Dubbo Demo</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180730the-third-dubbo-meetup-has-been-held-in-shenzhen href=/blog/2018/07/30/the-third-dubbo-meetup-has-been-held-in-shenzhen/>The third Dubbo meetup</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180727sentinel-the-flow-sentinel-of-dubbo-services href=/blog/2018/07/27/sentinel-the-flow-sentinel-of-dubbo-services/>Introduce sentinel</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180712tracking-with-pinpoint href=/blog/2018/07/12/tracking-with-pinpoint/>Tracking with Pinpoint</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180701your-first-dubbo-filter href=/blog/2018/07/01/your-first-dubbo-filter/>Your First Dubbo Filter</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180623the-second-dubbo-shanghai-meetup-has-been-held-successfully href=/blog/2018/06/23/the-second-dubbo-shanghai-meetup-has-been-held-successfully/>The second Dubbo meetup</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180512the-first-dubbo-meetup-has-been-held-in-beijing href=/blog/2018/05/12/the-first-dubbo-meetup-has-been-held-in-beijing/>The first Dubbo meetup</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180502the-apachecon-na-schedule-has-been-announced href=/blog/2018/05/02/the-apachecon-na-schedule-has-been-announced/>ApacheCon NA</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180425the-gsocgoogle-summer-of-code-2018 href=/blog/2018/04/25/the-gsocgoogle-summer-of-code-2018/>GSoC 2018</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-blog20180422dubbo-roadmap-is-announced-in-qcon-beijing-2018 href=/blog/2018/04/22/dubbo-roadmap-is-announced-in-qcon-beijing-2018/>QCon Beijing 2018</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/blog/releases/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Releases</a></li><ul><li class=collapse id=blogreleases><a class="td-sidebar-link td-sidebar-link__page" id=m-blog20200518past-releases href=/blog/2020/05/18/past-releases/>Past Releases</a></li></ul></ul></li></ul></ul></nav></div></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/apache/dubbo-website/edit/master/content/en/blog/news/dubbo-registry-nacos-integration.md target=_blank><i class="fa fa-edit fa-fw"></i>Edit this page</a>
<a href="https://github.com/apache/dubbo-website/new/master/content/en/blog/news/dubbo-registry-nacos-integration.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" target=_blank><i class="fa fa-edit fa-fw"></i>Create child page</a>
<a href="https://github.com/apache/dubbo-website/issues/new?title=Dubbo%20Integrates%20with%20Nacos%20to%20Become%20a%20Registry" target=_blank><i class="fab fa-github fa-fw"></i>Create documentation issue</a>
<a href=https://github.com/apache/dubbo/issues/new target=_blank><i class="fas fa-tasks fa-fw"></i>Create project issue</a></div><nav id=TableOfContents><ul><li><a href=#preparation-works>Preparation Works</a></li><li><a href=#get-started-quickly>Get Started Quickly</a></li><li><a href=#increase-maven-dependency>Increase Maven Dependency</a></li><li><a href=#configure-the-registry>Configure the Registry</a></li><li><a href=#dubbo-spring-externalization-configuration>Dubbo Spring Externalization Configuration</a></li><li><a href=#spring-xml-configuration-file>Spring XML Configuration File</a></li><li><a href=#complete-example>Complete Example</a><ul><li><a href=#example-interfaces-and-implementations>Example Interfaces and Implementations</a></li></ul></li><li><a href=#spring-annotation-driven-example>Spring Annotation-driven Example</a><ul><li><a href=#service-provider-annotation-driven-implementation>Service Provider Annotation-driven Implementation</a></li></ul></li><li><a href=#service-consumer-annotation-driven-implementation>Service consumer annotation-driven implementation</a><ul><li><a href=#run-the-annotation-driven-example>Run the Annotation-driven Example</a></li><li><a href=#spring-xml-configuration-driven-example>Spring XML Configuration-driven Example</a></li></ul></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 pl-md-5 pr-md-4" role=main><a class="btn btn-lg -bg-orange td-rss-button d-none d-lg-block" href=/blog/news/index.xml target=_blank>RSS <i class="fa fa-rss ml-2"></i></a><div class=td-content><h1>Dubbo Integrates with Nacos to Become a Registry</h1><div class=lead>This article introduces how to use Nacos in Dubbo application.</div><div class="td-byline mb-4"><time datetime=2018-11-07 class=text-muted>Wednesday, November 07, 2018</time></div><p>Nacos is an important registry in Dubbo ecosystem, and dubbo-registry-nacos is the implementation of Dubbo-integrated Nacos registry.</p><h2 id=preparation-works>Preparation Works</h2><p>Before you integrate dubbo-registry-nacos into your Dubbo project, make sure the Nacos service is started in the background. If you are not familiar with the basic use of Nacos, you can refer to the Quick Start for Nacos: <a href=https://nacos.io/en-us/docs/quick-start.html>https://nacos.io/en-us/docs/quick-start.html</a>. Nacos versions above 0.6.1 are recommended.</p><h2 id=get-started-quickly>Get Started Quickly</h2><p>The operation steps for Dubbo to integrate Nacos into a registry are simple, the general steps can be divided into &ldquo;add Maven dependency&rdquo; and &ldquo;configure the registry.&rdquo;</p><h2 id=increase-maven-dependency>Increase Maven Dependency</h2><p>First, you need to add the Maven dependency of dubbo-registry-nacos to your project&rsquo;s pom.xml file, and it is strongly recommended that you use Dubbo 2.6.5:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#268bd2>&lt;dependencies&gt;</span>

    ...
        
    <span style=color:#586e75>&lt;!-- Dubbo Nacos registry dependency --&gt;</span>
    <span style=color:#268bd2>&lt;dependency&gt;</span>
        <span style=color:#268bd2>&lt;groupId&gt;</span>org.apache<span style=color:#268bd2>&lt;/groupId&gt;</span>
        <span style=color:#268bd2>&lt;artifactId&gt;</span>dubbo-registry-nacos<span style=color:#268bd2>&lt;/artifactId&gt;</span>
        <span style=color:#268bd2>&lt;version&gt;</span>0.0.2<span style=color:#268bd2>&lt;/version&gt;</span>
    <span style=color:#268bd2>&lt;/dependency&gt;</span>   
    
    <span style=color:#586e75>&lt;!-- Keep latest Nacos client version --&gt;</span>
    <span style=color:#268bd2>&lt;dependency&gt;</span>
        <span style=color:#268bd2>&lt;groupId&gt;</span>org.apache.nacos<span style=color:#268bd2>&lt;/groupId&gt;</span>
        <span style=color:#268bd2>&lt;artifactId&gt;</span>nacos-client<span style=color:#268bd2>&lt;/artifactId&gt;</span>
        <span style=color:#268bd2>&lt;version&gt;</span>[0.6.1,)<span style=color:#268bd2>&lt;/version&gt;</span>
    <span style=color:#268bd2>&lt;/dependency&gt;</span>
    
    <span style=color:#586e75>&lt;!-- Dubbo dependency --&gt;</span>
    <span style=color:#268bd2>&lt;dependency&gt;</span>
        <span style=color:#268bd2>&lt;groupId&gt;</span>org.apache<span style=color:#268bd2>&lt;/groupId&gt;</span>
        <span style=color:#268bd2>&lt;artifactId&gt;</span>dubbo<span style=color:#268bd2>&lt;/artifactId&gt;</span>
        <span style=color:#268bd2>&lt;version&gt;</span>2.6.5<span style=color:#268bd2>&lt;/version&gt;</span>
    <span style=color:#268bd2>&lt;/dependency&gt;</span>
    
    <span style=color:#586e75>&lt;!-- Alibaba Spring Context extension --&gt;</span>
    <span style=color:#268bd2>&lt;dependency&gt;</span>
        <span style=color:#268bd2>&lt;groupId&gt;</span>org.apache.spring<span style=color:#268bd2>&lt;/groupId&gt;</span>
        <span style=color:#268bd2>&lt;artifactId&gt;</span>spring-context-support<span style=color:#268bd2>&lt;/artifactId&gt;</span>
        <span style=color:#268bd2>&lt;version&gt;</span>1.0.2<span style=color:#268bd2>&lt;/version&gt;</span>
    <span style=color:#268bd2>&lt;/dependency&gt;</span>

    ...
    
<span style=color:#268bd2>&lt;/dependencies&gt;</span>
</code></pre></div><p>When you add dubbo-registry-nacos to your project, you don&rsquo;t need to programmatically implement the service discovery and registration logic, the actual implementation is provided by the third-party package, and then to configure the Naocs registry.</p><h2 id=configure-the-registry>Configure the Registry</h2><p>Assuming your Dubbo application is assembled by the Spring Framework, there are two configuration options: Dubbo Spring externalization configuration and Spring XML configuration files, I strongly recommend the former.</p><h2 id=dubbo-spring-externalization-configuration>Dubbo Spring Externalization Configuration</h2><p>Dubbo Spring externalization configuration is a new feature introduced by Dubbo 2.5.8, which automatically generates and binds Dubbo configuration Bean through the Spring Environment property, simplifying configuration and lowering the threshold for microservice development.</p><p>Assume your Dubbo application uses Zookeeper as the registry and its server IP address is 10.20.153.10, the registered address is also stored in the dubbo-config.properties file as a Dubbo externalization configuration attribute, as shown below:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>## application
dubbo.application.name = your-dubbo-application

## Zookeeper registry address
dubbo.registry.address = zookeeper://10.20.153.10:2181
...
</code></pre></div><p>Assuming your Nacos Server is also running on server 10.20.153.10 and using the default Nacos service port 8848, you can simply adjust the dubbo.registry.address property as follows:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>## 其他属性保持不变

## Nacos registry address
dubbo.registry.address = nacos://10.20.153.10:8848
...
</code></pre></div><p>Subsequently, restart your Dubbo application, and Dubbo&rsquo;s service delivery and consumption information can be displayed in the Nacos console:</p><p><img src=/imgs/blog/dubbo-registry-nacos-1.png alt=image-20181213103845976></p><p>As shown in the figure, the service name prefixed with providers: is the meta-information for the service provider, and consumers: represents the meta-information of the service consumer. Click &ldquo;Details&rdquo; to view service status details:</p><p><img src=/imgs/blog/dubbo-registry-nacos-2.png alt=image-20181213104145998></p><p>If you are using the Spring XML configuration file to assemble the Dubbo registry, refer to the next section.</p><h2 id=spring-xml-configuration-file>Spring XML Configuration File</h2><p>Also, assume your Dubbo application uses Zookeeper as the registry and its server IP address is 10.20.153.10 and assemble the Spring Bean in an XML file, as shown below:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#719e07>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span style=color:#268bd2>&lt;beans</span> xmlns=<span style=color:#2aa198>&#34;http://www.springframework.org/schema/beans&#34;</span>
    xmlns:xsi=<span style=color:#2aa198>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
    xmlns:dubbo=<span style=color:#2aa198>&#34;http://dubbo.apache.org/schema/dubbo&#34;</span>
    xsi:schemaLocation=<span style=color:#2aa198>&#34;http://www.springframework.org/schema/beans        http://www.springframework.org/schema/beans/spring-beans-4.3.xsd        http://dubbo.apache.org/schema/dubbo        http://dubbo.apache.org/schema/dubbo/dubbo.xsd&#34;</span><span style=color:#268bd2>&gt;</span>
 
    <span style=color:#586e75>&lt;!-- Provider application information for dependency calculation --&gt;</span>
    <span style=color:#268bd2>&lt;dubbo:application</span> name=<span style=color:#2aa198>&#34;dubbo-provider-xml-demo&#34;</span>  <span style=color:#268bd2>/&gt;</span>
 
    <span style=color:#586e75>&lt;!-- Using the Zookeeper registry Zookeeper   --&gt;</span>
    <span style=color:#268bd2>&lt;dubbo:registry</span> address=<span style=color:#2aa198>&#34;zookeeper://10.20.153.10:2181&#34;</span> <span style=color:#268bd2>/&gt;</span>
 	...
<span style=color:#268bd2>&lt;/beans&gt;</span>
</code></pre></div><p>Similar to the Dubbo Spring externalization configuration, simply adjust the address property configuration:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#719e07>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span style=color:#268bd2>&lt;beans</span> xmlns=<span style=color:#2aa198>&#34;http://www.springframework.org/schema/beans&#34;</span>
    xmlns:xsi=<span style=color:#2aa198>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
    xmlns:dubbo=<span style=color:#2aa198>&#34;http://dubbo.apache.org/schema/dubbo&#34;</span>
    xsi:schemaLocation=<span style=color:#2aa198>&#34;http://www.springframework.org/schema/beans        http://www.springframework.org/schema/beans/spring-beans-4.3.xsd        http://dubbo.apache.org/schema/dubbo        http://dubbo.apache.org/schema/dubbo/dubbo.xsd&#34;</span><span style=color:#268bd2>&gt;</span>
 
    <span style=color:#586e75>&lt;!-- Provider application information for dependency calculation--&gt;</span>
    <span style=color:#268bd2>&lt;dubbo:application</span> name=<span style=color:#2aa198>&#34;dubbo-provider-xml-demo&#34;</span>  <span style=color:#268bd2>/&gt;</span>
 
    <span style=color:#586e75>&lt;!-- Using the Nacos registry  --&gt;</span>
    <span style=color:#268bd2>&lt;dubbo:registry</span> address=<span style=color:#2aa198>&#34;nacos://10.20.153.10:8848&#34;</span> <span style=color:#268bd2>/&gt;</span>
 	...
<span style=color:#268bd2>&lt;/beans&gt;</span>
</code></pre></div><p>Once you restart the Dubbo application, you can also see that the registration meta-information for both service providers and consumers is presented in the Nacos console:</p><p><img src=/imgs/blog/dubbo-registry-nacos-3.png alt=image-20181213113049185></p><p>Do you absolutely configure or switch Nacos registry super Easy? If you want to get more or unclear, refer to the complete example below.</p><h2 id=complete-example>Complete Example</h2><p>The metadata in the above image is derived from the Dubbo Spring annotation-driven example and the Dubbo Spring XML configuration-driven example, both of which will be described below, you can choose your preferred programming model. Before we get into the formal discussion, let&rsquo;s look at the preparations for both, as they both rely on Java service interfaces and implementations. Also, ensure that the Nacos service is started in the local (127.0.0.1) environment.</p><h3 id=example-interfaces-and-implementations>Example Interfaces and Implementations</h3><p>First, define the sample interface, as follows:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#719e07>package</span> org.apache.dubbo.demo.service<span style=color:#719e07>;</span>

<span style=color:#586e75>/**
</span><span style=color:#586e75> * DemoService
</span><span style=color:#586e75> *
</span><span style=color:#586e75> * @since 2.7.4
</span><span style=color:#586e75> */</span>
<span style=color:#268bd2>public</span> <span style=color:#268bd2>interface</span> <span style=color:#268bd2>DemoService</span> <span style=color:#719e07>{</span>

    String <span style=color:#268bd2>sayName</span><span style=color:#719e07>(</span>String name<span style=color:#719e07>);</span>

<span style=color:#719e07>}</span>
</code></pre></div><p>Provide implementation classes for the above interfaces:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#719e07>package</span> org.apache.dubbo.demo.service<span style=color:#719e07>;</span>

<span style=color:#719e07>import</span> org.apache.dubbo.config.annotation.Service<span style=color:#719e07>;</span>
<span style=color:#719e07>import</span> org.apache.dubbo.rpc.RpcContext<span style=color:#719e07>;</span>

<span style=color:#719e07>import</span> org.springframework.beans.factory.annotation.Value<span style=color:#719e07>;</span>

<span style=color:#586e75>/**
</span><span style=color:#586e75> * Default {@link DemoService}
</span><span style=color:#586e75> *
</span><span style=color:#586e75> * @since 2.7.4
</span><span style=color:#586e75> */</span>
<span style=color:#268bd2>@Service</span><span style=color:#719e07>(</span>version <span style=color:#719e07>=</span> <span style=color:#2aa198>&#34;${demo.service.version}&#34;</span><span style=color:#719e07>)</span>
<span style=color:#268bd2>public</span> <span style=color:#268bd2>class</span> <span style=color:#268bd2>DefaultService</span> <span style=color:#268bd2>implements</span> DemoService <span style=color:#719e07>{</span>

    <span style=color:#268bd2>@Value</span><span style=color:#719e07>(</span><span style=color:#2aa198>&#34;${demo.service.name}&#34;</span><span style=color:#719e07>)</span>
    <span style=color:#268bd2>private</span> String serviceName<span style=color:#719e07>;</span>

    <span style=color:#268bd2>public</span> String <span style=color:#268bd2>sayName</span><span style=color:#719e07>(</span>String name<span style=color:#719e07>)</span> <span style=color:#719e07>{</span>
        RpcContext rpcContext <span style=color:#719e07>=</span> RpcContext<span style=color:#719e07>.</span>getContext<span style=color:#719e07>();</span>
        <span style=color:#719e07>return</span> String<span style=color:#719e07>.</span>format<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;Service [name :%s , port : %d] %s(\&#34;%s\&#34;) : Hello,%s&#34;</span><span style=color:#719e07>,</span>
                serviceName<span style=color:#719e07>,</span>
                rpcContext<span style=color:#719e07>.</span>getLocalPort<span style=color:#719e07>(),</span>
                rpcContext<span style=color:#719e07>.</span>getMethodName<span style=color:#719e07>(),</span>
                name<span style=color:#719e07>,</span>
                name<span style=color:#719e07>);</span>
    <span style=color:#719e07>}</span>
<span style=color:#719e07>}</span>
</code></pre></div><p>Once the interface and implementation are ready, the annotation-driven and XML configuration-driven implementations will be used below.</p><h2 id=spring-annotation-driven-example>Spring Annotation-driven Example</h2><p>Dubbo 2.7.4 reconstructs the Spring annotation-driven programming model.</p><h3 id=service-provider-annotation-driven-implementation>Service Provider Annotation-driven Implementation</h3><ul><li>Define property source of Dubbo provider externalization configuration - provider-config.properties</li></ul><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>## application
dubbo.application.name = dubbo-provider-demo

## Nacos registry address
dubbo.registry.address = nacos://127.0.0.1:8848

## Dubbo Protocol
dubbo.protocol.name = dubbo
dubbo.protocol.port = -1

# Provider @Service version
demo.service.version=1.0.0
demo.service.name = demoService
</code></pre></div><ul><li>Implement service provider bootstrap - DemoServiceProviderBootstrap</li></ul><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#719e07>package</span> org.apache.dubbo.demo.provider<span style=color:#719e07>;</span>

<span style=color:#719e07>import</span> org.apache.dubbo.config.spring.context.annotation.EnableDubbo<span style=color:#719e07>;</span>
<span style=color:#719e07>import</span> org.apache.dubbo.demo.service.DemoService<span style=color:#719e07>;</span>

<span style=color:#719e07>import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext<span style=color:#719e07>;</span>
<span style=color:#719e07>import</span> org.springframework.context.annotation.PropertySource<span style=color:#719e07>;</span>

<span style=color:#719e07>import</span> java.io.IOException<span style=color:#719e07>;</span>

<span style=color:#586e75>/**
</span><span style=color:#586e75> * {@link DemoService} provider demo
</span><span style=color:#586e75> */</span>
<span style=color:#268bd2>@EnableDubbo</span><span style=color:#719e07>(</span>scanBasePackages <span style=color:#719e07>=</span> <span style=color:#2aa198>&#34;org.apache.dubbo.demo.service&#34;</span><span style=color:#719e07>)</span>
<span style=color:#268bd2>@PropertySource</span><span style=color:#719e07>(</span>value <span style=color:#719e07>=</span> <span style=color:#2aa198>&#34;classpath:/provider-config.properties&#34;</span><span style=color:#719e07>)</span>
<span style=color:#268bd2>public</span> <span style=color:#268bd2>class</span> <span style=color:#268bd2>DemoServiceProviderBootstrap</span> <span style=color:#719e07>{</span>

    <span style=color:#268bd2>public</span> <span style=color:#268bd2>static</span> <span style=color:#dc322f>void</span> <span style=color:#268bd2>main</span><span style=color:#719e07>(</span>String<span style=color:#719e07>[]</span> args<span style=color:#719e07>)</span> <span style=color:#268bd2>throws</span> IOException <span style=color:#719e07>{</span>
        AnnotationConfigApplicationContext context <span style=color:#719e07>=</span> <span style=color:#719e07>new</span> AnnotationConfigApplicationContext<span style=color:#719e07>();</span>
        context<span style=color:#719e07>.</span>register<span style=color:#719e07>(</span>DemoServiceProviderBootstrap<span style=color:#719e07>.</span>class<span style=color:#719e07>);</span>
        context<span style=color:#719e07>.</span>refresh<span style=color:#719e07>();</span>
        System<span style=color:#719e07>.</span>out<span style=color:#719e07>.</span>println<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;DemoService provider is starting...&#34;</span><span style=color:#719e07>);</span>
        System<span style=color:#719e07>.</span>in<span style=color:#719e07>.</span>read<span style=color:#719e07>();</span>
    <span style=color:#719e07>}</span>
<span style=color:#719e07>}</span>

</code></pre></div><p>Wherein, the annotation @EnableDubbo activates the Dubbo annotation-driven and externalization configuration, its scanBasePackages property scans the specified Java package, exposes all service interface implementation classes labeled @Service as Spring Bean, and then exports the Dubbo service.</p><p>@PropertySource is the standard import property configuration resource annotation introduced by Spring Framework 3.1, which provides externalization configuration for Dubbo.</p><h2 id=service-consumer-annotation-driven-implementation>Service consumer annotation-driven implementation</h2><ul><li>Define property source of Dubbo consumer externalization configuration - consumer-config.properties</li></ul><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>## Dubbo Application info
dubbo.application.name = dubbo-consumer-demo

## Nacos registry address
dubbo.registry.address = nacos://127.0.0.1:8848

# @Reference version
demo.service.version= 1.0.0
</code></pre></div><p>Similarly, the dubbo.registry.address property points to the Nacos registry, through which metadata about other Dubbo services is obtained.</p><ul><li>Implement service consumer bootstrap class - DemoServiceConsumerBootstrap</li></ul><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#719e07>package</span> org.apache.dubbo.demo.consumer<span style=color:#719e07>;</span>

<span style=color:#719e07>import</span> org.apache.dubbo.config.annotation.Reference<span style=color:#719e07>;</span>
<span style=color:#719e07>import</span> org.apache.dubbo.config.spring.context.annotation.EnableDubbo<span style=color:#719e07>;</span>
<span style=color:#719e07>import</span> org.apache.dubbo.demo.service.DemoService<span style=color:#719e07>;</span>

<span style=color:#719e07>import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext<span style=color:#719e07>;</span>
<span style=color:#719e07>import</span> org.springframework.context.annotation.PropertySource<span style=color:#719e07>;</span>

<span style=color:#719e07>import</span> javax.annotation.PostConstruct<span style=color:#719e07>;</span>
<span style=color:#719e07>import</span> java.io.IOException<span style=color:#719e07>;</span>

<span style=color:#586e75>/**
</span><span style=color:#586e75> * {@link DemoService} consumer demo
</span><span style=color:#586e75> */</span>
<span style=color:#268bd2>@EnableDubbo</span>
<span style=color:#268bd2>@PropertySource</span><span style=color:#719e07>(</span>value <span style=color:#719e07>=</span> <span style=color:#2aa198>&#34;classpath:/consumer-config.properties&#34;</span><span style=color:#719e07>)</span>
<span style=color:#268bd2>public</span> <span style=color:#268bd2>class</span> <span style=color:#268bd2>DemoServiceConsumerBootstrap</span> <span style=color:#719e07>{</span>

    <span style=color:#268bd2>@Reference</span><span style=color:#719e07>(</span>version <span style=color:#719e07>=</span> <span style=color:#2aa198>&#34;${demo.service.version}&#34;</span><span style=color:#719e07>)</span>
    <span style=color:#268bd2>private</span> DemoService demoService<span style=color:#719e07>;</span>

    <span style=color:#268bd2>@PostConstruct</span>
    <span style=color:#268bd2>public</span> <span style=color:#dc322f>void</span> <span style=color:#268bd2>init</span><span style=color:#719e07>()</span> <span style=color:#719e07>{</span>
        <span style=color:#719e07>for</span> <span style=color:#719e07>(</span><span style=color:#dc322f>int</span> i <span style=color:#719e07>=</span> 0<span style=color:#719e07>;</span> i <span style=color:#719e07>&lt;</span> 10<span style=color:#719e07>;</span> i<span style=color:#719e07>++)</span> <span style=color:#719e07>{</span>
            System<span style=color:#719e07>.</span>out<span style=color:#719e07>.</span>println<span style=color:#719e07>(</span>demoService<span style=color:#719e07>.</span>sayName<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;小马哥（mercyblitz）&#34;</span><span style=color:#719e07>));</span>
        <span style=color:#719e07>}</span>
    <span style=color:#719e07>}</span>

    <span style=color:#268bd2>public</span> <span style=color:#268bd2>static</span> <span style=color:#dc322f>void</span> <span style=color:#268bd2>main</span><span style=color:#719e07>(</span>String<span style=color:#719e07>[]</span> args<span style=color:#719e07>)</span> <span style=color:#268bd2>throws</span> IOException <span style=color:#719e07>{</span>
        AnnotationConfigApplicationContext context <span style=color:#719e07>=</span> <span style=color:#719e07>new</span> AnnotationConfigApplicationContext<span style=color:#719e07>();</span>
        context<span style=color:#719e07>.</span>register<span style=color:#719e07>(</span>DemoServiceConsumerBootstrap<span style=color:#719e07>.</span>class<span style=color:#719e07>);</span>
        context<span style=color:#719e07>.</span>refresh<span style=color:#719e07>();</span>
        context<span style=color:#719e07>.</span>close<span style=color:#719e07>();</span>
    <span style=color:#719e07>}</span>
<span style=color:#719e07>}</span>

</code></pre></div><p>Similarly, the @EnableDubbo annotation activates the Dubbo annotation-driven and externalization configuration, although it currently belongs to the service consumer and does not require the Java package name to scan the service implementation labeled @Service.</p><p>@Reference is a dependency injection annotation for Dubbo remote services that requires service provider and consumer contract interface, version, and group information. In the current service consumption example, the service version of DemoService is derived from the property configuration file consumer-config.properties.</p><p>The @PostConstruct code shows that when the DemoServiceConsumerBootstrap Bean is initialized, it executes ten Dubbo remote method invocation.</p><h3 id=run-the-annotation-driven-example>Run the Annotation-driven Example</h3><p>Start DemoServiceProviderBootstrap twice locally and the registry will have two health services:</p><p><img src=/imgs/blog/dubbo-registry-nacos-4.png alt=image-20181213123909636></p><p>Run DemoServiceConsumerBootstrap again and the results are as follows:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>Service [name :demoService , port : 20880] sayName(&#34;小马哥（mercyblitz）&#34;) : Hello,小马哥（mercyblitz）
Service [name :demoService , port : 20881] sayName(&#34;小马哥（mercyblitz）&#34;) : Hello,小马哥（mercyblitz）
Service [name :demoService , port : 20880] sayName(&#34;小马哥（mercyblitz）&#34;) : Hello,小马哥（mercyblitz）
Service [name :demoService , port : 20880] sayName(&#34;小马哥（mercyblitz）&#34;) : Hello,小马哥（mercyblitz）
Service [name :demoService , port : 20881] sayName(&#34;小马哥（mercyblitz）&#34;) : Hello,小马哥（mercyblitz）
Service [name :demoService , port : 20881] sayName(&#34;小马哥（mercyblitz）&#34;) : Hello,小马哥（mercyblitz）
Service [name :demoService , port : 20880] sayName(&#34;小马哥（mercyblitz）&#34;) : Hello,小马哥（mercyblitz）
Service [name :demoService , port : 20880] sayName(&#34;小马哥（mercyblitz）&#34;) : Hello,小马哥（mercyblitz）
Service [name :demoService , port : 20881] sayName(&#34;小马哥（mercyblitz）&#34;) : Hello,小马哥（mercyblitz）
Service [name :demoService , port : 20881] sayName(&#34;小马哥（mercyblitz）&#34;) : Hello,小马哥（mercyblitz）
</code></pre></div><p>Run correctly and the service consumer uses a load balancing strategy to allocate ten RPC calls equally to two Dubbo service provider instances.</p><h3 id=spring-xml-configuration-driven-example>Spring XML Configuration-driven Example</h3><p>Spring XML configuration-driven is the programming model of traditional Spring assembly components.</p><h4 id=service-provider-xml-configuration-driven>Service Provider XML Configuration-driven</h4><p>Define the service provider XML context configuration file - /META-INF/spring/dubbo-provider-context.xml</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#719e07>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span style=color:#268bd2>&lt;beans</span> xmlns=<span style=color:#2aa198>&#34;http://www.springframework.org/schema/beans&#34;</span>
       xmlns:xsi=<span style=color:#2aa198>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
       xmlns:dubbo=<span style=color:#2aa198>&#34;http://dubbo.apache.org/schema/dubbo&#34;</span>
       xsi:schemaLocation=<span style=color:#2aa198>&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.3.xsd        http://dubbo.apache.org/schema/dubbo        http://dubbo.apache.org/schema/dubbo/dubbo.xsd&#34;</span><span style=color:#268bd2>&gt;</span>

    <span style=color:#586e75>&lt;!-- 
</span><span style=color:#586e75>
</span><span style=color:#586e75>Provider application information for dependency calculation
</span><span style=color:#586e75> --&gt;</span>
    <span style=color:#268bd2>&lt;dubbo:application</span> name=<span style=color:#2aa198>&#34;dubbo-provider-xml-demo&#34;</span><span style=color:#268bd2>/&gt;</span>

    <span style=color:#586e75>&lt;!-- Using the Nacos registry --&gt;</span>
    <span style=color:#268bd2>&lt;dubbo:registry</span> address=<span style=color:#2aa198>&#34;nacos://127.0.0.1:8848&#34;</span><span style=color:#268bd2>/&gt;</span>

    <span style=color:#586e75>&lt;!-- Using Dubbo protocol to expose services on random ports --&gt;</span>
    <span style=color:#268bd2>&lt;dubbo:protocol</span> name=<span style=color:#2aa198>&#34;dubbo&#34;</span> port=<span style=color:#2aa198>&#34;-1&#34;</span><span style=color:#268bd2>/&gt;</span>

    <span style=color:#586e75>&lt;!-- Declare the service interface to be exposed --&gt;</span>
    <span style=color:#268bd2>&lt;dubbo:service</span> interface=<span style=color:#2aa198>&#34;org.apache.dubbo.demo.service.DemoService&#34;</span> ref=<span style=color:#2aa198>&#34;demoService&#34;</span> version=<span style=color:#2aa198>&#34;2.0.0&#34;</span><span style=color:#268bd2>/&gt;</span>

    <span style=color:#586e75>&lt;!-- Implement services like local beans --&gt;</span>
    <span style=color:#268bd2>&lt;bean</span> id=<span style=color:#2aa198>&#34;demoService&#34;</span> class=<span style=color:#2aa198>&#34;org.apache.dubbo.demo.service.DefaultService&#34;</span><span style=color:#268bd2>/&gt;</span>
<span style=color:#268bd2>&lt;/beans&gt;</span>
</code></pre></div><ul><li>Implement service provider bootstrap class - DemoServiceProviderBootstrap</li></ul><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#719e07>package</span> org.apache.dubbo.demo.provider<span style=color:#719e07>;</span>

<span style=color:#719e07>import</span> org.apache.dubbo.demo.service.DemoService<span style=color:#719e07>;</span>

<span style=color:#719e07>import</span> org.springframework.context.support.ClassPathXmlApplicationContext<span style=color:#719e07>;</span>

<span style=color:#719e07>import</span> java.io.IOException<span style=color:#719e07>;</span>

<span style=color:#586e75>/**
</span><span style=color:#586e75> * {@link DemoService} provider demo XML bootstrap
</span><span style=color:#586e75> */</span>
<span style=color:#268bd2>public</span> <span style=color:#268bd2>class</span> <span style=color:#268bd2>DemoServiceProviderXmlBootstrap</span> <span style=color:#719e07>{</span>

    <span style=color:#268bd2>public</span> <span style=color:#268bd2>static</span> <span style=color:#dc322f>void</span> <span style=color:#268bd2>main</span><span style=color:#719e07>(</span>String<span style=color:#719e07>[]</span> args<span style=color:#719e07>)</span> <span style=color:#268bd2>throws</span> IOException <span style=color:#719e07>{</span>
        ClassPathXmlApplicationContext context <span style=color:#719e07>=</span> <span style=color:#719e07>new</span> ClassPathXmlApplicationContext<span style=color:#719e07>();</span>
        context<span style=color:#719e07>.</span>setConfigLocation<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;/META-INF/spring/dubbo-provider-context.xml&#34;</span><span style=color:#719e07>);</span>
        context<span style=color:#719e07>.</span>refresh<span style=color:#719e07>();</span>
        System<span style=color:#719e07>.</span>out<span style=color:#719e07>.</span>println<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;DemoService provider (XML) is starting...&#34;</span><span style=color:#719e07>);</span>
        System<span style=color:#719e07>.</span>in<span style=color:#719e07>.</span>read<span style=color:#719e07>();</span>
    <span style=color:#719e07>}</span>
<span style=color:#719e07>}</span>
</code></pre></div><h4 id=service-consumer-xml-configuration-driven>Service Consumer XML Configuration-driven</h4><p>Define the consumer provider XML context configuration file - /META-INF/spring/dubbo- consumer-context.xml</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#719e07>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span style=color:#268bd2>&lt;beans</span> xmlns=<span style=color:#2aa198>&#34;http://www.springframework.org/schema/beans&#34;</span>
       xmlns:xsi=<span style=color:#2aa198>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
       xmlns:dubbo=<span style=color:#2aa198>&#34;http://dubbo.apache.org/schema/dubbo&#34;</span>
       xsi:schemaLocation=<span style=color:#2aa198>&#34;http://www.springframework.org/schema/beans        http://www.springframework.org/schema/beans/spring-beans-4.3.xsd        http://dubbo.apache.org/schema/dubbo        http://dubbo.apache.org/schema/dubbo/dubbo.xsd&#34;</span><span style=color:#268bd2>&gt;</span>

    <span style=color:#586e75>&lt;!-- 
</span><span style=color:#586e75>
</span><span style=color:#586e75>Provider application information for dependency calculation
</span><span style=color:#586e75> --&gt;</span>
    <span style=color:#268bd2>&lt;dubbo:application</span> name=<span style=color:#2aa198>&#34;dubbo-consumer-xml-demo&#34;</span><span style=color:#268bd2>/&gt;</span>

    <span style=color:#586e75>&lt;!-- Using the Nacos registry--&gt;</span>
    <span style=color:#268bd2>&lt;dubbo:registry</span> address=<span style=color:#2aa198>&#34;nacos://127.0.0.1:8848&#34;</span><span style=color:#268bd2>/&gt;</span>

    <span style=color:#586e75>&lt;!-- Reference service interface --&gt;</span>
    <span style=color:#268bd2>&lt;dubbo:reference</span> id=<span style=color:#2aa198>&#34;demoService&#34;</span> interface=<span style=color:#2aa198>&#34;org.apache.dubbo.demo.service.DemoService&#34;</span> version=<span style=color:#2aa198>&#34;2.0.0&#34;</span><span style=color:#268bd2>/&gt;</span>

<span style=color:#268bd2>&lt;/beans&gt;</span>
</code></pre></div><ul><li>Implement service consumer bootstrap class - DemoServiceConsumerBootstrap</li></ul><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#719e07>package</span> org.apache.dubbo.demo.consumer<span style=color:#719e07>;</span>

<span style=color:#719e07>import</span> org.apache.dubbo.demo.service.DemoService<span style=color:#719e07>;</span>

<span style=color:#719e07>import</span> org.springframework.context.support.ClassPathXmlApplicationContext<span style=color:#719e07>;</span>

<span style=color:#719e07>import</span> java.io.IOException<span style=color:#719e07>;</span>

<span style=color:#586e75>/**
</span><span style=color:#586e75> * {@link DemoService} consumer demo XML bootstrap
</span><span style=color:#586e75> */</span>
<span style=color:#268bd2>public</span> <span style=color:#268bd2>class</span> <span style=color:#268bd2>DemoServiceConsumerXmlBootstrap</span> <span style=color:#719e07>{</span>

    <span style=color:#268bd2>public</span> <span style=color:#268bd2>static</span> <span style=color:#dc322f>void</span> <span style=color:#268bd2>main</span><span style=color:#719e07>(</span>String<span style=color:#719e07>[]</span> args<span style=color:#719e07>)</span> <span style=color:#268bd2>throws</span> IOException <span style=color:#719e07>{</span>
        ClassPathXmlApplicationContext context <span style=color:#719e07>=</span> <span style=color:#719e07>new</span> ClassPathXmlApplicationContext<span style=color:#719e07>();</span>
        context<span style=color:#719e07>.</span>setConfigLocation<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;/META-INF/spring/dubbo-consumer-context.xml&#34;</span><span style=color:#719e07>);</span>
        context<span style=color:#719e07>.</span>refresh<span style=color:#719e07>();</span>
        System<span style=color:#719e07>.</span>out<span style=color:#719e07>.</span>println<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;DemoService consumer (XML) is starting...&#34;</span><span style=color:#719e07>);</span>
        DemoService demoService <span style=color:#719e07>=</span> context<span style=color:#719e07>.</span>getBean<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;demoService&#34;</span><span style=color:#719e07>,</span> DemoService<span style=color:#719e07>.</span>class<span style=color:#719e07>);</span>
        <span style=color:#719e07>for</span> <span style=color:#719e07>(</span><span style=color:#dc322f>int</span> i <span style=color:#719e07>=</span> 0<span style=color:#719e07>;</span> i <span style=color:#719e07>&lt;</span> 10<span style=color:#719e07>;</span> i<span style=color:#719e07>++)</span> <span style=color:#719e07>{</span>
            System<span style=color:#719e07>.</span>out<span style=color:#719e07>.</span>println<span style=color:#719e07>(</span>demoService<span style=color:#719e07>.</span>sayName<span style=color:#719e07>(</span><span style=color:#2aa198>&#34;小马哥（mercyblitz）&#34;</span><span style=color:#719e07>));</span>
        <span style=color:#719e07>}</span>
        context<span style=color:#719e07>.</span>close<span style=color:#719e07>();</span>
    <span style=color:#719e07>}</span>
<span style=color:#719e07>}</span>
</code></pre></div><h4 id=run-xml-configuration-driven-example>Run XML Configuration-driven Example</h4><p>As such, start two DemoServiceProviderXmlBootstrap bootstraps and observe the changes in the Nacos registry service provider:</p><p><img src=/imgs/blog/dubbo-registry-nacos-5.png alt=image-20181213125527201></p><p>The service version driven by the XML configuration is 2.0.0, so the registration service is correct.</p><p>Run the service consumer bootstrap DemoServiceConsumerXmlBootstrap again and observe the console output:</p><div class=highlight><pre style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>Service [name :null , port : 20882] sayName(&#34;小马哥（mercyblitz）&#34;) : Hello,小马哥（mercyblitz）
Service [name :null , port : 20882] sayName(&#34;小马哥（mercyblitz）&#34;) : Hello,小马哥（mercyblitz）
Service [name :null , port : 20883] sayName(&#34;小马哥（mercyblitz）&#34;) : Hello,小马哥（mercyblitz）
Service [name :null , port : 20882] sayName(&#34;小马哥（mercyblitz）&#34;) : Hello,小马哥（mercyblitz）
Service [name :null , port : 20882] sayName(&#34;小马哥（mercyblitz）&#34;) : Hello,小马哥（mercyblitz）
Service [name :null , port : 20883] sayName(&#34;小马哥（mercyblitz）&#34;) : Hello,小马哥（mercyblitz）
Service [name :null , port : 20882] sayName(&#34;小马哥（mercyblitz）&#34;) : Hello,小马哥（mercyblitz）
Service [name :null , port : 20883] sayName(&#34;小马哥（mercyblitz）&#34;) : Hello,小马哥（mercyblitz）
Service [name :null , port : 20883] sayName(&#34;小马哥（mercyblitz）&#34;) : Hello,小马哥（mercyblitz）
Service [name :null , port : 20883] sayName(&#34;小马哥（mercyblitz）&#34;) : Hello,小马哥（mercyblitz）
</code></pre></div><p>As a result, both operation and load balancing are normal due to the property demo.service.name has not been added to the current example, the &ldquo;name&rdquo; information is output as null. For more information, please refer to: <a href=https://github.com/apache/dubbo/tree/master/dubbo-registry/dubbo-registry-nacos>https://github.com/apache/dubbo/tree/master/dubbo-registry/dubbo-registry-nacos</a>.</p><p>If you&rsquo;re interested in or fond of open source projects like Dubbo and Nacos, try clicking &ldquo;star&rdquo; to support them. The links are as follows:</p><ul><li>Apache Dubbo: <a href=https://github.com/apache/dubbo>https://github.com/apache/dubbo</a></li><li>Dubbo Nacos Registry: <a href=https://github.com/apache/dubbo/tree/master/dubbo-registry/dubbo-registry-nacos>https://github.com/apache/dubbo/tree/master/dubbo-registry/dubbo-registry-nacos</a></li><li>Alibaba Nacos: <a href=https://github.com/alibaba/nacos>https://github.com/alibaba/nacos</a></li></ul><ul class="list-unstyled d-flex justify-content-between align-items-center mb-0 pt-5"><li><a href=/blog/2018/10/05/introduction-to-the-dubbo-protocol/ class="btn btn-primary"><span class=mr-1>←</span> Previous</a></li><a href=/blog/2018/12/10/the-fifth-dubbo-meetup-has-been-held-in-hangzhou/ class="btn btn-primary">Next <span class=ml-1>→</span></a></li></ul></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Dubbo mailing list archive" aria-label="Dubbo mailing list archive"><a class=text-white target=_blank rel="noopener noreferrer" href=https://lists.apache.org/list.html?dev@dubbo.apache.org><i class="fa fa-envelope"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel="noopener noreferrer" href=https://twitter.com/ApacheDubbo><i class="fab fa-twitter"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel="noopener noreferrer" href=https://github.com/apache/dubbo><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Subscribe to mailing list" aria-label="Subscribe to mailing list"><a class=text-white target=_blank rel="noopener noreferrer" href=mailto://dev-subscribe@dubbo.apache.org><i class="fa fa-envelope"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2020 The Apache Software Foundation. Apache and the Apache feather logo are trademarks of The Apache Software Foundation. All Rights Reserved</small></div></div></div></footer><div class="row pt-2 pb-2"><div class="container-fluid mx-sm-5"><div class=text-center id=my-footer><img style=float:left src=/imgs/apache_logo.png><ul><li><a href=http://www.apache.org>Foundation</a></li><li><a href=http://www.apache.org/licenses/>License</a></li><li><a href=https://www.apache.org/security/>Security</a></li><li><a href=http://www.apache.org/events/current-event>Events</a></li><li><a href=http://www.apache.org/foundation/sponsorship.html>Sponsorship</a></li><li><a href=http://www.apache.org/foundation/thanks.html>Thanks</a></li></ul></div></div></div></div><script src=/js/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script><script src=/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script><script src=/js/main.min.b5fc1b29d2465835844254bd4d804738eaf24c0cec53009b4c6899989be55a47.js integrity="sha256-tfwbKdJGWDWEQlS9TYBHOOryTAzsUwCbTGiZmJvlWkc=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/docsearch.js@2.6.3/dist/cdn/docsearch.min.js></script><script>docsearch({apiKey:'38eff7758162fbf70f2b8484932e62ae',indexName:'apache_dubbo',inputSelector:'.td-search-input',debug:false,});</script></body></html>