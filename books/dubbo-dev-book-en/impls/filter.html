
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>5.2 Filter Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="invoker-listener.html" />
    
    
    <link rel="prev" href="protocol.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../build.html">
            
                <a href="../build.html">
            
                    
                    1 How To Build
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../design.html">
            
                <a href="../design.html">
            
                    
                    2 Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../SPI.html">
            
                <a href="../SPI.html">
            
                    
                    3 How SPI Works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../implementation.html">
            
                <a href="../implementation.html">
            
                    
                    4 Init, Process, Protocols
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="introduction.html">
            
                <a href="introduction.html">
            
                    
                    5 SPI Extensions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="protocol.html">
            
                <a href="protocol.html">
            
                    
                    5.1 Protocol
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.6.2" data-path="filter.html">
            
                <a href="filter.html">
            
                    
                    5.2 Filter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="invoker-listener.html">
            
                <a href="invoker-listener.html">
            
                    
                    5.3 InvokerListener
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="exporter-listener.html">
            
                <a href="exporter-listener.html">
            
                    
                    5.4 ExporterListener
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="cluster.html">
            
                <a href="cluster.html">
            
                    
                    5.5 Cluster
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="router.html">
            
                <a href="router.html">
            
                    
                    5.6 Router
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="load-balance.html">
            
                <a href="load-balance.html">
            
                    
                    5.7 LoadBalance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.8" data-path="merger.html">
            
                <a href="merger.html">
            
                    
                    5.8 Merger
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.9" data-path="registry.html">
            
                <a href="registry.html">
            
                    
                    5.9 Registry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.10" data-path="monitor.html">
            
                <a href="monitor.html">
            
                    
                    5.10 Monitor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.11" data-path="extension-factory.html">
            
                <a href="extension-factory.html">
            
                    
                    5.11 ExtensionFactory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.12" data-path="proxy-factory.html">
            
                <a href="proxy-factory.html">
            
                    
                    5.12 ProxyFactory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.13" data-path="compiler.html">
            
                <a href="compiler.html">
            
                    
                    5.13 Compiler
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.14" data-path="dispatcher.html">
            
                <a href="dispatcher.html">
            
                    
                    5.14 Dispatcher
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.15" data-path="threadpool.html">
            
                <a href="threadpool.html">
            
                    
                    5.15 Threadpool
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.16" data-path="serialize.html">
            
                <a href="serialize.html">
            
                    
                    5.16 Serialization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.17" data-path="remoting.html">
            
                <a href="remoting.html">
            
                    
                    5.17 Remoting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.18" data-path="exchanger.html">
            
                <a href="exchanger.html">
            
                    
                    5.18 Exchanger
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.19" data-path="networker.html">
            
                <a href="networker.html">
            
                    
                    5.19 Networker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.20" data-path="telnet-handler.html">
            
                <a href="telnet-handler.html">
            
                    
                    5.20 TelnetHandler
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.21" data-path="status-checker.html">
            
                <a href="status-checker.html">
            
                    
                    5.21 StatusChecker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.22" data-path="container.html">
            
                <a href="container.html">
            
                    
                    5.22 Container
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.23" data-path="page.html">
            
                <a href="page.html">
            
                    
                    5.23 PageHandler
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.24" data-path="cache.html">
            
                <a href="cache.html">
            
                    
                    5.24 Cache
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.25" data-path="validation.html">
            
                <a href="validation.html">
            
                    
                    5.25 Validation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.26" data-path="logger-adapter.html">
            
                <a href="logger-adapter.html">
            
                    
                    5.26 LoggerAdapter
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../contract.html">
            
                <a href="../contract.html">
            
                    
                    6 Contract
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../coding.html">
            
                <a href="../coding.html">
            
                    
                    7 Code Style
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../release.html">
            
                <a href="../release.html">
            
                    
                    9 Versions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../contribution.html">
            
                <a href="../contribution.html">
            
                    
                    10 Contribution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../checklist.html">
            
                <a href="../checklist.html">
            
                    
                    11 Checklist
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../code-smell.html">
            
                <a href="../code-smell.html">
            
                    
                    12 Code Smell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../TCK.html">
            
                <a href="../TCK.html">
            
                    
                    13 TCK
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >5.2 Filter</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="filter-extension">Filter Extension</h1>
<h2 id="summary">Summary</h2>
<p>Extension for intercepting the invocation for both service provider and consumer, furthermore, most of functions in dubbo are implemented base on the same mechanism. Since every time when remote method is invoked, the filter extensions will be executed too, the corresponding penalty should be considered before more filters are added.</p>
<p>Contract:</p>
<ul>
<li>User defined filters are executed after built-in filters by default.</li>
<li>Special value <code>default</code> is introduced to represent the default extension location. For example: for <code>filter=&quot;xxx,default,yyy&quot;</code>, <code>xxx</code> is before default filter, and <code>yyy</code> is after the default filter.</li>
<li>Special value <code>-</code> means delete. For example: <code>filter=&quot;-foo1&quot;</code> excludes <code>foo1</code> extension. For example, <code>filter=&quot;-default&quot;</code> exclues all default filters.</li>
<li>When provider and service have filter configured at the same moment, all filters are accumulated together instead of override, for example: for <code>&lt;dubbo:provider filter=&quot;xxx,yyy&quot;/&gt;</code> and <code>&lt;dubbo:service filter=&quot;aaa,bbb&quot; /&gt;</code>&#xFF0C;<code>xxx</code>, <code>yyy</code>, <code>aaa</code>, <code>bbb</code> are all count as filters. In order to change to override, use: <code>&lt;dubbo:service filter=&quot;-xxx,-yyy,aaa,bbb&quot; /&gt;</code> </li>
</ul>
<h2 id="extension-interface">Extension Interface</h2>
<p><code>com.alibaba.dubbo.rpc.Filter</code></p>
<h2 id="extension-configuration">Extension Configuration</h2>
<pre><code class="lang-xml"><span class="hljs-comment">&lt;!-- filter for consumer --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dubbo:reference</span> <span class="hljs-attr">filter</span>=<span class="hljs-string">&quot;xxx,yyy&quot;</span> /&gt;</span>
<span class="hljs-comment">&lt;!-- default filter configuration for the consumer, will intercept for all references --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dubbo:consumer</span> <span class="hljs-attr">filter</span>=<span class="hljs-string">&quot;xxx,yyy&quot;</span>/&gt;</span>
<span class="hljs-comment">&lt;!-- filter for provider --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dubbo:service</span> <span class="hljs-attr">filter</span>=<span class="hljs-string">&quot;xxx,yyy&quot;</span> /&gt;</span>
<span class="hljs-comment">&lt;!-- default filter configuration for the provider, will intercept for all services --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dubbo:provider</span> <span class="hljs-attr">filter</span>=<span class="hljs-string">&quot;xxx,yyy&quot;</span>/&gt;</span>
</code></pre>
<h2 id="existing-extension">Existing Extension</h2>
<ul>
<li><code>com.alibaba.dubbo.rpc.filter.EchoFilter</code></li>
<li><code>com.alibaba.dubbo.rpc.filter.GenericFilter</code></li>
<li><code>com.alibaba.dubbo.rpc.filter.GenericImplFilter</code></li>
<li><code>com.alibaba.dubbo.rpc.filter.TokenFilter</code></li>
<li><code>com.alibaba.dubbo.rpc.filter.AccessLogFilter</code></li>
<li><code>com.alibaba.dubbo.rpc.filter.CountFilter</code></li>
<li><code>com.alibaba.dubbo.rpc.filter.ActiveLimitFilter</code></li>
<li><code>com.alibaba.dubbo.rpc.filter.ClassLoaderFilter</code></li>
<li><code>com.alibaba.dubbo.rpc.filter.ContextFilter</code></li>
<li><code>com.alibaba.dubbo.rpc.filter.ConsumerContextFilter</code></li>
<li><code>com.alibaba.dubbo.rpc.filter.ExceptionFilter</code></li>
<li><code>com.alibaba.dubbo.rpc.filter.ExecuteLimitFilter</code></li>
<li><code>com.alibaba.dubbo.rpc.filter.DeprecatedFilter</code></li>
</ul>
<h2 id="extension-guide">Extension Guide</h2>
<p>Directory layout:</p>
<pre><code>src
 |-main
    |-java
        |-com
            |-xxx
                |-XxxFilter.java (Filter implementation)
    |-resources
        |-META-INF
            |-dubbo
                |-com.alibaba.dubbo.rpc.Filter (plain text file with the content: xxx=com.xxx.XxxFilter)
</code></pre><p>XxxFilter.java&#xFF1A;</p>
<pre><code class="lang-java"><span class="hljs-keyword">package</span> com.xxx;

<span class="hljs-keyword">import</span> com.alibaba.dubbo.rpc.Filter;
<span class="hljs-keyword">import</span> com.alibaba.dubbo.rpc.Invoker;
<span class="hljs-keyword">import</span> com.alibaba.dubbo.rpc.Invocation;
<span class="hljs-keyword">import</span> com.alibaba.dubbo.rpc.Result;
<span class="hljs-keyword">import</span> com.alibaba.dubbo.rpc.RpcException;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">XxxFilter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Filter</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> Result <span class="hljs-title">invoke</span><span class="hljs-params">(Invoker&lt;?&gt; invoker, Invocation invocation)</span> <span class="hljs-keyword">throws</span> RpcException </span>{
        <span class="hljs-comment">// before filter ...</span>
        Result result = invoker.invoke(invocation);
        <span class="hljs-comment">// after filter ...</span>
        <span class="hljs-keyword">return</span> result;
    }
}
</code></pre>
<p>META-INF/dubbo/com.alibaba.dubbo.rpc.Filter&#xFF1A;</p>
<pre><code class="lang-properties">xxx=com.xxx.XxxFilter
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="protocol.html" class="navigation navigation-prev " aria-label="Previous page: 5.1 Protocol">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="invoker-listener.html" class="navigation navigation-next " aria-label="Next page: 5.3 InvokerListener">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"5.2 Filter","level":"1.6.2","depth":2,"next":{"title":"5.3 InvokerListener","level":"1.6.3","depth":2,"path":"impls/invoker-listener.md","ref":"./impls/invoker-listener.md","articles":[]},"previous":{"title":"5.1 Protocol","level":"1.6.1","depth":2,"path":"impls/protocol.md","ref":"./impls/protocol.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"impls/filter.md","mtime":"2018-03-19T06:46:50.845Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-06-07T06:52:21.618Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

