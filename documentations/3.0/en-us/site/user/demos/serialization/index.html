<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>Kryo&FST serialization - Dubbo 2.7.8</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Kryo&FST serialization";
    var mkdocs_page_input_path = "user/demos/serialization.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> Dubbo 2.7.8</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <span class="caption-text">User's Guide</span>
    <ul class="subnav">
                <li class="">
                    
    <span class="caption-text">Preface</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../preface/background/">Bakcground</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../preface/background/">Requirements</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../preface/architecture/">Architecture</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../preface/usage/">Usage</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../../quick-start/">Quick Start</a>
                </li>
                <li class="">
                    
    <a class="" href="../../dependencies/">Dependencies</a>
                </li>
                <li class="">
                    
    <a class="" href="../../maturity/">Maturity</a>
                </li>
                <li class="">
                    
    <span class="caption-text">Configuration</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../configuration/xml/">XML Configuration</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../configuration/api/">API Configuration</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../configuration/annotation/">Annotation Configuration</a>
                </li>
    </ul>
                </li>
                <li class=" current">
                    
    <span class="caption-text">Demos</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../preflight-check/">Check on start</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../fault-tolerent-strategy/">Fault tolerance</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../loadbalance/">Load balance</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../thread-model/">Thread model</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../explicit-target/">Connecting certain provider straightly</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../subscribe-only/">Subscribe only</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../registry-only/">Register only</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../static-service/">Static service</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../multi-protocols/">Multi-protocols</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../multi-registry/">Multi-registries</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../service-group/">Grouping</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../multi-versions/">Versions</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../group-merger/">Group merger</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../parameter-validation/">Parameter validation</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../result-cache/">Result cache</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../generic-reference/">Generic call</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../generic-service/">Generic implementation</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../echo-service/">Echo service</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../context/">Context</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../attachment/">Attachment</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../async-call/">Async call</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../local-call/">Local call</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../callback-parameter/">Parameter callback</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../events-notify/">Event callback</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../local-stub/">Local stub</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../local-mock/">Local mock</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../delay-publish/">Delay publish</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../concurrency-control/">Concurrency limit</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../config-connection.md">Connection limit</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../lazy-connect/">Lazy connec</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../stickiness/">Stickness connection</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../token-authorization/">Token authorization</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../routing-rule/">Routing rule</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../config-rule/">Config rule</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../service-downgrade/">Service downgrade</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../graceful-shutdown/">Graceful shutdown</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../hostname-binding/">Host binding</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../logger-strategy/">Logger</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../accesslog/">Accesslog</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../service-container/">Container</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../distributed-transaction/">Transaction</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../dump/">Thread dump</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../netty4/">Netty4</a>
                </li>
                <li class="toctree-l3 current">
                    
    <a class="current" href="./">Kryo&FST serialization</a>
    <ul class="subnav">
            
    <li class="toctree-l4"><a href="#using-efficient-java-serialization-in-dubbo-kryo-and-fst">Using Efficient Java Serialization in Dubbo (Kryo and FST)</a></li>
    

    <li class="toctree-l4"><a href="#start-kryo-and-fst">Start Kryo and FST</a></li>
    

    <li class="toctree-l4"><a href="#register-serialized-class">Register serialized class</a></li>
    

    </ul>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../simplify-registry-data.md">Simplified registry URL</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../api.md">API reference</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Schema reference</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../references/xml/dubbo-service/">dubbo:service</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/xml/dubbo-reference/">dubbo:reference</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/xml/dubbo-protocol/">dubbo:protocol</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/xml/dubbo-registry/">dubbo:registry</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/xml/dubbo-monitor/">dubbo:monitor</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/xml/dubbo-application/">dubbo:application</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/xml/dubbo-module/">dubbo:module</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/xml/dubbo-provider/">dubbo:provider</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/xml/dubbo-consumer/">dubbo:consumer</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/xml/dubbo-method/">dubbo:method</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/xml/dubbo-argument/">dubbo:argument</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/xml/dubbo-parameter/">dubbo:parameter</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/xml/dubbo-config-center/">dubbo:config-center</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Protocol reference</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../references/protocol/dubbo/">dubbo://</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/protocol/rmi/">rmi://</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/protocol/hessian/">hessian://</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/protocol/http/">http://</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/protocol/thrift/">thrift://</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/protocol/rest/">rest://</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Registry reference</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../references/registry/multicast/">Multicast</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/registry/zookeeper/">Zookeeper</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/registry/redis/">Redis</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/registry/simple/">Simple</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Metadata reference</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../references/metadata/metadata-redis.md">Redis</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../references/registry/metadata-zookeeper.md">Zookeeper</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../../references/telnet/">Telnet reference</a>
                </li>
                <li class="">
                    
    <a class="" href="../../references/maven/">Maven plugin reference</a>
                </li>
                <li class="">
                    
    <a class="" href="../../best-practice/">Best practice</a>
                </li>
                <li class="">
                    
    <a class="" href="../../recommend/">Recommendation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../capacity-plan/">Capacity plan</a>
                </li>
                <li class="">
                    
    <a class="" href="../../perf-test/">Benchmark</a>
                </li>
                <li class="">
                    
    <a class="" href="../../covergence.md">Code coverange</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Developer's Guide</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../dev/build/">How to Build</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../dev/design/">Architecture</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../dev/SPI/">How SPI Works</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../dev/implementation/">Init, Process, Protocols</a>
                </li>
                <li class="">
                    
    <span class="caption-text">SPI Extensions</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/protocol/">Protocol</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/filter/">Filter</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/invoker-listener/">Invoker Listener</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/exporter-listener/">Exporter Listener</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/cluster/">Cluster</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/router/">Router</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/load-balance/">Load Balance</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/merger/">Merge</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/registry/">Registry</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/monitor/">Monitor</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/extension-factory/">Extension Factory</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/proxy-factory/">Proxy Factory</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/compiler/">Compiler</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/dispatcher/">Dispatcher</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/threadpool/">Threadpool</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/serialize/">Serialize</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/remoting/">Remoting</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/exchanger/">Exchanger</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/networker/">Networker</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/telnet-handler/">Telnet Handler</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/status-checker/">Status Checker</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/container/">Container</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/page/">Page</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/cache/">Cache</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/validation/">Validation</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../dev/impls/logger-adapter/">Logger Adapter</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../../../dev/contract/">Contract</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../dev/coding/">Coding</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../dev/release/">Release</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../dev/contribution/">Contribution</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../dev/checklist/">Checklist</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../dev/code-smell/">Code Smell</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../dev/TCK/">TCK</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Admin's Guide</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../admin/introduction/">Dubbo Admin Overview</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../admin/serviceSearch/">Search & Details</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../admin/serviceGovernance/">Governance</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../admin/serviceTest/">Testing</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">Dubbo 2.7.8</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Demos &raquo;</li>
        
      
        
          <li>User's Guide &raquo;</li>
        
      
    
    <li>Kryo&FST serialization</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/apache/dubbo-website/edit/master/documentations/2.7/en-us/docs/user/demos/serialization.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="using-efficient-java-serialization-in-dubbo-kryo-and-fst"><font size=6>Using Efficient Java Serialization in Dubbo (Kryo and FST)</font></h2>
<h2 id="start-kryo-and-fst">Start Kryo and FST</h2>
<p><font size=3>Using Kryo and FST is very simple, just add an attribute to the dubbo RPC XML configurition:</font></p>
<pre><code>&lt;dubbo:protocol name=&quot;dubbo&quot; serialization=&quot;kryo&quot;/&gt;
</code></pre>

<pre><code>&lt;dubbo:protocol name=&quot;dubbo&quot; serialization=&quot;fst&quot;/&gt;
</code></pre>

<h2 id="register-serialized-class">Register serialized class</h2>
<p><font size=3>For releasing the high ability of Kryo and FST, it's best to register the classes that need serializing into the dubbo system. For example, we can implement the following callback interface: </font></p>
<pre><code>public class SerializationOptimizerImpl implements SerializationOptimizer {

    public Collection&lt;Class&gt; getSerializableClasses() {
        List&lt;Class&gt; classes = new LinkedList&lt;Class&gt;();
        classes.add(BidRequest.class);
        classes.add(BidResponse.class);
        classes.add(Device.class);
        classes.add(Geo.class);
        classes.add(Impression.class);
        classes.add(SeatBid.class);
        return classes;
    }
}
</code></pre>
<p><font size=3>Then add in the XML configuration:</font></p>
<pre><code>&lt;dubbo:protocol name=&quot;dubbo&quot; serialization=&quot;kryo&quot; optimizer=&quot;org.apache.dubbo.demo.SerializationOptimizerImpl&quot;/&gt;
</code></pre>

<p><font size=3>After registering these classes, serialization performance can be greatly improved, especially for small numbers of nested objects.</p>
<p>Of course, when serializing a class, you might also cascade references to many classes, such as Java collection classes. In this case, we've automatically registered common classes in the JDK, so you don't need to register them repeatedly (and of course, it doesn't matter if you register them again), including:</font></p>
<pre><code>GregorianCalendar
InvocationHandler
BigDecimal
BigInteger
Pattern
BitSet
URI
UUID
HashMap
ArrayList
LinkedList
HashSet
TreeSet
Hashtable
Date
Calendar
ConcurrentHashMap
SimpleDateFormat
Vector
BitSet
StringBuffer
StringBuilder
Object
Object[]
String[]
byte[]
char[]
int[]
float[]
double[]
</code></pre>
<p><font size=3>Since registering serialized classes is only for performance optimization purposes, it doesn't matter if you forget to register some classes. In fact, Kryo and FST generally perform better than Hessian and Dubbo serializations even if no classes are registered.</font></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../references/xml/dubbo-service/" class="btn btn-neutral float-right" title="dubbo:service">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../netty4/" class="btn btn-neutral" title="Netty4"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/apache/dubbo-website/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../netty4/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../references/xml/dubbo-service/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="../../../search/main.js" defer></script>

</body>
</html>
