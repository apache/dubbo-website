<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>性能测试报告 - Dubbo 3.0.0</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "\u6027\u80fd\u6d4b\u8bd5\u62a5\u544a";
    var mkdocs_page_input_path = "user/perf-test.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Dubbo 3.0.0</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <span class="caption-text">用户手册</span>
    <ul class="subnav">
                <li class="">
                    
    <span class="caption-text">入门</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../preface/background/">背景</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../preface/background/">需求</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../preface/architecture/">架构</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../preface/usage/">用法</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../quick-start/">快速启动</a>
                </li>
                <li class="">
                    
    <a class="" href="../dependencies/">依赖</a>
                </li>
                <li class="">
                    
    <a class="" href="../maturity/">成熟度</a>
                </li>
                <li class="">
                    
    <span class="caption-text">配置</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../configuration/xml/">XML 配置</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../configuration/api/">API 配置</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../configuration/annotation/">Annotation 配置</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../configuration/annotation/">动态配置中心</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../configuration/configuration-load-process/">配置加载流程</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../configuration/environment-variables/">自动加载环境变量</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">示例</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../demos/preflight-check/">启动时检查</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/fault-tolerent-strategy/">集群容错</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/loadbalance/">负载均衡</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/thread-model/">线程模型</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/explicit-target/">直连提供者</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/subscribe-only/">只订阅</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/registry-only/">只注册</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/static-service/">静态服务</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/multi-protocols/">多协议</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/multi-registry/">多注册中心</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/service-group/">服务分组</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/multi-versions/">多版本</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/group-merger/">分组聚合</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/parameter-validation/">参数验证</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/result-cache/">结果缓存</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/generic-reference/">泛化引用</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/generic-service/">泛化实现</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/echo-service/">回声测试</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/context/">上下文信息</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/attachment/">隐式参数</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/async-call/">异步调用</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/async-execute-on-provider/">服务端异步</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/local-call/">本地调用</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/callback-parameter/">参数回调</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/events-notify/">事件通知</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/local-stub/">本地存根</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/local-mock/">本地伪装</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/delay-publish/">延迟暴露</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/concurrency-control/">并发控制</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/config-connection.md">连接控制</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/lazy-connect/">延迟连接</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/stickiness/">粘滞连接</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/token-authorization/">令牌验证</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/routing-rule/">路由规则</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/config-rule/">配置规则</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/service-downgrade/">服务降级</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/graceful-shutdown/">优雅停机</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/hostname-binding/">主机绑定</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/logger-strategy/">日志适配</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/accesslog/">访问日志</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/service-container/">服务容器</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/distributed-transaction/">分布式事务</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/dump/">线程栈自动dump</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/netty4/">Netty4</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/serialization/">Kryo和FST序列化</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/simplify-registry-data/">简化注册中心URL</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../demos/api.md">API 参考手册</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">schema 配置参考手册</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../references/xml/dubbo-service/">dubbo:service</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/xml/dubbo-reference/">dubbo:reference</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/xml/dubbo-protocol/">dubbo:protocol</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/xml/dubbo-registry/">dubbo:registry</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/xml/dubbo-monitor/">dubbo:monitor</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/xml/dubbo-application/">dubbo:application</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/xml/dubbo-module/">dubbo:module</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/xml/dubbo-provider/">dubbo:provider</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/xml/dubbo-consumer/">dubbo:consumer</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/xml/dubbo-method/">dubbo:method</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/xml/dubbo-argument/">dubbo:argument</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/xml/dubbo-parameter/">dubbo:parameter</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/xml/dubbo-config-center/">dubbo:config-center</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">协议参考手册</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../references/protocol/dubbo/">dubbo://</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/protocol/rmi/">rmi://</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/protocol/hessian/">hessian://</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/protocol/http/">http://</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/protocol/thrift/">thrift://</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/protocol/rest/">rest://</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">注册中心参考手册</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../references/registry/multicast/">Multicast 注册中心</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/registry/zookeeper/">Zookeeper 注册中心</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/registry/redis/">Redis 注册中心</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/registry/simple/">Simple 注册中心</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">元数据中心参考手册</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../references/metadata/metadata-redis/">Redis 元数据中心</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../references/metadata/metadata-zookeeper/">Zookeeper 元数据中心</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../references/telnet/">telnet 命令参考手册</a>
                </li>
                <li class="">
                    
    <a class="" href="../references/qos/">在线运维命令-QOS</a>
                </li>
                <li class="">
                    
    <a class="" href="../references/maven/">maven 插件参考手册</a>
                </li>
                <li class="">
                    
    <a class="" href="../best-practice/">服务化最佳实践</a>
                </li>
                <li class="">
                    
    <a class="" href="../recommend/">推荐用法</a>
                </li>
                <li class="">
                    
    <a class="" href="../capacity-plan/">容量规划</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">性能测试报告</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#_1">性能测试报告</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#_2">测试说明</a></li>
        
            <li><a class="toctree-l4" href="#_3">测试环境</a></li>
        
            <li><a class="toctree-l4" href="#_6">测试目的</a></li>
        
            <li><a class="toctree-l4" href="#_9">测试脚本</a></li>
        
            <li><a class="toctree-l4" href="#_10">测试结果</a></li>
        
            <li><a class="toctree-l4" href="#_11">测试分析</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../covergence.md">测试覆盖率报告</a>
                </li>
                <li class="">
                    
    <span class="caption-text">版本与升级</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../version-270.md">2.7.x升级步骤及注意事项</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">开发手册</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../dev/build/">源码构建</a>
                </li>
                <li class="">
                    
    <a class="" href="../../dev/design/">框架设计</a>
                </li>
                <li class="">
                    
    <a class="" href="../../dev/SPI/">扩展点加载</a>
                </li>
                <li class="">
                    
    <a class="" href="../../dev/implementation/">实现细节</a>
                </li>
                <li class="">
                    
    <span class="caption-text">SPI 扩展实现</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/protocol/">协议扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/filter/">调用拦截扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/invoker-listener/">引用监听扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/exporter-listener/">暴露监听扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/cluster/">集群扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/router/">路由扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/load-balance/">负载均衡扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/merger/">合并结果扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/registry/">注册中心扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/monitor/">监控中心扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/extension-factory/">扩展点加载扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/proxy-factory/">动态代理扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/compiler/">编译器扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/dispatcher/">消息派发扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/threadpool/">线程池扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/serialize/">序列化扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/remoting/">网络传输扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/exchanger/">信息交换扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/networker/">组网扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/telnet-handler/">Telnet 命令扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/status-checker/">状态检查扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/container/">容器扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/page/">页面扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/cache/">缓存扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/validation/">验证扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/logger-adapter/">日志适配扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/impls/config-center/">配置中心</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../../dev/contract/">公共契约</a>
                </li>
                <li class="">
                    
    <a class="" href="../../dev/coding/">编码约定</a>
                </li>
                <li class="">
                    
    <span class="caption-text">设计原则</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/principals/code-detail/">魔鬼在细节</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/principals/general-knowledge/">一些设计上的基本常识</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/principals/expansibility/">谈谈扩充式扩展与增量式扩展</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/principals/configuration/">配置设计</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/principals/robustness/">设计实现的健壮性</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/principals/dummy/">防痴呆设计</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dev/principals/extension/">扩展点重构</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../../dev/release/">版本发布</a>
                </li>
                <li class="">
                    
    <a class="" href="../../dev/contribution/">贡献代码</a>
                </li>
                <li class="">
                    
    <a class="" href="../../dev/checklist/">检查列表</a>
                </li>
                <li class="">
                    
    <a class="" href="../../dev/code-smell/">坏味道</a>
                </li>
                <li class="">
                    
    <a class="" href="../../dev/TCK/">兼容性测试</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">管理者文档</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../admin/introduction/">Dubbo Admin介绍</a>
                </li>
                <li class="">
                    
    <a class="" href="../../admin/serviceSearch/">服务搜索和详情</a>
                </li>
                <li class="">
                    
    <a class="" href="../../admin/serviceGovernance/">服务治理</a>
                </li>
                <li class="">
                    
    <a class="" href="../../admin/serviceTest/">服务测试</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Dubbo 3.0.0</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>用户手册 &raquo;</li>
        
      
    
    <li>性能测试报告</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/apache/dubbo-website/edit/master/documentations/3.0/zh-cn/docs/user/perf-test.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="_1">性能测试报告</h1>
<h2 id="_2">测试说明</h2>
<ol>
<li>本次性能测试，测试了 dubbo 2.0 所有支持的协议在不同大小和数据类型下的表现，并与 dubbo 1.0 进行了对比。</li>
<li>整体性能相比 1.0 有了提升，平均提升 10%，使用 dubbo 2.0 新增的 dubbo 序列化还能获得 10%~50% 的性能提升，详见下面的性能数据。</li>
<li>稳定性测试中由于将底层通信框架从 mina 换成 netty，old 区对象的增长大大减少，50 小时运行，增长不到 200m，无 fullgc。</li>
<li>存在的问题：在 50k 数据的时候 2.0 性能不如 1.0，怀疑可能是缓冲区设置的问题，下版本会进一步确认。 </li>
</ol>
<h2 id="_3">测试环境</h2>
<h3 id="_4">硬件部署与参数调整</h3>
<table>
<thead>
<tr>
<th>机型</th>
<th>CPU</th>
<th>内存</th>
<th>网络</th>
<th>磁盘</th>
<th>内核</th>
</tr>
</thead>
<tbody>
<tr>
<td>Tecal BH620</td>
<td>model name : Intel(R) Xeon(R) CPU           E5520  @ 2.27GHz cache size : 8192 KB processor_count : 16</td>
<td>Total System Memory: 6G Hardware Memory Info:  Size: 4096MB</td>
<td>eth0: Link is up at 1000 Mbps, full duplex. peth0: Link is up at 1000 Mbps, full duplex.</td>
<td>/dev/sda: 597.9 GB</td>
<td>2.6.18-128.el5xen x86_64</td>
</tr>
</tbody>
</table>
<h3 id="_5">软件架构</h3>
<table>
<thead>
<tr>
<th>软件名称及版本</th>
<th>关键参数</th>
</tr>
</thead>
<tbody>
<tr>
<td>java version "1.6.0_18" Java(TM) SE Runtime Environment (build 1.6.0_18-b07) Java HotSpot(TM) 64-Bit Server VM (build 16.0-b13, mixed mode)</td>
<td>-server -Xmx2g -Xms2g -Xmn256m -XX:PermSize=128m -Xss256k -XX:+DisableExplicitGC -XX:+UseConcMarkSweepGC -XX:+CMSParallelRemarkEnabled -XX:+UseCMSCompactAtFullCollection -XX:LargePageSizeInBytes=128m -XX:+UseFastAccessorMethods -XX:+UseCMSInitiatingOccupancyOnly -XX:CMSInitiatingOccupancyFraction=70</td>
</tr>
<tr>
<td>jboss-4.0.5.GA</td>
<td></td>
</tr>
<tr>
<td>httpd-2.0.61</td>
<td>KeepAlive On MaxKeepAliveRequests 100000 KeepAliveTimeout 180 MaxRequestsPerChild 1000000 <IfModule worker.c>         StartServers 5         MaxClients 1024         MinSpareThreads 25         MaxSpareThreads 75         ThreadsPerChild 64         ThreadLimit 128         ServerLimit 16 </IfModule></td>
</tr>
</tbody>
</table>
<h2 id="_6">测试目的</h2>
<h3 id="_7">期望性能指标(量化)</h3>
<table>
<thead>
<tr>
<th>场景名称</th>
<th>对应指标名称</th>
<th>期望值范围</th>
<th>实际值</th>
<th>是否满足期望(是/否)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1k数据</td>
<td>响应时间</td>
<td>0.9ms</td>
<td>0.79ms</td>
<td>是</td>
</tr>
<tr>
<td>1k数据</td>
<td>TPS</td>
<td>10000</td>
<td>11994</td>
<td>是</td>
</tr>
</tbody>
</table>
<h3 id="_8">期望运行状况(非量化，可选)</h3>
<ul>
<li>2.0 性能不低于 1.0, 2.0 和 1.0 互调用的性能无明显下降。 除了 50k string 其余皆通过</li>
<li>JVM 内存运行稳定，无 OOM，堆内存中无不合理的大对象的占用。通过</li>
<li>CPU、内存、网络、磁盘、文件句柄占用平稳。通过</li>
<li>无频繁线程锁，线程数平稳。通过</li>
<li>业务线程负载均衡。通过</li>
</ul>
<h2 id="_9">测试脚本</h2>
<ol>
<li>
<p>性能测试场景（10 并发）</p>
<ul>
<li>传入 1k String，不做任何处理，原样返回</li>
<li>传入 50k String，不做任何处理，原样返回</li>
<li>传入 200k String，不做任何处理，原样返回</li>
<li>传入 1k POJO（嵌套的复杂 person 对象），不做任何处理，原样返回</li>
</ul>
<p>上述场景在 dubbo 1.0, dubbo 2.0(hessian2序列化), dubbo 2.0(dubbo序列化), rmi, hessian 3.2.0, http(json序列化) 进行 10 分钟的性能测试。主要考察序列化和网络 IO 的性能，因此服务端无任何业务逻辑。取 10 并发是考虑到 http 协议在高并发下对 CPU 的使用率较高可能会先打到瓶颈。 
0. 并发场景（20 并发）
传入 1k String，在服务器段循环 1w 次，每次重新生成一个随机数然后进行拼装。考察业务线程是否能够分配到每个 CPU 上。 
0. 稳定性场景（20 并发）
同时调用 1 个参数为 String（5k）方法，1 个参数为 person 对象的方法，1 个参数为 map（值为 3 个 person）的方法，持续运行 50 小时。 
0. 高压力场景（20 并发）
在稳定性场景的基础上，将提供者和消费者布置成均为 2 台（一台机器 2 个实例），且 String 的参数从 20byte 到 200k，每隔 10 分钟随机变换。 </p>
</li>
</ol>
<h2 id="_10">测试结果</h2>
<h3 id="pojo">场景名称：POJO 场景</h3>
<p>| TPS成功平均值 | 响应时间成功平均值(ms) 
 ------------- | ------------- | ------------- 
 dubbo1 (hessian2序列化+mina)| 10813.5 | 0.9 
 dubbo2 (hessian2序列化+netty) | 11994 | 0.79 
 dubbo2 (dubbo序列化+netty) | 13620 | 0.67 
 rmi | 2461.79 | 4 
 hessian | 2417.7 | 4.1 
 http（json序列化）| 8179.08 | 1.15 
 2.0和1.0默认对比百分比 | 10.92 | -12.22 
 dubbo序列化相比hessian2序列化百分比 | 13.56 | -15.19 </p>
<p>POJO TPS</p>
<p><img alt="pojotps.png" src="../sources/images/pojotps.png" /></p>
<p>POJO Response</p>
<p><img alt="pojores.png" src="../sources/images/pojores.png" /></p>
<h3 id="1k-string">场景名称：1k string 场景</h3>
<p>| TPS成功平均值 | 响应时间成功平均值(ms) 
------------- | ------------- | ------------- 
dubbo1（hessian2序列化+mina）| 11940 | 0.8 
dubbo2 (hessian2序列化+netty) | 14402 | 0.64 
dubbo2 (dubbo序列化+netty) | 15096 | 0.6 
rmi | 11136.02 | 0.81 
hessian | 11426.83 | 0.79 
http（json序列化）| 8919.27 | 1.04 
2.0和1.0默认对比百分比 | 20.62 | -20.00 
dubbo序列化相比hessian2序列化百分比 | 4.82 | -6.25 </p>
<p>1k TPS</p>
<p><img alt="1ktps.png" src="../sources/images/1ktps.png" /></p>
<p>1k Response</p>
<p><img alt="1kres.png" src="../sources/images/1kres.png" /></p>
<h3 id="50k-string">场景名称：50k string 场景</h3>
<p>| TPS成功平均值 | 响应时间成功平均值(ms) 
------------- | ------------- | ------------- 
 dubbo1（hessian2序列化+mina | 1962.7 | 5.1 
 dubbo2 (hessian2序列化+netty) | 1293 | 5.03 
 dubbo2 (dubbo序列化+netty) | 1966 | 7.68 
 rmi | 3349.88 | 2.9 
 hessian | 1925.33 | 5.13 
 http（json序列化）| 3247.1 | 3 
 2.0和1.0默认对比百分比 | -34.12 | -1.37 
 dubbo序列化相比hessian2序列化百分比 | 52.05 | 52.68 </p>
<p>50K TPS</p>
<p><img alt="50ktps.png" src="../sources/images/50ktps.png" /></p>
<p>50K Response</p>
<p><img alt="50kres.png" src="../sources/images/50kres.png" /></p>
<h3 id="200k-string">场景名称：200k string 场景</h3>
<p>| TPS成功平均值 | 响应时间成功平均值(ms) 
------------- | ------------- | ------------- 
 dubbo1（hessian2序列化+mina）| 324.2 | 30.8 
 dubbo2 (hessian2序列化+netty) | 362.92 | 27.49 
 dubbo2 (dubbo序列化+netty) | 569.5 | 17.51 
 rmi | 1031.28 | 9.61
 hessian | 628.06 | 15.83 
 http（json序列化）| 1011.97 | 9.79 
 2.0和1.0默认对比百分比 | 11.94 | -10.75 
 dubbo序列化相比hessian2序列化百分比 | 56.92 | -36.30 </p>
<p>200K TPS</p>
<p><img alt="200ktps.png" src="../sources/images/200ktps.png" /></p>
<p><strong>200K Response</strong></p>
<p><img alt="200kres.png" src="../sources/images/200kres.png" /></p>
<h2 id="_11">测试分析</h2>
<h3 id="_12">性能分析评估</h3>
<p>Dubbo 2.0 的性能测试结论为通过，从性能、内存占用和稳定性上都有了提高和改进。由其是内存管理由于将 mina 换成netty，大大减少了 1.0 版本在高并发大数据下的内存大锯齿。</p>
<h3 id="_13">性能对比分析(新旧环境、不同数据量级等)</h3>
<p>Dubbo 2.0 相比较Dubbo 1.0（默认使用的都是 hessian2 序列化）性能均有提升（除了50k String），详见第五章的性能数据。</p>
<p>出于兼容性考虑默认的序列化方式和 1.0 保持一致使用 hessian2，如对性能有更高要求可以使用 dubbo 序列化，由其是在处理复杂对象时，在大数据量下能获得 50% 的提升（但此时已不建议使用 Dubbo 协议）。</p>
<p>Dubbo 的设计目的是为了满足高并发小数据量的 rpc 调用，在大数据量下的性能表现并不好，建议使用 rmi 或 http 协议。</p>
<h3 id="_14">测试局限性分析（可选）</h3>
<p>本次性能测试考察的是 dubbo 本身的性能，实际使用过程中的性能有待应用来验证。</p>
<p>由于 dubbo 本身的性能占用都在毫秒级，占的基数很小，性能提升可能对应用整体的性能变化不大。</p>
<p>由于邮件篇幅所限没有列出所有的监控图，如需获得可在大力神平台上查询。</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../dev/build/" class="btn btn-neutral float-right" title="源码构建">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../capacity-plan/" class="btn btn-neutral" title="容量规划"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/apache/dubbo-website/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../capacity-plan/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../dev/build/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
