<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="keywords" content="code-smell" />
	<meta name="description" content="code-smell" />
	<!-- 网页标签标题 -->
	<title>code-smell</title>
	<link rel="shortcut icon" href="/img/dubbo.ico"/>
	<link rel="stylesheet" href="/build/documentation.css" />
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-112489517-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());
		gtag('config', 'UA-112489517-1');
	</script>
</head>
<body>
	<div id="root"><div class="documentation-page" data-reactroot="" data-reactid="1" data-react-checksum="1612999753"><header class="header-container header-container-normal" data-reactid="2"><div class="header-body" data-reactid="3"><a href="/en-us/index.html" data-reactid="4"><img class="logo" src="/img/dubbo_colorful.png" data-reactid="5"/></a><span class="language-switch language-switch-normal" data-reactid="6">中</span><div class="header-menu" data-reactid="7"><img class="header-menu-toggle" src="/img/menu_gray.png" data-reactid="8"/><ul data-reactid="9"><li class="menu-item menu-item-normal" data-reactid="10"><a href="/en-us/index.html" data-reactid="11">HOME</a></li><li class="menu-item menu-item-normal menu-item-normal-active" data-reactid="12"><a href="/en-us/docs/user/quick-start.html" data-reactid="13">DOCS</a></li><li class="menu-item menu-item-normal" data-reactid="14"><a href="/en-us/blog/index.html" data-reactid="15">BLOG</a></li><li class="menu-item menu-item-normal" data-reactid="16"><a href="/en-us/community/index.html" data-reactid="17">COMMUNITY</a></li></ul></div></div></header><div class="bar" data-reactid="18"><div class="bar-body" data-reactid="19"><img src="/img/docs.png" class="front-img" data-reactid="20"/><span data-reactid="21">Documentation</span><img src="/img/docs.png" class="back-img" data-reactid="22"/></div></div><section class="content-section" data-reactid="23"><div class="sidemenu" data-reactid="24"><div class="sidemenu-toggle" data-reactid="25"><img src="https://img.alicdn.com/tfs/TB1E6apXHGYBuNjy0FoXXciBFXa-200-200.png" data-reactid="26"/></div><ul data-reactid="27"><li class="menu-item menu-item-level-1" data-reactid="28"><span data-reactid="29">User doc</span><ul data-reactid="30"><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="31"><span data-reactid="32"><!-- react-text: 33 -->Preface<!-- /react-text --><img style="transform:rotate(-90deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="34"/></span><ul data-reactid="35"><li class="menu-item menu-item-level-3" data-reactid="36"><a href="/en-us/docs/user/preface/background.html" target="_self" data-reactid="37">Background</a></li><li class="menu-item menu-item-level-3" data-reactid="38"><a href="/en-us/docs/user/preface/requirements.html" target="_self" data-reactid="39">Requirements</a></li><li class="menu-item menu-item-level-3" data-reactid="40"><a href="/en-us/docs/user/preface/architecture.html" target="_self" data-reactid="41">Architecture</a></li><li class="menu-item menu-item-level-3" data-reactid="42"><a href="/en-us/docs/user/preface/usage.html" target="_self" data-reactid="43">Usage</a></li></ul></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="44"><a href="/en-us/docs/user/quick-start.html" target="_self" data-reactid="45">Quick start</a></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="46"><a href="/en-us/docs/user/dependencies.html" target="_self" data-reactid="47">Dependencies</a></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="48"><a href="/en-us/docs/user/maturity.html" target="_self" data-reactid="49">Maturality</a></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="50"><span data-reactid="51"><!-- react-text: 52 -->Configuration<!-- /react-text --><img style="transform:rotate(-90deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="53"/></span><ul data-reactid="54"><li class="menu-item menu-item-level-3" data-reactid="55"><a href="/en-us/docs/user/configuration/xml.html" target="_self" data-reactid="56">XML configuration</a></li><li class="menu-item menu-item-level-3" data-reactid="57"><a href="/en-us/docs/user/configuration/properties.html" target="_self" data-reactid="58">Properties configuration</a></li><li class="menu-item menu-item-level-3" data-reactid="59"><a href="/en-us/docs/user/configuration/api.html" target="_self" data-reactid="60">API configuration</a></li><li class="menu-item menu-item-level-3" data-reactid="61"><a href="/en-us/docs/user/configuration/annotation.html" target="_self" data-reactid="62">Annotation configuration</a></li></ul></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="63"><span data-reactid="64"><!-- react-text: 65 -->Demos<!-- /react-text --><img style="transform:rotate(-90deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="66"/></span><ul data-reactid="67"><li class="menu-item menu-item-level-3" data-reactid="68"><a href="/en-us/docs/user/demos/preflight-check.html" target="_self" data-reactid="69">Start check</a></li><li class="menu-item menu-item-level-3" data-reactid="70"><a href="/en-us/docs/user/demos/fault-tolerent-strategy.html" target="_self" data-reactid="71">Fault-tolerent strategy</a></li><li class="menu-item menu-item-level-3" data-reactid="72"><a href="/en-us/docs/user/demos/loadbalance.html" target="_self" data-reactid="73">Load balance</a></li><li class="menu-item menu-item-level-3" data-reactid="74"><a href="/en-us/docs/user/demos/thread-model.html" target="_self" data-reactid="75">Thread model</a></li><li class="menu-item menu-item-level-3" data-reactid="76"><a href="/en-us/docs/user/demos/explicit-target.html" target="_self" data-reactid="77">Connecting certain provider straightly</a></li><li class="menu-item menu-item-level-3" data-reactid="78"><a href="/en-us/docs/user/demos/subscribe-only.html" target="_self" data-reactid="79">Subscribe only</a></li><li class="menu-item menu-item-level-3" data-reactid="80"><a href="/en-us/docs/user/demos/registry-only.html" target="_self" data-reactid="81">Registry only</a></li><li class="menu-item menu-item-level-3" data-reactid="82"><a href="/en-us/docs/user/demos/static-service.html" target="_self" data-reactid="83">Static service</a></li><li class="menu-item menu-item-level-3" data-reactid="84"><a href="/en-us/docs/user/demos/multi-protocols.html" target="_self" data-reactid="85">Multi-protocols</a></li><li class="menu-item menu-item-level-3" data-reactid="86"><a href="/en-us/docs/user/demos/multi-registry.html" target="_self" data-reactid="87">Multi-registries</a></li><li class="menu-item menu-item-level-3" data-reactid="88"><a href="/en-us/docs/user/demos/service-group.html" target="_self" data-reactid="89">Service group</a></li><li class="menu-item menu-item-level-3" data-reactid="90"><a href="/en-us/docs/user/demos/multi-versions.html" target="_self" data-reactid="91">Multi-versions</a></li><li class="menu-item menu-item-level-3" data-reactid="92"><a href="/en-us/docs/user/demos/group-merger.html" target="_self" data-reactid="93">Group merger</a></li><li class="menu-item menu-item-level-3" data-reactid="94"><a href="/en-us/docs/user/demos/parameter-validation.html" target="_self" data-reactid="95">Parameter validation</a></li><li class="menu-item menu-item-level-3" data-reactid="96"><a href="/en-us/docs/user/demos/result-cache.html" target="_self" data-reactid="97">Result cache</a></li><li class="menu-item menu-item-level-3" data-reactid="98"><a href="/en-us/docs/user/demos/generic-reference.html" target="_self" data-reactid="99">Generic reference</a></li><li class="menu-item menu-item-level-3" data-reactid="100"><a href="/en-us/docs/user/demos/generic-service.html" target="_self" data-reactid="101">Generic service</a></li><li class="menu-item menu-item-level-3" data-reactid="102"><a href="/en-us/docs/user/demos/echo-service.html" target="_self" data-reactid="103">Echo service</a></li><li class="menu-item menu-item-level-3" data-reactid="104"><a href="/en-us/docs/user/demos/context.html" target="_self" data-reactid="105">Context</a></li><li class="menu-item menu-item-level-3" data-reactid="106"><a href="/en-us/docs/user/demos/attachment.html" target="_self" data-reactid="107">Attachment</a></li><li class="menu-item menu-item-level-3" data-reactid="108"><a href="/en-us/docs/user/demos/async-call.html" target="_self" data-reactid="109">Asynchronous call</a></li><li class="menu-item menu-item-level-3" data-reactid="110"><a href="/en-us/docs/user/demos/local-call.html" target="_self" data-reactid="111">Local call</a></li><li class="menu-item menu-item-level-3" data-reactid="112"><a href="/en-us/docs/user/demos/callback-parameter.html" target="_self" data-reactid="113">Callback parameter</a></li><li class="menu-item menu-item-level-3" data-reactid="114"><a href="/en-us/docs/user/demos/events-notify.html" target="_self" data-reactid="115">Events notify</a></li><li class="menu-item menu-item-level-3" data-reactid="116"><a href="/en-us/docs/user/demos/local-stub.html" target="_self" data-reactid="117">Local stub</a></li><li class="menu-item menu-item-level-3" data-reactid="118"><a href="/en-us/docs/user/demos/local-mock.html" target="_self" data-reactid="119">Local mock</a></li><li class="menu-item menu-item-level-3" data-reactid="120"><a href="/en-us/docs/user/demos/delay-publish.html" target="_self" data-reactid="121">Delay publish</a></li><li class="menu-item menu-item-level-3" data-reactid="122"><a href="/en-us/docs/user/demos/concurrency-control.html" target="_self" data-reactid="123">Concurrency control</a></li><li class="menu-item menu-item-level-3" data-reactid="124"><a href="/en-us/docs/user/demos/config-connections.html" target="_self" data-reactid="125">Connections limitation</a></li><li class="menu-item menu-item-level-3" data-reactid="126"><a href="/en-us/docs/user/demos/lazy-connect.html" target="_self" data-reactid="127">Lazy connect</a></li><li class="menu-item menu-item-level-3" data-reactid="128"><a href="/en-us/docs/user/demos/stickiness.html" target="_self" data-reactid="129">Stickness connections</a></li><li class="menu-item menu-item-level-3" data-reactid="130"><a href="/en-us/docs/user/demos/token-authorization.html" target="_self" data-reactid="131">Token authorization</a></li><li class="menu-item menu-item-level-3" data-reactid="132"><a href="/en-us/docs/user/demos/routing-rule.html" target="_self" data-reactid="133">Routing rule</a></li><li class="menu-item menu-item-level-3" data-reactid="134"><a href="/en-us/docs/user/demos/config-rule.html" target="_self" data-reactid="135">Configuration rule</a></li><li class="menu-item menu-item-level-3" data-reactid="136"><a href="/en-us/docs/user/demos/service-downgrade.html" target="_self" data-reactid="137">Service downgrade</a></li><li class="menu-item menu-item-level-3" data-reactid="138"><a href="/en-us/docs/user/demos/graceful-shutdown.html" target="_self" data-reactid="139">Graceful shutdown</a></li><li class="menu-item menu-item-level-3" data-reactid="140"><a href="/en-us/docs/user/demos/hostname-binding.html" target="_self" data-reactid="141">Hostname binding</a></li><li class="menu-item menu-item-level-3" data-reactid="142"><a href="/en-us/docs/user/demos/logger-strategy.html" target="_self" data-reactid="143">Logger strategy</a></li><li class="menu-item menu-item-level-3" data-reactid="144"><a href="/en-us/docs/user/demos/accesslog.html" target="_self" data-reactid="145">Accesslog</a></li><li class="menu-item menu-item-level-3" data-reactid="146"><a href="/en-us/docs/user/demos/service-container.html" target="_self" data-reactid="147">Service container</a></li><li class="menu-item menu-item-level-3" data-reactid="148"><a href="/en-us/docs/user/demos/reference-config-cache.html" target="_self" data-reactid="149">Reference config cache</a></li><li class="menu-item menu-item-level-3" data-reactid="150"><a href="/en-us/docs/user/demos/distributed-transaction.html" target="_self" data-reactid="151">Distributed transaction</a></li><li class="menu-item menu-item-level-3" data-reactid="152"><a href="/en-us/docs/user/demos/dump.html" target="_self" data-reactid="153">Automatic thread dump</a></li><li class="menu-item menu-item-level-3" data-reactid="154"><a href="/en-us/docs/user/demos/netty4.html" target="_self" data-reactid="155">Netty4</a></li></ul></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="156"><a href="/en-us/docs/user/references/api.html" target="_self" data-reactid="157">API configuration reference</a></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="158"><span data-reactid="159"><!-- react-text: 160 -->Schema configuration reference<!-- /react-text --><img style="transform:rotate(-90deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="161"/></span><ul data-reactid="162"><li class="menu-item menu-item-level-3" data-reactid="163"><a href="/en-us/docs/user/references/xml/introduction.html" target="_self" data-reactid="164">Introduction</a></li><li class="menu-item menu-item-level-3" data-reactid="165"><a href="/en-us/docs/user/references/xml/dubbo-service.html" target="_self" data-reactid="166">dubbo:service</a></li><li class="menu-item menu-item-level-3" data-reactid="167"><a href="/en-us/docs/user/references/xml/dubbo-reference.html" target="_self" data-reactid="168">dubbo:reference</a></li><li class="menu-item menu-item-level-3" data-reactid="169"><a href="/en-us/docs/user/references/xml/dubbo-protocol.html" target="_self" data-reactid="170">dubbo:protocol</a></li><li class="menu-item menu-item-level-3" data-reactid="171"><a href="/en-us/docs/user/references/xml/dubbo-registry.html" target="_self" data-reactid="172">dubbo:registry</a></li><li class="menu-item menu-item-level-3" data-reactid="173"><a href="/en-us/docs/user/references/xml/dubbo-monitor.html" target="_self" data-reactid="174">dubbo:monitor</a></li><li class="menu-item menu-item-level-3" data-reactid="175"><a href="/en-us/docs/user/references/xml/dubbo-application.html" target="_self" data-reactid="176">dubbo:application</a></li><li class="menu-item menu-item-level-3" data-reactid="177"><a href="/en-us/docs/user/references/xml/dubbo-module.html" target="_self" data-reactid="178">dubbo:module</a></li><li class="menu-item menu-item-level-3" data-reactid="179"><a href="/en-us/docs/user/references/xml/dubbo-provider.html" target="_self" data-reactid="180">dubbo:provider</a></li><li class="menu-item menu-item-level-3" data-reactid="181"><a href="/en-us/docs/user/references/xml/dubbo-consumer.html" target="_self" data-reactid="182">dubbo:consumer</a></li><li class="menu-item menu-item-level-3" data-reactid="183"><a href="/en-us/docs/user/references/xml/dubbo-method.html" target="_self" data-reactid="184">dubbo:method</a></li><li class="menu-item menu-item-level-3" data-reactid="185"><a href="/en-us/docs/user/references/xml/dubbo-argument.html" target="_self" data-reactid="186">dubbo:argument</a></li><li class="menu-item menu-item-level-3" data-reactid="187"><a href="/en-us/docs/user/references/xml/dubbo-parameter.html" target="_self" data-reactid="188">dubbo:parameter</a></li></ul></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="189"><span data-reactid="190"><!-- react-text: 191 -->Protocol configuration reference<!-- /react-text --><img style="transform:rotate(-90deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="192"/></span><ul data-reactid="193"><li class="menu-item menu-item-level-3" data-reactid="194"><a href="/en-us/docs/user/references/protocol/introduction.html" target="_self" data-reactid="195">Introduction</a></li><li class="menu-item menu-item-level-3" data-reactid="196"><a href="/en-us/docs/user/references/protocol/dubbo.html" target="_self" data-reactid="197">dubbo://</a></li><li class="menu-item menu-item-level-3" data-reactid="198"><a href="/en-us/docs/user/references/protocol/rmi.html" target="_self" data-reactid="199">rmi://</a></li><li class="menu-item menu-item-level-3" data-reactid="200"><a href="/en-us/docs/user/references/protocol/hessian.html" target="_self" data-reactid="201">hessian://</a></li><li class="menu-item menu-item-level-3" data-reactid="202"><a href="/en-us/docs/user/references/protocol/http.html" target="_self" data-reactid="203">http://</a></li><li class="menu-item menu-item-level-3" data-reactid="204"><a href="/en-us/docs/user/references/protocol/webservice.html" target="_self" data-reactid="205">webservice://</a></li><li class="menu-item menu-item-level-3" data-reactid="206"><a href="/en-us/docs/user/references/protocol/thrift.html" target="_self" data-reactid="207">thrift://</a></li><li class="menu-item menu-item-level-3" data-reactid="208"><a href="/en-us/docs/user/references/protocol/memcached.html" target="_self" data-reactid="209">memcached://</a></li><li class="menu-item menu-item-level-3" data-reactid="210"><a href="/en-us/docs/user/references/protocol/redis.html" target="_self" data-reactid="211">redis://</a></li><li class="menu-item menu-item-level-3" data-reactid="212"><a href="/en-us/docs/user/references/protocol/rest.html" target="_self" data-reactid="213">rest://</a></li></ul></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="214"><span data-reactid="215"><!-- react-text: 216 -->Registry configuration reference<!-- /react-text --><img style="transform:rotate(-90deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="217"/></span><ul data-reactid="218"><li class="menu-item menu-item-level-3" data-reactid="219"><a href="/en-us/docs/user/references/registry/introduction.html" target="_self" data-reactid="220">Introduction</a></li><li class="menu-item menu-item-level-3" data-reactid="221"><a href="/en-us/docs/user/references/registry/multicast.html" target="_self" data-reactid="222">Multicast registry</a></li><li class="menu-item menu-item-level-3" data-reactid="223"><a href="/en-us/docs/user/references/registry/zookeeper.html" target="_self" data-reactid="224">Zookeeper registry</a></li><li class="menu-item menu-item-level-3" data-reactid="225"><a href="/en-us/docs/user/references/registry/redis.html" target="_self" data-reactid="226">Redis registry</a></li><li class="menu-item menu-item-level-3" data-reactid="227"><a href="/en-us/docs/user/references/registry/simple.html" target="_self" data-reactid="228">Simple registry</a></li></ul></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="229"><a href="/en-us/docs/user/references/telnet.html" target="_self" data-reactid="230">Telnet command</a></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="231"><a href="/en-us/docs/user/references/maven.html" target="_self" data-reactid="232">Maven plugin</a></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="233"><a href="/en-us/docs/user/best-practice.html" target="_self" data-reactid="234">Best practice</a></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="235"><a href="/en-us/docs/user/recommend.html" target="_self" data-reactid="236">Recommended usage</a></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="237"><a href="/en-us/docs/user/capacity-plan.html" target="_self" data-reactid="238">Capacity plan</a></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="239"><a href="/en-us/docs/user/perf-test.html" target="_self" data-reactid="240">Performance testing reports</a></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="241"><a href="/en-us/docs/user/coveragence.html" target="_self" data-reactid="242">Test coverage report</a></li></ul></li><li class="menu-item menu-item-level-1" data-reactid="243"><span data-reactid="244">Developer guide</span><ul data-reactid="245"><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="246"><a href="/en-us/docs/dev/build.html" target="_self" data-reactid="247">How To Build</a></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="248"><a href="/en-us/docs/dev/design.html" target="_self" data-reactid="249">Architecture</a></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="250"><a href="/en-us/docs/dev/SPI.html" target="_self" data-reactid="251">How SPI Works</a></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="252"><a href="/en-us/docs/dev/implementation.html" target="_self" data-reactid="253">Init, Process, Protocols</a></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="254"><span data-reactid="255"><!-- react-text: 256 -->SPI Extensions<!-- /react-text --><img style="transform:rotate(-90deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="257"/></span><ul data-reactid="258"><li class="menu-item menu-item-level-3" data-reactid="259"><a href="/en-us/docs/dev/impls/protocol.html" target="_self" data-reactid="260">Protocol</a></li><li class="menu-item menu-item-level-3" data-reactid="261"><a href="/en-us/docs/dev/impls/filter.html" target="_self" data-reactid="262">Filter</a></li><li class="menu-item menu-item-level-3" data-reactid="263"><a href="/en-us/docs/dev/impls/invoker-listener.html" target="_self" data-reactid="264">InvokerListener</a></li><li class="menu-item menu-item-level-3" data-reactid="265"><a href="/en-us/docs/dev/impls/exporter-listener.html" target="_self" data-reactid="266">ExporterListener</a></li><li class="menu-item menu-item-level-3" data-reactid="267"><a href="/en-us/docs/dev/impls/cluster.html" target="_self" data-reactid="268">Cluster</a></li><li class="menu-item menu-item-level-3" data-reactid="269"><a href="/en-us/docs/dev/impls/router.html" target="_self" data-reactid="270">Router</a></li><li class="menu-item menu-item-level-3" data-reactid="271"><a href="/en-us/docs/dev/impls/load-balance.html" target="_self" data-reactid="272">LoadBalance</a></li><li class="menu-item menu-item-level-3" data-reactid="273"><a href="/en-us/docs/dev/impls/merger.html" target="_self" data-reactid="274">Merger</a></li><li class="menu-item menu-item-level-3" data-reactid="275"><a href="/en-us/docs/dev/impls/registry.html" target="_self" data-reactid="276">Registry</a></li><li class="menu-item menu-item-level-3" data-reactid="277"><a href="/en-us/docs/dev/impls/monitor.html" target="_self" data-reactid="278">Monitor</a></li><li class="menu-item menu-item-level-3" data-reactid="279"><a href="/en-us/docs/dev/impls/extension-factory.html" target="_self" data-reactid="280">ExtensionFactory</a></li><li class="menu-item menu-item-level-3" data-reactid="281"><a href="/en-us/docs/dev/impls/proxy-factory.html" target="_self" data-reactid="282">ProxyFactory</a></li><li class="menu-item menu-item-level-3" data-reactid="283"><a href="/en-us/docs/dev/impls/compiler.html" target="_self" data-reactid="284">Compiler</a></li><li class="menu-item menu-item-level-3" data-reactid="285"><a href="/en-us/docs/dev/impls/dispatcher.html" target="_self" data-reactid="286">Dispatcher</a></li><li class="menu-item menu-item-level-3" data-reactid="287"><a href="/en-us/docs/dev/impls/threadpool.html" target="_self" data-reactid="288">Threadpool</a></li><li class="menu-item menu-item-level-3" data-reactid="289"><a href="/en-us/docs/dev/impls/serialize.html" target="_self" data-reactid="290">Serialization</a></li><li class="menu-item menu-item-level-3" data-reactid="291"><a href="/en-us/docs/dev/impls/remoting.html" target="_self" data-reactid="292">Remoting</a></li><li class="menu-item menu-item-level-3" data-reactid="293"><a href="/en-us/docs/dev/impls/exchanger.html" target="_self" data-reactid="294">Exchanger</a></li><li class="menu-item menu-item-level-3" data-reactid="295"><a href="/en-us/docs/dev/impls/networker.html" target="_self" data-reactid="296">Networker</a></li><li class="menu-item menu-item-level-3" data-reactid="297"><a href="/en-us/docs/dev/impls/telnet-handler.html" target="_self" data-reactid="298">TelnetHandler</a></li><li class="menu-item menu-item-level-3" data-reactid="299"><a href="/en-us/docs/dev/impls/status-checker.html" target="_self" data-reactid="300">StatusChecker</a></li><li class="menu-item menu-item-level-3" data-reactid="301"><a href="/en-us/docs/dev/impls/container.html" target="_self" data-reactid="302">Container</a></li><li class="menu-item menu-item-level-3" data-reactid="303"><a href="/en-us/docs/dev/impls/page.html" target="_self" data-reactid="304">PageHandler</a></li><li class="menu-item menu-item-level-3" data-reactid="305"><a href="/en-us/docs/dev/impls/cache.html" target="_self" data-reactid="306">Cache</a></li><li class="menu-item menu-item-level-3" data-reactid="307"><a href="/en-us/docs/dev/impls/validation.html" target="_self" data-reactid="308">Validation</a></li><li class="menu-item menu-item-level-3" data-reactid="309"><a href="/en-us/docs/dev/impls/logger-adapter.html" target="_self" data-reactid="310">LoggerAdapter</a></li></ul></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="311"><a href="/en-us/docs/dev/contract.html" target="_self" data-reactid="312">Contract</a></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="313"><a href="/en-us/docs/dev/coding.html" target="_self" data-reactid="314">Code Style</a></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="315"><a href="/en-us/docs/dev/release.html" target="_self" data-reactid="316">Versions</a></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="317"><a href="/en-us/docs/dev/contribution.html" target="_self" data-reactid="318">Contribution</a></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="319"><a href="/en-us/docs/dev/checklist.html" target="_self" data-reactid="320">Checklist</a></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="321"><a href="/en-us/docs/dev/code-smell.html" target="_self" data-reactid="322">Code Smell</a></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="323"><a href="/en-us/docs/dev/TCK.html" target="_self" data-reactid="324">TCK</a></li></ul></li><li class="menu-item menu-item-level-1" data-reactid="325"><span data-reactid="326">Admin guide</span><ul data-reactid="327"><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="328"><span data-reactid="329"><!-- react-text: 330 -->Installation<!-- /react-text --><img style="transform:rotate(-90deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="331"/></span><ul data-reactid="332"><li class="menu-item menu-item-level-3" data-reactid="333"><a href="/en-us/docs/admin/install/provider-demo.html" target="_self" data-reactid="334">Install provider demo</a></li><li class="menu-item menu-item-level-3" data-reactid="335"><a href="/en-us/docs/admin/install/consumer-demo.html" target="_self" data-reactid="336">Install consumer demo</a></li><li class="menu-item menu-item-level-3" data-reactid="337"><a href="/en-us/docs/admin/install/zookeeper.html" target="_self" data-reactid="338">Install Zookeeper configuration center</a></li><li class="menu-item menu-item-level-3" data-reactid="339"><a href="/en-us/docs/admin/install/redis.html" target="_self" data-reactid="340">Install Redis configuration center</a></li><li class="menu-item menu-item-level-3" data-reactid="341"><a href="/en-us/docs/admin/install/simple-registry-center.html" target="_self" data-reactid="342">Install Simple configuration center</a></li><li class="menu-item menu-item-level-3" data-reactid="343"><a href="/en-us/docs/admin/install/simple-monitor-center.html" target="_self" data-reactid="344">Install Simple monitor center</a></li><li class="menu-item menu-item-level-3" data-reactid="345"><a href="/en-us/docs/admin/install/admin-console.html" target="_self" data-reactid="346">Install admin console</a></li></ul></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="347"><span data-reactid="348"><!-- react-text: 349 -->Operation manual<!-- /react-text --><img style="transform:rotate(-90deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="350"/></span><ul data-reactid="351"><li class="menu-item menu-item-level-3" data-reactid="352"><a href="/en-us/docs/admin/ops/dubbo-ops.html" target="_self" data-reactid="353">Admin console operation guide</a></li><li class="menu-item menu-item-level-3" data-reactid="354"><a href="/en-us/docs/admin/ops/pinpoint.html" target="_self" data-reactid="355">Tracking with Pinpoint</a></li></ul></li></ul></li></ul></div><div class="doc-content markdown-body" data-reactid="356"><h1>Bad Smell</h1>
<p>Ugly Dubbo design or implementation will be record here.</p>
<h2>URL Convertion</h2>
<h3>1. Point to Point Service export and refer</h3>
<p>service directly export：</p>
<pre><code>EXPORT(dubbo://provider-address/com.xxx.XxxService?version=1.0.0&quot;)
</code></pre>
<p>service directly refer：</p>
<pre><code>REFER(dubbo://provider-address/com.xxx.XxxService?version=1.0.0)
</code></pre>
<h3>2. Export servie by registry</h3>
<p>export service to registry：</p>
<pre><code>EXPORT(registry://registry-address/com.alibaba.dubbo.registry.RegistrySerevice?registry=dubbo&amp;export=ENCODE(dubbo://provider-address/com.xxx.XxxService?version=1.0.0))
</code></pre>
<p>accquire registry：</p>
<pre><code>url.setProtocol(url.getParameter(&quot;registry&quot;, &quot;dubbo&quot;))
GETREGISTRY(dubbo://registry-address/com.alibaba.dubbo.registry.RegistrySerevice)
</code></pre>
<p>registry service address：</p>
<pre><code>url.getParameterAndDecoded(&quot;export&quot;))
REGISTER(dubbo://provider-address/com.xxx.XxxService?version=1.0.0)
</code></pre>
<h3>3. Refer service from registry</h3>
<p>refer service from registry：</p>
<pre><code>REFER(registry://registry-address/com.alibaba.dubbo.registry.RegistrySerevice?registry=dubbo&amp;refer=ENCODE(version=1.0.0))
</code></pre>
<p>accquire registry：</p>
<pre><code>url.setProtocol(url.getParameter(&quot;registry&quot;, &quot;dubbo&quot;))
GETREGISTRY(dubbo://registry-address/com.alibaba.dubbo.registry.RegistrySerevice)
</code></pre>
<p>subscribe service address：</p>
<pre><code>url.addParameters(url.getParameterAndDecoded(&quot;refer&quot;))
SUBSCRIBE(dubbo://registry-address/com.xxx.XxxService?version=1.0.0)
</code></pre>
<p>notify service address：</p>
<pre><code>url.addParameters(url.getParameterAndDecoded(&quot;refer&quot;))
NOTIFY(dubbo://provider-address/com.xxx.XxxService?version=1.0.0)
</code></pre>
<h3>4. Registry push route rule</h3>
<p>registry push route rule：</p>
<pre><code>NOTIFY(route://registry-address/com.xxx.XxxService?router=script&amp;type=js&amp;rule=ENCODE(function{...}))
</code></pre>
<p>accquire routers：</p>
<pre><code>url.setProtocol(url.getParameter(&quot;router&quot;, &quot;script&quot;))
GETROUTE(script://registry-address/com.xxx.XxxService?type=js&amp;rule=ENCODE(function{...}))
</code></pre>
<h3>5. Load route rule from file</h3>
<p>load route rule from file：</p>
<pre><code>GETROUTE(file://path/file.js?router=script)
</code></pre>
<p>accquire routers：</p>
<pre><code>url.setProtocol(url.getParameter(&quot;router&quot;, &quot;script&quot;)).addParameter(&quot;type&quot;, SUFFIX(file)).addParameter(&quot;rule&quot;, READ(file))
GETROUTE(script://path/file.js?type=js&amp;rule=ENCODE(function{...}))
</code></pre>
<h2>Invoke parameters</h2>
<ul>
<li>path      service path</li>
<li>group    service group</li>
<li>version  service version</li>
<li>dubbo   current dubbo release version</li>
<li>token    verify token</li>
<li>timeout   invocation timeout</li>
</ul>
<h2>SPI Loading</h2>
<h3>1. SPI Auto Adaptive</h3>
<p>When ExtensionLoader loads SPI, It will check spi attributes(using set method) . If one attribute is SPI, ExtensionLoader  will load the SPI implementation. Auto injected object is an adaptive instance（proxy） ,because the real implementation is confirmed only in execution stage.。when adaptive spi is invoked, Dubbo will choose the real implementation and executes it. Dubbo choose the right implementation according to the parameters that the mehod defines.</p>
<p>All the inner SPIs that  Dubbo defines have the URL  parameter defined for the method invocation. Adaptive SPI uses URL to determine which implementation is needed. One specific Key and Value in the URL confirms the usage of the specific implementation, All these is done by adding <code>@Adaptive</code>  annotation.</p>
<pre><code class="language-java"><span class="hljs-meta">@Extension</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Car</span> </span>{
    <span class="hljs-meta">@Adaptive</span>({<span class="hljs-string">"http://10.20.160.198/wiki/display/dubbo/car.type"</span>, <span class="hljs-string">"http://10.20.160.198/wiki/display/dubbo/transport.type"</span>})
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">run</span><span class="hljs-params">(URL url, Type1 arg1, Type2 arg2)</span></span>;
}
</code></pre>
<p>For the rules above，ExtensionLoader  will create a adaptive instance for each SPI injected.</p>
<p>ExtensionLoader generated adaptive classes  look like ：</p>
<pre><code class="language-java"><span class="hljs-keyword">package</span> &lt;<span class="hljs-keyword">package</span> name <span class="hljs-keyword">for</span> SPI <span class="hljs-class"><span class="hljs-keyword">interface</span>&gt;</span>;
 
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> &lt;<span class="hljs-title">SPI</span> <span class="hljs-title">interface</span> <span class="hljs-title">name</span>&gt;$<span class="hljs-title">Adpative</span> <span class="hljs-keyword">implements</span> &lt;<span class="hljs-title">SPI</span> <span class="hljs-title">interface</span>&gt; </span>{
    <span class="hljs-keyword">public</span> &lt;contains <span class="hljs-meta">@Adaptive</span> annotation method&gt;(&lt;parameters&gt;) {
        <span class="hljs-keyword">if</span>(parameters containing URL Type?) <span class="hljs-function">using URL parameter
        <span class="hljs-keyword">else</span> <span class="hljs-title">if</span><span class="hljs-params">(method returns URL)</span> using the return URL
        # &lt;<span class="hljs-keyword">else</span> throw exception,inject SPI fail！&gt;
         
        <span class="hljs-title">if</span><span class="hljs-params">(URL accquired == <span class="hljs-keyword">null</span>)</span> </span>{
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">"url == null"</span>);
        }
 
        According to the Key order from <span class="hljs-meta">@Adaptive</span> annotation，get the Value from the URL as the real SPI name
        <span class="hljs-keyword">if</span> no value is found then use the <span class="hljs-keyword">default</span> SPI implementation。If no SPI point， <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalStateException(<span class="hljs-string">"Fail to get extension"</span>);
 
        Invoke the method using the spi and <span class="hljs-keyword">return</span> the result.
    }
 
    <span class="hljs-keyword">public</span> &lt;method having annotation <span class="hljs-meta">@Adaptive</span>&gt;(&lt;parameters&gt;) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> UnsupportedOperationException(<span class="hljs-string">"is not adaptive method!"</span>);
    }
}
</code></pre>
<p><code>@Adaptive</code>  annotation usage：</p>
<p>If no value is configed for those Keys in URL，default SPI implementation is used。For example ，String[] {&quot;key1&quot;, &quot;key2&quot;}，firstly Dubbo will look up value for key1 and use it as SPI name;if key1 value is not founded then look up for key2，if value of key2 is also not found ,then use default spi implementation. If no default implementation is configed, then the method will throw IllegalStateException。if not configed , then default implement is lower case of the interface class full package name. For Extension interface <code>com.alibaba.dubbo.xxx.YyyInvokerWrapper</code> , default value is <code>new String[] {&quot;yyy.invoker.wrapper&quot;}</code></p>
<h2>Callback Function</h2>
<h3>1. Parameter Callback</h3>
<p>main theory ： in the persistent connection for one consumer-&gt;provider，export a service in  Consumer side，provider  side can reversely call the instance in consumer side.</p>
<p>Implement details：</p>
<ul>
<li>For exchanging interface instance in transmition, auto export and auto refer is implemented in DubboCodec . Need to seperate business logic and codec logic.</li>
<li>you will need to judge whether needing callback when getting exporter from invocation，if needed, get the callback instance id from the attachments. By using this method, consumer side can implement the callback interface with different implementations.</li>
</ul>
<h3>2. Event Notification</h3>
<p>main theory ： when Consumer  executing invoke method，judging if any configuration for  onreturn/onerror... put  the method for onreturn to the callback list of the async invocatioin.</p>
<p>Implement details：parameters is passed using URL，but string-object is not supported for URL, so the method is stored in  staticMap，it needs to be optimized.</p>
<h2>Lazy Connection</h2>
<p>DubboProtocol  specific features, default disabled</p>
<p>When client creating proxy for server, do not establish TCP persistent connection at first, only init the connecton when data is needing transmision.</p>
<p>This feather will disable the connection retry policy , resend the data again(if connection is lost when sending data ,try to establish a new connection to send data)</p>
<h2>Share Connection</h2>
<p>DubboProtocol specific features, default enabled。</p>
<p>JVM A export many services，JVM B  refer more than one services of A，Share Connection means those different services invocations between A and B uses the same TCP connection  to transmit data, reducing server connections.</p>
<p>Implement details：when using share connection for the same address，you need pay more attention to the invoker's destroy action.on one hand, you should close the connection when all the invokers refering the same address is destroyed, on another hand ,you should not close the connection when not all of the invokers are destroyed. In design implementation, we uses a strategy called reference count , we create a connection called Lazy connection for exceptions not affacting business when closing the connection just in case.</p>
<h2>sticky policy</h2>
<p>when existing many providers and configing the sticky policy，invocation will be sent to the same provider as last invocation. Sticky Policy opens the lazy attribute of connection, for avoiding open useless connectons.</p>
<h2>provider selecting logic</h2>
<ol start="0">
<li>existing multi providers，firstly select by Loadbalance 。If the selected  provider is available ,then just doing the invocation</li>
<li>If the selected provider is not available in stage 1, then choose from the remaining ,if available then doing the inovation</li>
<li>If all providers are not available , rescan the list(not choosen invoker first),juding if any provider is available, if existing,doing the invocatiion.</li>
<li>If no available provider in stage 3, then the next invoker of the invoker of stage 1 will be choosen(if not the last one),avoiding collision.</li>
</ol>
</div></section><footer class="footer-container" data-reactid="357"><div class="footer-body" data-reactid="358"><img src="/img/dubbo_gray.png" data-reactid="359"/><img class="apache" src="/img/apache_logo.png" data-reactid="360"/><div class="cols-container" data-reactid="361"><div class="col col-12" data-reactid="362"><h3 data-reactid="363">Disclaimer</h3><p data-reactid="364">Apache Dubbo is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.</p></div><div class="col col-6" data-reactid="365"><dl data-reactid="366"><dt data-reactid="367">Documentation</dt><dd data-reactid="368"><a href="/en-us/docs/user/quick-start.html" target="_self" data-reactid="369">Quick start</a></dd><dd data-reactid="370"><a href="/en-us/docs/dev/build.html" target="_self" data-reactid="371">Developer guide</a></dd><dd data-reactid="372"><a href="/en-us/docs/admin/ops/dubbo-ops.html" target="_self" data-reactid="373">Admin manual</a></dd></dl></div><div class="col col-6" data-reactid="374"><dl data-reactid="375"><dt data-reactid="376">Resources</dt><dd data-reactid="377"><a href="/en-us/blog/index.html" target="_self" data-reactid="378">Blog</a></dd><dd data-reactid="379"><a href="/en-us/community/index.html" target="_self" data-reactid="380">Community</a></dd></dl></div></div><div class="copyright" data-reactid="381"><span data-reactid="382">Copyright © 2018 The Apache Software Foundation. Apache and the Apache feather logo are trademarks of The Apache Software Foundation.</span></div></div></footer></div></div>
	<script src="https://f.alicdn.com/react/15.4.1/react-with-addons.min.js"></script>
	<script src="https://f.alicdn.com/react/15.4.1/react-dom.min.js"></script>
	<script>
		window.rootPath = '';
  </script>
  <script src="/build/documentation.js"></script>
</body>
</html>
