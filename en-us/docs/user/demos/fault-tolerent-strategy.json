{
  "filename": "fault-tolerent-strategy.md",
  "__html": "<h1>Fault Tolerance Strategy</h1>\n<p>Dubbo offers a variety of fault-tolerant scenarios when a cluster call fails, with a default failover retry.</p>\n<p><img src=\"../sources/images/cluster.jpg\" alt=\"cluster\"></p>\n<p>The relationship between nodes:</p>\n<ul>\n<li>This <code>Invoker</code> is the callable Service's abstract of the<code>Provider</code>, and the <code>Invoker</code> packaging the<code>Provider</code>'s address and <code>Service</code>'s interface.</li>\n<li>The <code>Directory</code> represent multiple <code>Invoker</code>,You can think of it as <code>List&lt;Invoker&gt;</code>,But unlike <code>List</code>,its value  can be dynamically changing.such as registry push changes</li>\n<li>The <code>Cluster</code> disguises multiple<code>Invoker</code> in <code>Directory</code> as a<code>Invoker</code>,The upper transparent, masquerade process contains fault-tolerant logic, call failed, try another</li>\n<li>The <code>Router</code> is responsible for selecting subsets according to routing rules from multiple <code>Invoker</code>s, such as read-write separation, application isolation, etc.</li>\n<li><code>LoadBalance</code> is responsible for selecting a specific one from multiple<code>Invoker</code> for this call. The selection process includes the load balancing algorithm. If the call fails, it needs to be re-selected</li>\n</ul>\n<h2>Cluster fault-tolerant mode</h2>\n<p>You can expand the cluster fault tolerance strategy, see:<a href=\"http://dubbo.apache.org/books/dubbo-dev-book-en/impls/cluster.html\">Cluster expansion</a></p>\n<h2>Failover Cluster</h2>\n<p>Failure automatically switch, when there is failure, retry the other server (default). Usually used for read operations, but retries can result in longer delays. The times of retries can be set via <code>retries =2</code> (excluding the first time).</p>\n<p>The times of retries is configured as follows:</p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:service</span> <span class=\"hljs-attr\">retries</span>=<span class=\"hljs-string\">\"2\"</span> /&gt;</span>\n</code></pre>\n<p>OR</p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:reference</span> <span class=\"hljs-attr\">retries</span>=<span class=\"hljs-string\">\"2\"</span> /&gt;</span>\n</code></pre>\n<p>OR</p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:reference</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:method</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"findFoo\"</span> <span class=\"hljs-attr\">retries</span>=<span class=\"hljs-string\">\"2\"</span> /&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dubbo:reference</span>&gt;</span>\n</code></pre>\n<h3>Failfast Cluster</h3>\n<p>Fast failure, only made a call, failure immediately error. Usually used for non-idempotent write operations, such as adding records</p>\n<h3>Failsafe Cluster</h3>\n<p>Failure of security, anomalies, directly ignored. Usually used to write audit logs and other operations.</p>\n<h3>Failback Cluster</h3>\n<p>Failure automatically restored, failed to record the background request, regular retransmission. Usually used for message notification operations.</p>\n<h3>Forking Cluster</h3>\n<p>Multiple servers are invoked in parallel, returning as soon as one succeeds. Usually used for real-time demanding read operations, but need to waste more service resources. The maximum number of parallelism can be set with <code>forks=2</code>.</p>\n<h3>Broadcast Cluster</h3>\n<p>Calling all providers broadcast, one by one call, any error is reported (<code>2.1.0+</code>). It is usually used to notify all providers to update local resource information such as caches or logs.</p>\n<h2>Cluster mode configuration</h2>\n<p>Follow the example below to configure cluster mode on service providers and consumers</p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:service</span> <span class=\"hljs-attr\">cluster</span>=<span class=\"hljs-string\">\"failsafe\"</span> /&gt;</span>\n</code></pre>\n<p>OR</p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:reference</span> <span class=\"hljs-attr\">cluster</span>=<span class=\"hljs-string\">\"failsafe\"</span> /&gt;</span>\n</code></pre>\n"
}