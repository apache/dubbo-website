{
  "filename": "loadbalance.md",
  "__html": "<h1>LoadBalance</h1>\n<p>Dubbo offers a number of balancing strategies for cluster load balancing, which defaults to <code>random</code>.</p>\n<p>You can extend the load balancing strategy by yourself, see:<a href=\"http://dubbo.apache.org/books/dubbo-dev-book-en/impls/load-balance.html\">LoadBalance extension</a></p>\n<h2>LoadBalance strategy</h2>\n<h3>Random LoadBalance</h3>\n<ul>\n<li><strong>Ramdom</strong>, set random probabilities by weight.</li>\n<li>The probability of collisions on one section is high, but the larger the amount of calls, the more uniform the distribution. And when use weight based on probability the distribution turns out to be uniform, which also helps to dynamically adjust the provider weights.</li>\n</ul>\n<h3>RoundRobin LoadBalance</h3>\n<ul>\n<li><strong>RoundRobin</strong>, use the weight's common advisor to determine round robin ratio.</li>\n<li>Traffic flow to slower providers may cause requests piled up, e.g., if there's a provider processing requests in a very slow speed, but it's still alive, which means it can receive request as normal. According to RoundRobin policy, consumers will continuously send requests to this provider on predetermined pace, have no aware of the provider's bad status. Finally, we will get many requests stuck on this unhealthy provider.</li>\n</ul>\n<h3>LeastActive LoadBalance</h3>\n<ul>\n<li><strong>LeastActive</strong>, a random mechanism based on actives, <code>actives</code> means the num of requests a consumer have sent but not return yet。</li>\n<li>Slower providers will receive fewer requests, cause slower provider have higher <code>actives</code>.</li>\n</ul>\n<h3>ConsistentHash LoadBalance</h3>\n<ul>\n<li><strong>ConsistentHash</strong>, the same parameters of the request is always sent to the same provider.</li>\n<li>When a provider fails, the original request to the provider, based on the virtual node algorithm, averages to other providers, does not cause drastic changes.</li>\n<li>Algorithm reference：<a href=\"http://en.wikipedia.org/wiki/Consistent_hashing\">http://en.wikipedia.org/wiki/Consistent_hashing</a></li>\n<li>By default only the first parameter Hash, if you want to modify, please configure <code>&lt;dubbo:parameter key=&quot;hash.arguments&quot; value=&quot;0,1&quot; /&gt;</code></li>\n<li>By default 160 virtual nodes, if you want to modify, please configure <code>&lt;dubbo:parameter key=&quot;hash.nodes&quot; value=&quot;320&quot; /&gt;</code></li>\n</ul>\n<p>See the algorithm at <a href=\"http://en.wikipedia.org/wiki/Consistent_hashing\">http://en.wikipedia.org/wiki/Consistent_hashing</a></p>\n<h2>Configuration</h2>\n<h3>Server service level</h3>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:service</span> <span class=\"hljs-attr\">interface</span>=<span class=\"hljs-string\">\"...\"</span> <span class=\"hljs-attr\">loadbalance</span>=<span class=\"hljs-string\">\"roundrobin\"</span> /&gt;</span>\n</code></pre>\n<h3>Client service level</h3>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:reference</span> <span class=\"hljs-attr\">interface</span>=<span class=\"hljs-string\">\"...\"</span> <span class=\"hljs-attr\">loadbalance</span>=<span class=\"hljs-string\">\"roundrobin\"</span> /&gt;</span>\n</code></pre>\n<h3>Server method level</h3>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:service</span> <span class=\"hljs-attr\">interface</span>=<span class=\"hljs-string\">\"...\"</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:method</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"...\"</span> <span class=\"hljs-attr\">loadbalance</span>=<span class=\"hljs-string\">\"roundrobin\"</span>/&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dubbo:service</span>&gt;</span>\n</code></pre>\n<h3>Client method level</h3>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:reference</span> <span class=\"hljs-attr\">interface</span>=<span class=\"hljs-string\">\"...\"</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:method</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"...\"</span> <span class=\"hljs-attr\">loadbalance</span>=<span class=\"hljs-string\">\"roundrobin\"</span>/&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dubbo:reference</span>&gt;</span>\n</code></pre>\n"
}