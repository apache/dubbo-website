{
  "filename": "recommend.md",
  "__html": "<h1>Recommended usage</h1>\n<h2>Configuring the attributes of the consumer side as much as possible on the provider side</h2>\n<p>the reason is：</p>\n<ul>\n<li>Service providers are more aware of service performance parameters than service users，Such as the timeout time of the call, the reasonable retry times, and so on.</li>\n<li>If  a attribute is configurated in provider side,  not configurated in consumer side,  consumer service will use the attribute in provider side. That is to say, the provider side's attribute can be used as consumer's default value <sup class=\"footnote-ref\"><a href=\"#fn1\" id=\"fnref1\">[1]</a></sup>. Otherwise, consumer service will use consumer-side's attribute，but can't cnotrol the provider service,it's usually unreasonable.</li>\n</ul>\n<p>Configuring the attributes of the consumer side as much as possible on the provider side，Make the provider service developer think more about the characteristics and quality of the provider side service.</p>\n<p>Examples：</p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:service</span> <span class=\"hljs-attr\">interface</span>=<span class=\"hljs-string\">\"com.alibaba.hello.api.HelloService\"</span> <span class=\"hljs-attr\">version</span>=<span class=\"hljs-string\">\"1.0.0\"</span> <span class=\"hljs-attr\">ref</span>=<span class=\"hljs-string\">\"helloService\"</span>\n    <span class=\"hljs-attr\">timeout</span>=<span class=\"hljs-string\">\"300\"</span> <span class=\"hljs-attr\">retry</span>=<span class=\"hljs-string\">\"2\"</span> <span class=\"hljs-attr\">loadbalance</span>=<span class=\"hljs-string\">\"random\"</span> <span class=\"hljs-attr\">actives</span>=<span class=\"hljs-string\">\"0\"</span>\n/&gt;</span>\n \n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:service</span> <span class=\"hljs-attr\">interface</span>=<span class=\"hljs-string\">\"com.alibaba.hello.api.WorldService\"</span> <span class=\"hljs-attr\">version</span>=<span class=\"hljs-string\">\"1.0.0\"</span> <span class=\"hljs-attr\">ref</span>=<span class=\"hljs-string\">\"helloService\"</span>\n    <span class=\"hljs-attr\">timeout</span>=<span class=\"hljs-string\">\"300\"</span> <span class=\"hljs-attr\">retry</span>=<span class=\"hljs-string\">\"2\"</span> <span class=\"hljs-attr\">loadbalance</span>=<span class=\"hljs-string\">\"random\"</span> <span class=\"hljs-attr\">actives</span>=<span class=\"hljs-string\">\"0\"</span> &gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:method</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"findAllPerson\"</span> <span class=\"hljs-attr\">timeout</span>=<span class=\"hljs-string\">\"10000\"</span> <span class=\"hljs-attr\">retries</span>=<span class=\"hljs-string\">\"9\"</span> <span class=\"hljs-attr\">loadbalance</span>=<span class=\"hljs-string\">\"leastactive\"</span> <span class=\"hljs-attr\">actives</span>=<span class=\"hljs-string\">\"5\"</span> /&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:service</span>/&gt;</span>\n</code></pre>\n<p>The consumer side properties that can be configured on provider are：</p>\n<ol start=\"0\">\n<li><code>timeout</code> Method call timeout</li>\n<li><code>retries</code> The number of failed retries, default value is 1 <sup class=\"footnote-ref\"><a href=\"#fn2\" id=\"fnref2\">[2]</a></sup></li>\n<li><code>loadbalance</code> Load balance algorithm <sup class=\"footnote-ref\"><a href=\"#fn3\" id=\"fnref3\">[3]</a></sup>，default algorithm is random <code>random</code>,and polling <code>roundrobin</code>、least active <sup class=\"footnote-ref\"><a href=\"#fn4\" id=\"fnref4\">[4]</a></sup> <code>leastactive</code></li>\n<li><code>actives</code> Consumer side, maximum concurrent call limitation. That is , when the concurrent requests of consumer service reach maximum  configuration,the new call will wait until to catch a timeout error.\nConfigurated in  <code>dubbo:method</code>(method level configuration) , then the concurrent limitation point at method.Configurated in <code>dubbo:service</code>(service level configuration),then the concurrent limitation point at service.</li>\n</ol>\n<p>Detailed configuration instructions see：<a href=\"./references/xml/introduction.md\">Dubbo configuration introduction</a></p>\n<h2>Configuring reasonable provider end properties on provider</h2>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:protocol</span> <span class=\"hljs-attr\">threads</span>=<span class=\"hljs-string\">\"200\"</span> /&gt;</span> \n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:service</span> <span class=\"hljs-attr\">interface</span>=<span class=\"hljs-string\">\"com.alibaba.hello.api.HelloService\"</span> <span class=\"hljs-attr\">version</span>=<span class=\"hljs-string\">\"1.0.0\"</span> <span class=\"hljs-attr\">ref</span>=<span class=\"hljs-string\">\"helloService\"</span>\n    <span class=\"hljs-attr\">executes</span>=<span class=\"hljs-string\">\"200\"</span> &gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:method</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"findAllPerson\"</span> <span class=\"hljs-attr\">executes</span>=<span class=\"hljs-string\">\"50\"</span> /&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dubbo:service</span>&gt;</span>\n</code></pre>\n<p>The provider side properties that can be configured on provider service are：</p>\n<ol start=\"0\">\n<li><code>threads</code> service thread pool size</li>\n<li><code>executes</code> If concurrent requests number that a provider service handled reach the maximum thead pool count , the new call will wait,then the consumer call may catch a timeout error. Configurated in  <code>dubbo:method</code>(method level configuration) , then the concurrent limitation point at method.Configurated in <code>dubbo:service</code>(service level configuration),then the concurrent limitation point at service.</li>\n</ol>\n<h2>Configuration management information</h2>\n<p>Now we have the owner information and organization infomation to differentiate the sites。It's easy to contact with the service owners when there is a problem, please write at least two persons for backup. The information of owners and organizations can be seen in the registry.</p>\n<p>application configuration owners,organizations:</p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:application</span> <span class=\"hljs-attr\">owner</span>=<span class=\"hljs-string\">”ding.lid,william.liangf”</span> <span class=\"hljs-attr\">organization</span>=<span class=\"hljs-string\">”intl”</span> /&gt;</span>\n</code></pre>\n<p>service configuration owners:</p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:service</span> <span class=\"hljs-attr\">owner</span>=<span class=\"hljs-string\">”ding.lid,william.liangf”</span> /&gt;</span>\n</code></pre>\n<p>reference configuration owners:</p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:reference</span> <span class=\"hljs-attr\">owner</span>=<span class=\"hljs-string\">”ding.lid,william.liangf”</span> /&gt;</span>\n</code></pre>\n<p><code>dubbo:service</code>、<code>dubbo:reference</code> have no configuration owner, then use the owner configured in <code>dubbo:application</code>.</p>\n<h2>Set up the Dubbo cache file</h2>\n<p>Provider service list caching file:</p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:registry</span> <span class=\"hljs-attr\">file</span>=<span class=\"hljs-string\">”${user.home}/output/dubbo.cache”</span> /&gt;</span>\n</code></pre>\n<p>Notations:</p>\n<ol start=\"0\">\n<li>You can modify  the cahe file path of the application according to the needs. Ensure that the file will not be cleared during the release process.</li>\n<li>If there are more than one application process, do not use the same file path to avoid the content being overwritten.</li>\n</ol>\n<p>This file caches the list of the registry and the list of service providers. With this configuration, when the application is restarted , if  the Dubbo registry is not available, the application will read the information from the service provider list from the cache file. That can ensure the availability of the application.</p>\n<h2>Monitor configuration</h2>\n<ol start=\"0\">\n<li>\n<p>Expose service with a fixed port, instead of using a random port</p>\n<p>In this way, when there is a delay in the registry push, the consumer can also call the  original provider service address hrough the cache list and succeed。</p>\n</li>\n<li>\n<p>Use Dragoon's HTTP monitoring item to monitor the service provider on the registry</p>\n<p>The state of Dragoon monitoring service in the registry : <a href=\"http://dubbo-reg1.hst.xyi.cn.alidc.net:8080/status/com.alibaba.morgan.member.MemberService:1.0.5\">http://dubbo-reg1.hst.xyi.cn.alidc.net:8080/status/com.alibaba.morgan.member.MemberService:1.0.5</a> Ensure that the service exists on the registry .</p>\n</li>\n<li>\n<p>Service provider,use Dragoon's telnet mommand or shell monitor  command</p>\n<p>Monitoring service provider port status ：<code>echo status | nc -i 1 20880 | grep OK | wc -l</code>, 20880 is the service port</p>\n</li>\n<li>\n<p>Service consumer side, cast the service to EchoService，and call <code>$echo()</code>  to test whether the provider of the service is available</p>\n<p>eg: <code>assertEqauls(“OK”, ((EchoService)memberService).$echo(“OK”));</code></p>\n</li>\n</ol>\n<h2>Don't use the configuration of dubbo.properties file, suggeset to use  the configuration of XML</h2>\n<p>All of the configuration items in the dubbo can be configured in the spring configuration file,and can be configured for a single service.</p>\n<p>The Dubbo default value is used if completely not set up , please see the instructions in the article  <a href=\"./references/xml/introduction.md\">Dubbo configuration introduction</a> .</p>\n<h3>The relation between attribute name of dubbo.properties and XML</h3>\n<ol start=\"0\">\n<li>\n<p>application name <code>dubbo.application.name</code></p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:application</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"myalibaba\"</span> &gt;</span>\n</code></pre>\n</li>\n<li>\n<p>registry address <code>dubbo.registry.address</code></p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:registry</span> <span class=\"hljs-attr\">address</span>=<span class=\"hljs-string\">\"11.22.33.44:9090\"</span> &gt;</span>\n</code></pre>\n</li>\n<li>\n<p>call timeout <code>dubbo.service.*.timeout</code></p>\n<p>Timeout can be set in multiple configuration items <code>timeout</code>,cover from top to bottom （The top one have a higher priority ）<sup class=\"footnote-ref\"><a href=\"#fn5\" id=\"fnref5\">[5]</a></sup>，The coverage strategy of other parameters（<code>retries</code>、<code>loadbalance</code>、<code>actives</code> and so on）is：</p>\n<p>Certain method  Configuration of a provider service</p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:service</span> <span class=\"hljs-attr\">interface</span>=<span class=\"hljs-string\">\"com.alibaba.xxx.XxxService\"</span> &gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:method</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"findPerson\"</span> <span class=\"hljs-attr\">timeout</span>=<span class=\"hljs-string\">\"1000\"</span> /&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dubbo:service</span>&gt;</span>\n</code></pre>\n<p>Configuration of a provider specific interface</p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:service</span> <span class=\"hljs-attr\">interface</span>=<span class=\"hljs-string\">\"com.alibaba.xxx.XxxService\"</span> <span class=\"hljs-attr\">timeout</span>=<span class=\"hljs-string\">\"200\"</span> /&gt;</span>\n</code></pre>\n</li>\n<li>\n<p>Service provider protocol <code>dubbo.service.protocol</code>、Service monitor port <code>dubbo.service.server.port</code></p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:protocol</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"dubbo\"</span> <span class=\"hljs-attr\">port</span>=<span class=\"hljs-string\">\"20880\"</span> /&gt;</span>\n</code></pre>\n</li>\n<li>\n<p>Service thread pool size <code>dubbo.service.max.thread.threads.size</code></p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:protocol</span> <span class=\"hljs-attr\">threads</span>=<span class=\"hljs-string\">\"100\"</span> /&gt;</span>\n</code></pre>\n</li>\n<li>\n<p>No provider throws exceptions (Fast-Fail) when the consumer is started ()\n<code>alibaba.intl.commons.dubbo.service.allow.no.provider</code></p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:reference</span> <span class=\"hljs-attr\">interface</span>=<span class=\"hljs-string\">\"com.alibaba.xxx.XxxService\"</span> <span class=\"hljs-attr\">check</span>=<span class=\"hljs-string\">\"false\"</span> /&gt;</span>\n</code></pre>\n</li>\n</ol>\n<hr class=\"footnotes-sep\">\n<section class=\"footnotes\">\n<ol class=\"footnotes-list\">\n<li id=\"fn1\" class=\"footnote-item\"><p>Overlay rules for configuration: 1) The method level configuration has a higher priority than the interface level, that is to say,small scope have a high priority 2) Consumer side configuration has a higher priority than provider side, better than global configuration, the last one is the Dubbo hard coded configuration value（<a href=\"./configuration/properties.md\">Dubbo configuration introduction</a>） <a href=\"#fnref1\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn2\" class=\"footnote-item\"><p>With the first call, the call will be called 3 times <a href=\"#fnref2\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn3\" class=\"footnote-item\"><p>How to select a service to call when there are multiple Provider services <a href=\"#fnref3\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn4\" class=\"footnote-item\"><p>It means that consumer service can call the best provider service, and reduce to call the the slow provider service. <a href=\"#fnref4\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn5\" class=\"footnote-item\"><p><code>timeout</code> Can be set in multiple places, configuration items and overlay rules： <a href=\"./references/xml/introduction.md\">Dubbo Schema configuration introduction</a> <a href=\"#fnref5\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n</ol>\n</section>\n"
}