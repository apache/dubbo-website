{
  "filename": "zookeeper.md",
  "__html": "<h1>Zookeeper 注册中心安装</h1>\n<p>建议使用 <code>dubbo-2.3.3</code> 以上版本的 zookeeper <sup class=\"footnote-ref\"><a href=\"#fn1\" id=\"fnref1\">[1]</a></sup> 注册中心客户端。</p>\n<p>Dubbo 未对 Zookeeper 服务器端做任何侵入修改，只需安装原生的 Zookeeper 服务器即可，所有注册中心逻辑适配都在调用 Zookeeper 客户端时完成。</p>\n<p>安装:</p>\n<pre><code class=\"language-sh\">wget http://archive.apache.org/dist/zookeeper/zookeeper-3.3.3/zookeeper-3.3.3.tar.gz\ntar zxvf zookeeper-3.3.3.tar.gz\n<span class=\"hljs-built_in\">cd</span> zookeeper-3.3.3\ncp conf/zoo_sample.cfg conf/zoo.cfg\n</code></pre>\n<p>配置:</p>\n<pre><code class=\"language-sh\">vi conf/zoo.cfg\n</code></pre>\n<p>如果不需要集群，<code>zoo.cfg</code> 的内容如下 <sup class=\"footnote-ref\"><a href=\"#fn2\" id=\"fnref2\">[2]</a></sup>：</p>\n<pre><code class=\"language-properties\">tickTime=2000\ninitLimit=10\nsyncLimit=5\ndataDir=/home/dubbo/zookeeper-3.3.3/data\nclientPort=2181\n</code></pre>\n<p>如果需要集群，<code>zoo.cfg</code> 的内容如下 <sup class=\"footnote-ref\"><a href=\"#fn3\" id=\"fnref3\">[3]</a></sup>：</p>\n<pre><code class=\"language-properties\">tickTime=2000\ninitLimit=10\nsyncLimit=5\ndataDir=/home/dubbo/zookeeper-3.3.3/data\nclientPort=2181\nserver.1=10.20.153.10:2555:3555\nserver.2=10.20.153.11:2555:3555\n</code></pre>\n<p>并在 data 目录 <sup class=\"footnote-ref\"><a href=\"#fn4\" id=\"fnref4\">[4]</a></sup> 下放置 myid 文件：</p>\n<pre><code class=\"language-sh\">mkdir data\nvi myid\n</code></pre>\n<p>myid 指明自己的 id，对应上面 <code>zoo.cfg</code> 中 <code>server.</code> 后的数字，第一台的内容为 1，第二台的内容为 2，内容如下：</p>\n<pre><code>1\n</code></pre>\n<p>启动:</p>\n<pre><code class=\"language-sh\">./bin/zkServer.sh start\n</code></pre>\n<p>停止:</p>\n<pre><code class=\"language-sh\">./bin/zkServer.sh stop\n</code></pre>\n<p>命令行 <sup class=\"footnote-ref\"><a href=\"#fn5\" id=\"fnref5\">[5]</a></sup>:</p>\n<pre><code class=\"language-sh\">telnet 127.0.0.1 2181\ndump\n</code></pre>\n<p>或者:</p>\n<pre><code class=\"language-shell\">echo dump | nc 127.0.0.1 2181\n</code></pre>\n<p>用法:</p>\n<pre><code class=\"language-xml\">dubbo.registry.address=zookeeper://10.20.153.10:2181?backup=10.20.153.11:2181\n</code></pre>\n<p>或者:</p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:registry</span> <span class=\"hljs-attr\">protocol</span>=<span class=\"hljs-string\">\"zookeeper\"</span> <span class=\"hljs-attr\">address</span>=<span class=\"hljs-string\">\"10.20.153.10:2181,10.20.153.11:2181\"</span> /&gt;</span>\n</code></pre>\n<hr class=\"footnotes-sep\">\n<section class=\"footnotes\">\n<ol class=\"footnotes-list\">\n<li id=\"fn1\" class=\"footnote-item\"><p>Zookeeper是 Apache Hadoop 的子项目，强度相对较好，建议生产环境使用该注册中心 <a href=\"#fnref1\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn2\" class=\"footnote-item\"><p>其中 data 目录需改成你真实输出目录 <a href=\"#fnref2\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn3\" class=\"footnote-item\"><p>其中 data 目录和 server 地址需改成你真实部署机器的信息 <a href=\"#fnref3\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn4\" class=\"footnote-item\"><p>上面 <code>zoo.cfg</code> 中的 <code>dataDir</code> <a href=\"#fnref4\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn5\" class=\"footnote-item\"><p><a href=\"http://zookeeper.apache.org/doc/r3.3.3/zookeeperAdmin.html\">http://zookeeper.apache.org/doc/r3.3.3/zookeeperAdmin.html</a> <a href=\"#fnref5\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n</ol>\n</section>\n"
}