{
  "filename": "local-call.md",
  "__html": "<h1>本地调用</h1>\n<p>本地调用使用了 injvm 协议，是一个伪协议，它不开启端口，不发起远程调用，只在 JVM 内直接关联，但执行 Dubbo 的 Filter 链。</p>\n<h2>配置</h2>\n<p>定义 injvm 协议</p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:protocol</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"injvm\"</span> /&gt;</span>\n</code></pre>\n<p>设置默认协议</p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:provider</span> <span class=\"hljs-attr\">protocol</span>=<span class=\"hljs-string\">\"injvm\"</span> /&gt;</span>\n</code></pre>\n<p>设置服务协议</p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:service</span> <span class=\"hljs-attr\">protocol</span>=<span class=\"hljs-string\">\"injvm\"</span> /&gt;</span>\n</code></pre>\n<p>优先使用 injvm</p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:consumer</span> <span class=\"hljs-attr\">injvm</span>=<span class=\"hljs-string\">\"true\"</span> <span class=\"hljs-attr\">...</span>/&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:provider</span> <span class=\"hljs-attr\">injvm</span>=<span class=\"hljs-string\">\"true\"</span> <span class=\"hljs-attr\">...</span>/&gt;</span>\n</code></pre>\n<p>或</p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:reference</span> <span class=\"hljs-attr\">injvm</span>=<span class=\"hljs-string\">\"true\"</span> <span class=\"hljs-attr\">...</span>/&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:service</span> <span class=\"hljs-attr\">injvm</span>=<span class=\"hljs-string\">\"true\"</span> <span class=\"hljs-attr\">...</span>/&gt;</span>\n</code></pre>\n<p>注意：服务暴露与服务引用都需要声明 <code>injvm=&quot;true&quot;</code></p>\n<h2>自动暴露、引用本地服务</h2>\n<p>从 <code>2.2.0</code> 开始，每个服务默认都会在本地暴露。在引用服务的时候，默认优先引用本地服务。如果希望引用远程服务可以使用一下配置强制引用远程服务。</p>\n<pre><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:reference</span> <span class=\"hljs-attr\">...</span> <span class=\"hljs-attr\">scope</span>=<span class=\"hljs-string\">\"remote\"</span> /&gt;</span>\n</code></pre>\n"
}