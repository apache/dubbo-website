{
  "filename": "qos.md",
  "__html": "<h1>新版本 telnet 命令使用说明</h1>\n<p>dubbo 2.5.8 新版本重构了 telnet 模块，提供了新的 telnet 命令支持。</p>\n<h3>端口</h3>\n<p>新版本的 telnet 端口 与 dubbo 协议的端口是不同的端口，默认为 <code>22222</code>，可通过配置文件<code>dubbo.properties</code> 修改:</p>\n<pre><code>dubbo.application.qos.port=33333\n</code></pre>\n<p>或者通过设置 JVM 参数:</p>\n<pre><code>-Ddubbo.application.qos.port=33333\n</code></pre>\n<h3>安全</h3>\n<p>默认情况下，dubbo 接收任何主机发起的命令，可通过配置文件<code>dubbo.properties</code> 修改:</p>\n<pre><code>dubbo.application.qos.accept.foreign.ip=false\n</code></pre>\n<p>或者通过设置 JVM 参数:</p>\n<pre><code>-Ddubbo.application.qos.accept.foreign.ip=false\n</code></pre>\n<p>拒绝远端主机发出的命令，只允许服务本机执行</p>\n<h3>telnet 与 http 协议</h3>\n<p>telnet 模块现在同时支持 http 协议和 telnet 协议，方便各种情况的使用</p>\n<p>示例如下：</p>\n<pre><code>➜  ~ telnet localhost 22222\nTrying ::1...\ntelnet: connect to address ::1: Connection refused\nTrying 127.0.0.1...\nConnected to localhost.\nEscape character is '^]'.\n  ████████▄  ███    █▄  ▀█████████▄  ▀█████████▄   ▄██████▄\n  ███   ▀███ ███    ███   ███    ███   ███    ███ ███    ███\n  ███    ███ ███    ███   ███    ███   ███    ███ ███    ███\n  ███    ███ ███    ███  ▄███▄▄▄██▀   ▄███▄▄▄██▀  ███    ███\n  ███    ███ ███    ███ ▀▀███▀▀▀██▄  ▀▀███▀▀▀██▄  ███    ███\n  ███    ███ ███    ███   ███    ██▄   ███    ██▄ ███    ███\n  ███   ▄███ ███    ███   ███    ███   ███    ███ ███    ███\n  ████████▀  ████████▀  ▄█████████▀  ▄█████████▀   ▀██████▀\n\n\ndubbo&gt;ls\nAs Provider side:\n+----------------------------------+---+\n|       Provider Service Name      |PUB|\n+----------------------------------+---+\n|com.alibaba.dubbo.demo.DemoService| N |\n+----------------------------------+---+\nAs Consumer side:\n+---------------------+---+\n|Consumer Service Name|NUM|\n+---------------------+---+\n\ndubbo&gt;\n</code></pre>\n<pre><code>➜  ~ curl &quot;localhost:22222/ls?arg1=xxx&amp;arg2=xxxx&quot;\nAs Provider side:\n+----------------------------------+---+\n|       Provider Service Name      |PUB|\n+----------------------------------+---+\n|com.alibaba.dubbo.demo.DemoService| N |\n+----------------------------------+---+\nAs Consumer side:\n+---------------------+---+\n|Consumer Service Name|NUM|\n+---------------------+---+\n</code></pre>\n<h3>ls 列出消费者和提供者</h3>\n<pre><code>dubbo&gt;ls\nAs Provider side:\n+----------------------------------+---+\n|       Provider Service Name      |PUB|\n+----------------------------------+---+\n|com.alibaba.dubbo.demo.DemoService| Y |\n+----------------------------------+---+\nAs Consumer side:\n+---------------------+---+\n|Consumer Service Name|NUM|\n+---------------------+---+\n</code></pre>\n<p>列出 dubbo 的所提供的服务和消费的服务，以及消费的服务地址数</p>\n<h3>Online 上线服务命令</h3>\n<p>当使用延迟发布功能的时候(通过设置 com.alibaba.dubbo.config.AbstractServiceConfig#register 为 false)，后续需要上线的时候，可通过 Online 命令</p>\n<pre><code>//上线所有服务\ndubbo&gt;online\nOK\n\n//根据正则，上线部分服务\ndubbo&gt;online com.*\nOK\n</code></pre>\n<p>常见使用场景：</p>\n<ul>\n<li>当线上的 QPS 比较高的时候，当刚重启机器的时候，由于没有进行JIT 预热或相关资源没有预热，可能会导致大量超时，这个时候，可通过分批发布服务，逐渐加大流量</li>\n<li>当由于某台机器由于某种原因，需要下线服务，然后又需要重新上线服务</li>\n</ul>\n<h3>Offline 下线服务命令</h3>\n<p>由于故障等原因，需要临时下线服务保持现场，可以使用 Offline 下线命令。</p>\n<pre><code>//下线所有服务\ndubbo&gt;offline\nOK\n\n//根据正则，下线部分服务\ndubbo&gt;offline com.*\nOK\n</code></pre>\n<h3>help 命令</h3>\n<pre><code>//列出所有命令\ndubbo&gt;help\n\n//列出单个命令的具体使用情况\ndubbo&gt;help online\n+--------------+----------------------------------------------------------------------------------+\n| COMMAND NAME | online                                                                           |\n+--------------+----------------------------------------------------------------------------------+\n|      EXAMPLE | online dubbo                                                                     |\n|              | online xx.xx.xxx.service                                                         |\n+--------------+----------------------------------------------------------------------------------+\n\ndubbo&gt;\n</code></pre>\n"
}