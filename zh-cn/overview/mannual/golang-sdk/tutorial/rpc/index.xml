<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>RPC框架 on Apache Dubbo</title><link>https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/tutorial/rpc/</link><description>Recent content in RPC框架 on Apache Dubbo</description><generator>Hugo</generator><language>zh-cn</language><atom:link href="https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/tutorial/rpc/index.xml" rel="self" type="application/rss+xml"/><item><title>流式通信</title><link>https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/tutorial/rpc/streaming/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/tutorial/rpc/streaming/</guid><description>&lt;p&gt;Streaming 流式通信是 Dubbo3 新提供的一种 RPC 数据传输模式，适用于以下场景:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;接口需要发送大量数据，这些数据无法被放在一个 RPC 的请求或响应中，需要分批发送，但应用层如果按照传统的多次 RPC 方式无法解决顺序和性能的问题，如果需要保证有序，则只能串行发送&lt;/li&gt;
&lt;li&gt;流式场景，数据需要按照发送顺序处理, 数据本身是没有确定边界的&lt;/li&gt;
&lt;li&gt;推送类场景，多个消息在同一个调用的上下文中被发送和处理&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Streaming 流式通信类型分为以下三种:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SERVER_STREAM(服务端流)&lt;/li&gt;
&lt;li&gt;CLIENT_STREAM(客户端流)&lt;/li&gt;
&lt;li&gt;BIDIRECTIONAL_STREAM(双向流)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="1介绍"&gt;1.介绍&lt;/h2&gt;
&lt;p&gt;本文档演示如何在 Dubbo-go 中使用流式通信，可在此查看 &lt;a href="https://github.com/apache/dubbo-go-samples/tree/main/streaming" target="_blank"&gt;完整示例源码地址&lt;/a&gt;。&lt;/p&gt;
&lt;h2 id="2如何使用dubbo-go流式通信"&gt;2.如何使用Dubbo-go流式通信&lt;/h2&gt;
&lt;p&gt;在proto文件中需要流式通信的方法的参数前面添加stream，使用proto-gen-triple生成相应文件&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-protobuf" data-lang="protobuf"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;service&lt;/span&gt; GreetService {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#719e07"&gt;rpc&lt;/span&gt; Greet(GreetRequest) &lt;span style="color:#719e07"&gt;returns&lt;/span&gt; (GreetResponse) {}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#719e07"&gt;rpc&lt;/span&gt; GreetStream(stream GreetStreamRequest) &lt;span style="color:#719e07"&gt;returns&lt;/span&gt; (stream GreetStreamResponse) {}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#719e07"&gt;rpc&lt;/span&gt; GreetClientStream(stream GreetClientStreamRequest) &lt;span style="color:#719e07"&gt;returns&lt;/span&gt; (GreetClientStreamResponse) {}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#719e07"&gt;rpc&lt;/span&gt; GreetServerStream(GreetServerStreamRequest) &lt;span style="color:#719e07"&gt;returns&lt;/span&gt; (stream GreetServerStreamResponse) {}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;编写服务端handler文件&lt;/p&gt;
&lt;p&gt;源文件路径: dubbo-go-sample/streaming/go-server/cmd/server.go&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;type&lt;/span&gt; GreetTripleServer &lt;span style="color:#268bd2"&gt;struct&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;func&lt;/span&gt; (srv &lt;span style="color:#719e07"&gt;*&lt;/span&gt;GreetTripleServer) &lt;span style="color:#268bd2"&gt;Greet&lt;/span&gt;(ctx context.Context, req &lt;span style="color:#719e07"&gt;*&lt;/span&gt;greet.GreetRequest) (&lt;span style="color:#719e07"&gt;*&lt;/span&gt;greet.GreetResponse, &lt;span style="color:#dc322f"&gt;error&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	resp &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; &lt;span style="color:#719e07"&gt;&amp;amp;&lt;/span&gt;greet.GreetResponse{Greeting: req.Name}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#719e07"&gt;return&lt;/span&gt; resp, &lt;span style="color:#cb4b16"&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;func&lt;/span&gt; (srv &lt;span style="color:#719e07"&gt;*&lt;/span&gt;GreetTripleServer) &lt;span style="color:#268bd2"&gt;GreetStream&lt;/span&gt;(ctx context.Context, stream greet.GreetService_GreetStreamServer) &lt;span style="color:#dc322f"&gt;error&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#719e07"&gt;for&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		req, err &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; stream.&lt;span style="color:#268bd2"&gt;Recv&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		&lt;span style="color:#719e07"&gt;if&lt;/span&gt; err &lt;span style="color:#719e07"&gt;!=&lt;/span&gt; &lt;span style="color:#cb4b16"&gt;nil&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;			&lt;span style="color:#719e07"&gt;if&lt;/span&gt; triple.&lt;span style="color:#268bd2"&gt;IsEnded&lt;/span&gt;(err) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;				&lt;span style="color:#719e07"&gt;break&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;			}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;			&lt;span style="color:#719e07"&gt;return&lt;/span&gt; fmt.&lt;span style="color:#268bd2"&gt;Errorf&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;&amp;#34;triple BidiStream recv error: %s&amp;#34;&lt;/span&gt;, err)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		&lt;span style="color:#719e07"&gt;if&lt;/span&gt; err &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; stream.&lt;span style="color:#268bd2"&gt;Send&lt;/span&gt;(&lt;span style="color:#719e07"&gt;&amp;amp;&lt;/span&gt;greet.GreetStreamResponse{Greeting: req.Name}); err &lt;span style="color:#719e07"&gt;!=&lt;/span&gt; &lt;span style="color:#cb4b16"&gt;nil&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;			&lt;span style="color:#719e07"&gt;return&lt;/span&gt; fmt.&lt;span style="color:#268bd2"&gt;Errorf&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;&amp;#34;triple BidiStream send error: %s&amp;#34;&lt;/span&gt;, err)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#719e07"&gt;return&lt;/span&gt; &lt;span style="color:#cb4b16"&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;func&lt;/span&gt; (srv &lt;span style="color:#719e07"&gt;*&lt;/span&gt;GreetTripleServer) &lt;span style="color:#268bd2"&gt;GreetClientStream&lt;/span&gt;(ctx context.Context, stream greet.GreetService_GreetClientStreamServer) (&lt;span style="color:#719e07"&gt;*&lt;/span&gt;greet.GreetClientStreamResponse, &lt;span style="color:#dc322f"&gt;error&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#268bd2"&gt;var&lt;/span&gt; reqs []&lt;span style="color:#dc322f"&gt;string&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#719e07"&gt;for&lt;/span&gt; stream.&lt;span style="color:#268bd2"&gt;Recv&lt;/span&gt;() {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		reqs = &lt;span style="color:#b58900"&gt;append&lt;/span&gt;(reqs, stream.&lt;span style="color:#268bd2"&gt;Msg&lt;/span&gt;().Name)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#719e07"&gt;if&lt;/span&gt; stream.&lt;span style="color:#268bd2"&gt;Err&lt;/span&gt;() &lt;span style="color:#719e07"&gt;!=&lt;/span&gt; &lt;span style="color:#cb4b16"&gt;nil&lt;/span&gt; &lt;span style="color:#719e07"&gt;&amp;amp;&amp;amp;&lt;/span&gt; !triple.&lt;span style="color:#268bd2"&gt;IsEnded&lt;/span&gt;(stream.&lt;span style="color:#268bd2"&gt;Err&lt;/span&gt;()) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		&lt;span style="color:#719e07"&gt;return&lt;/span&gt; &lt;span style="color:#cb4b16"&gt;nil&lt;/span&gt;, fmt.&lt;span style="color:#268bd2"&gt;Errorf&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;&amp;#34;triple ClientStream recv err: %s&amp;#34;&lt;/span&gt;, stream.&lt;span style="color:#268bd2"&gt;Err&lt;/span&gt;())
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	resp &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; &lt;span style="color:#719e07"&gt;&amp;amp;&lt;/span&gt;greet.GreetClientStreamResponse{
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		Greeting: strings.&lt;span style="color:#268bd2"&gt;Join&lt;/span&gt;(reqs, &lt;span style="color:#2aa198"&gt;&amp;#34;,&amp;#34;&lt;/span&gt;),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#719e07"&gt;return&lt;/span&gt; resp, &lt;span style="color:#cb4b16"&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;func&lt;/span&gt; (srv &lt;span style="color:#719e07"&gt;*&lt;/span&gt;GreetTripleServer) &lt;span style="color:#268bd2"&gt;GreetServerStream&lt;/span&gt;(ctx context.Context, req &lt;span style="color:#719e07"&gt;*&lt;/span&gt;greet.GreetServerStreamRequest, stream greet.GreetService_GreetServerStreamServer) &lt;span style="color:#dc322f"&gt;error&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#719e07"&gt;for&lt;/span&gt; i &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; &lt;span style="color:#2aa198"&gt;0&lt;/span&gt;; i &amp;lt; &lt;span style="color:#2aa198"&gt;5&lt;/span&gt;; i&lt;span style="color:#719e07"&gt;++&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		&lt;span style="color:#719e07"&gt;if&lt;/span&gt; err &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; stream.&lt;span style="color:#268bd2"&gt;Send&lt;/span&gt;(&lt;span style="color:#719e07"&gt;&amp;amp;&lt;/span&gt;greet.GreetServerStreamResponse{Greeting: req.Name}); err &lt;span style="color:#719e07"&gt;!=&lt;/span&gt; &lt;span style="color:#cb4b16"&gt;nil&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;			&lt;span style="color:#719e07"&gt;return&lt;/span&gt; fmt.&lt;span style="color:#268bd2"&gt;Errorf&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;&amp;#34;triple ServerStream send err: %s&amp;#34;&lt;/span&gt;, err)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#719e07"&gt;return&lt;/span&gt; &lt;span style="color:#cb4b16"&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;编写客户端client文件&lt;/p&gt;</description></item><item><title>超时时间</title><link>https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/tutorial/rpc/timeout/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/tutorial/rpc/timeout/</guid><description>&lt;h2 id="1介绍"&gt;1.介绍&lt;/h2&gt;
&lt;p&gt;本示例演示如何在 Dubbo-go 客户端发起调用时设置请求超时时间。可在此查看 &lt;a href="https://github.com/apache/dubbo-go-samples/tree/main/timeout" target="_blank"&gt;完整示例源码地址&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="2如何设置请求超时时间"&gt;2.如何设置请求超时时间&lt;/h2&gt;
&lt;p&gt;在创建客户端时，可以使用 &lt;code&gt;client.WithRequestTimeout()&lt;/code&gt; 方法设置全局超时时间（所有使用改 client 的服务代理共享）。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; cli, err &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; client.&lt;span style="color:#268bd2"&gt;NewClient&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; client.&lt;span style="color:#268bd2"&gt;WithClientURL&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;&amp;#34;tri://127.0.0.1:20000&amp;#34;&lt;/span&gt;),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; client.&lt;span style="color:#268bd2"&gt;WithClientRequestTimeout&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;3&lt;/span&gt; &lt;span style="color:#719e07"&gt;*&lt;/span&gt; time.Second),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; )
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;可以使用 &lt;code&gt;client.WithRequestTimeout()&lt;/code&gt; 创建服务粒度的超时时间（以下服务代理 &lt;code&gt;svc&lt;/code&gt; 发起的方法调用都使用这个时间）。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; svc, err &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; greet.&lt;span style="color:#268bd2"&gt;NewGreetService&lt;/span&gt;(cli, client.&lt;span style="color:#268bd2"&gt;WithRequestTimeout&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;5&lt;/span&gt; &lt;span style="color:#719e07"&gt;*&lt;/span&gt; time.Second))
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;也可以在调用发起时，使用 &lt;code&gt;client.WithCallRequestTimeout()&lt;/code&gt; 指定一个超时时间&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;resp, err &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; svc.&lt;span style="color:#268bd2"&gt;GreetTimeout&lt;/span&gt;(context.&lt;span style="color:#268bd2"&gt;Background&lt;/span&gt;(), &lt;span style="color:#719e07"&gt;&amp;amp;&lt;/span&gt;greet.GreetRequest{Name: &lt;span style="color:#2aa198"&gt;&amp;#34;hello world&amp;#34;&lt;/span&gt;}, client.&lt;span style="color:#268bd2"&gt;WithCallRequestTimeout&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;10&lt;/span&gt; &lt;span style="color:#719e07"&gt;*&lt;/span&gt; time.Second))
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;从上往下，以上三种方式的优先级逐步提高，&lt;code&gt;client.WithCallRequestTimeout()&lt;/code&gt; 指定的超时时间优先级最高。&lt;/p&gt;
&lt;h2 id="3示例详解"&gt;3.示例详解&lt;/h2&gt;
&lt;h3 id="31服务端介绍"&gt;3.1服务端介绍&lt;/h3&gt;
&lt;h4 id="服务端proto文件"&gt;服务端proto文件&lt;/h4&gt;
&lt;p&gt;源文件路径：dubbo-go-sample/timeout/proto/greet.proto&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-protobuf" data-lang="protobuf"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;syntax &lt;span style="color:#719e07"&gt;=&lt;/span&gt; &lt;span style="color:#2aa198"&gt;&amp;#34;proto3&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#719e07"&gt;package&lt;/span&gt; greet;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#719e07"&gt;option&lt;/span&gt; go_package &lt;span style="color:#719e07"&gt;=&lt;/span&gt; &lt;span style="color:#2aa198"&gt;&amp;#34;github.com/apache/dubbo-go-samples/timeout/proto;greet&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;message&lt;/span&gt; &lt;span style="color:#268bd2"&gt;GreetRequest&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#dc322f"&gt;string&lt;/span&gt; name &lt;span style="color:#719e07"&gt;=&lt;/span&gt; &lt;span style="color:#2aa198"&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;message&lt;/span&gt; &lt;span style="color:#268bd2"&gt;GreetResponse&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#dc322f"&gt;string&lt;/span&gt; greeting &lt;span style="color:#719e07"&gt;=&lt;/span&gt; &lt;span style="color:#2aa198"&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;service&lt;/span&gt; GreetService {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#719e07"&gt;rpc&lt;/span&gt; Greet(GreetRequest) &lt;span style="color:#719e07"&gt;returns&lt;/span&gt; (GreetResponse) {}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#719e07"&gt;rpc&lt;/span&gt; GreetTimeout(GreetRequest) &lt;span style="color:#719e07"&gt;returns&lt;/span&gt; (GreetResponse) {}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="服务端handler文件"&gt;服务端handler文件&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;Greet&lt;/code&gt;方法直接响应，&lt;code&gt;GreetTimeout&lt;/code&gt;方法等待五秒后响应（模拟超时）。&lt;/p&gt;</description></item><item><title>健康检查</title><link>https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/tutorial/rpc/healthcheck/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/tutorial/rpc/healthcheck/</guid><description>&lt;h2 id="背景"&gt;背景&lt;/h2&gt;
&lt;p&gt;Dubbo-go 内置了基于 triple 协议的健康检查服务，帮助用户管理和监测服务健康状态，可在此查看 &lt;a href="https://github.com/apache/dubbo-go-samples/tree/main/healthcheck" target="_blank"&gt;完整示例源码&lt;/a&gt;。&lt;/p&gt;
&lt;h2 id="使用方法"&gt;使用方法&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;框架在通过 &lt;code&gt;instance&lt;/code&gt; 启动后会自动向框架中注册健康检查服务 &lt;code&gt;grpc.health.v1.Health&lt;/code&gt;，用于记录并对外暴露每个triple服务的健康状态。&lt;/li&gt;
&lt;li&gt;健康检查服务可以通过发起 http 请求检查框架中服务的状态，也可以通过客户端调用该健康检查服务，调用的接口为&lt;code&gt;grpc.health.v1.Health&lt;/code&gt;，方法为 &lt;code&gt;check&lt;/code&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="1通过客户端调用健康检查服务"&gt;1、通过客户端调用健康检查服务&lt;/h2&gt;
&lt;p&gt;启动 dubbo-go-samples/healthcheck/go-server 中的服务，通过下方客户端即可查看 &lt;code&gt;greet.GreetService&lt;/code&gt; 的状态。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#719e07"&gt;package&lt;/span&gt; main
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#719e07"&gt;import&lt;/span&gt; (
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#2aa198"&gt;&amp;#34;context&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#2aa198"&gt;&amp;#34;dubbo.apache.org/dubbo-go/v3/client&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	_ &lt;span style="color:#2aa198"&gt;&amp;#34;dubbo.apache.org/dubbo-go/v3/imports&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	health &lt;span style="color:#2aa198"&gt;&amp;#34;dubbo.apache.org/dubbo-go/v3/protocol/triple/health/triple_health&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#2aa198"&gt;&amp;#34;github.com/dubbogo/gost/log/logger&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;func&lt;/span&gt; &lt;span style="color:#268bd2"&gt;main&lt;/span&gt;() {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	cli, err &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; client.&lt;span style="color:#268bd2"&gt;NewClient&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		client.&lt;span style="color:#268bd2"&gt;WithClientURL&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;&amp;#34;tri://127.0.0.1:20000&amp;#34;&lt;/span&gt;),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#719e07"&gt;if&lt;/span&gt; err &lt;span style="color:#719e07"&gt;!=&lt;/span&gt; &lt;span style="color:#cb4b16"&gt;nil&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		&lt;span style="color:#b58900"&gt;panic&lt;/span&gt;(err)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	svc, err &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; health.&lt;span style="color:#268bd2"&gt;NewHealth&lt;/span&gt;(cli)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#719e07"&gt;if&lt;/span&gt; err &lt;span style="color:#719e07"&gt;!=&lt;/span&gt; &lt;span style="color:#cb4b16"&gt;nil&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		&lt;span style="color:#b58900"&gt;panic&lt;/span&gt;(err)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	check, err &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; svc.&lt;span style="color:#268bd2"&gt;Check&lt;/span&gt;(context.&lt;span style="color:#268bd2"&gt;Background&lt;/span&gt;(), &lt;span style="color:#719e07"&gt;&amp;amp;&lt;/span&gt;health.HealthCheckRequest{Service: &lt;span style="color:#2aa198"&gt;&amp;#34;greet.GreetService&amp;#34;&lt;/span&gt;})
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#719e07"&gt;if&lt;/span&gt; err &lt;span style="color:#719e07"&gt;!=&lt;/span&gt; &lt;span style="color:#cb4b16"&gt;nil&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		logger.&lt;span style="color:#268bd2"&gt;Error&lt;/span&gt;(err)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	} &lt;span style="color:#719e07"&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		logger.&lt;span style="color:#268bd2"&gt;Info&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;&amp;#34;greet.GreetService&amp;#39;s health&amp;#34;&lt;/span&gt;, check.&lt;span style="color:#268bd2"&gt;String&lt;/span&gt;())
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	watch, err &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; svc.&lt;span style="color:#268bd2"&gt;Watch&lt;/span&gt;(context.&lt;span style="color:#268bd2"&gt;Background&lt;/span&gt;(), &lt;span style="color:#719e07"&gt;&amp;amp;&lt;/span&gt;health.HealthCheckRequest{Service: &lt;span style="color:#2aa198"&gt;&amp;#34;greet.GreetService&amp;#34;&lt;/span&gt;})
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#719e07"&gt;if&lt;/span&gt; err &lt;span style="color:#719e07"&gt;!=&lt;/span&gt; &lt;span style="color:#cb4b16"&gt;nil&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		logger.&lt;span style="color:#268bd2"&gt;Error&lt;/span&gt;(err)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	} &lt;span style="color:#719e07"&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		&lt;span style="color:#719e07"&gt;if&lt;/span&gt; watch.&lt;span style="color:#268bd2"&gt;Recv&lt;/span&gt;() {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;			logger.&lt;span style="color:#268bd2"&gt;Info&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;&amp;#34;greet.GreetService&amp;#39;s health&amp;#34;&lt;/span&gt;, watch.&lt;span style="color:#268bd2"&gt;Msg&lt;/span&gt;().&lt;span style="color:#268bd2"&gt;String&lt;/span&gt;())
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;启动后会有以下输出&lt;/p&gt;</description></item><item><title>请求重试</title><link>https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/tutorial/rpc/retry/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/tutorial/rpc/retry/</guid><description>&lt;p&gt;当一次服务调用失败时，我们可以让框架选择自动重试几次，这样能提高用户侧看到的请求成功率。在 failover cluster 模式下 dubbo-go 支持自动重试。&lt;/p&gt;
&lt;h2 id="1介绍"&gt;1.介绍&lt;/h2&gt;
&lt;p&gt;本示例演示如何在 client 端调用失败时配置重试功能，&lt;a href="https://github.com/apache/dubbo-go-samples/tree/main/retry" target="_blank"&gt;完整示例源码地址&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="2如何使用重试功能"&gt;2.如何使用重试功能&lt;/h2&gt;
&lt;p&gt;在使用 &lt;code&gt;client.NewClient()&lt;/code&gt; 创建客户端时，可以使用 &lt;code&gt;client.WithClientRetries()&lt;/code&gt; 方法设置重试次数。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cli, err &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; client.&lt;span style="color:#268bd2"&gt;NewClient&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	client.&lt;span style="color:#268bd2"&gt;WithClientURL&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;&amp;#34;tri://127.0.0.1:20000&amp;#34;&lt;/span&gt;),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	client.&lt;span style="color:#268bd2"&gt;WithClientRetries&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;3&lt;/span&gt;),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;或者，可以使用 &lt;code&gt;client.WithRequestTimeout()&lt;/code&gt; 设置服务粒度的超时时间（以下配置对服务 &lt;code&gt;svc&lt;/code&gt; 起作用）。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;svc, err &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; greet.&lt;span style="color:#268bd2"&gt;NewGreetService&lt;/span&gt;(cli, client.&lt;span style="color:#268bd2"&gt;WithClientRetries&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;5&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;也可以在调用发起时，使用 &lt;code&gt;client.WithCallRetries()&lt;/code&gt; 指定重试次数&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;resp, err &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; svc.&lt;span style="color:#268bd2"&gt;Greet&lt;/span&gt;(context.&lt;span style="color:#268bd2"&gt;Background&lt;/span&gt;(), &lt;span style="color:#719e07"&gt;&amp;amp;&lt;/span&gt;greet.GreetRequest{Name: &lt;span style="color:#2aa198"&gt;&amp;#34;hello world&amp;#34;&lt;/span&gt;}, client.&lt;span style="color:#268bd2"&gt;WithCallRetries&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;6&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;从上往下，以上三种方式的优先级逐步提高，&lt;code&gt;client.WithCallRetries()&lt;/code&gt; 指定的重试次数优先级最高。&lt;/p&gt;
&lt;h2 id="3示例解读"&gt;3.示例解读&lt;/h2&gt;
&lt;h3 id="31服务端介绍"&gt;3.1服务端介绍&lt;/h3&gt;
&lt;h4 id="服务端proto文件"&gt;服务端proto文件&lt;/h4&gt;
&lt;p&gt;源文件路径：dubbo-go-sample/retry/proto/greet.proto&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-protobuf" data-lang="protobuf"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;syntax &lt;span style="color:#719e07"&gt;=&lt;/span&gt; &lt;span style="color:#2aa198"&gt;&amp;#34;proto3&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#719e07"&gt;package&lt;/span&gt; greet;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#719e07"&gt;option&lt;/span&gt; go_package &lt;span style="color:#719e07"&gt;=&lt;/span&gt; &lt;span style="color:#2aa198"&gt;&amp;#34;github.com/apache/dubbo-go-samples/retry/proto;greet&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;message&lt;/span&gt; &lt;span style="color:#268bd2"&gt;GreetRequest&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#dc322f"&gt;string&lt;/span&gt; name &lt;span style="color:#719e07"&gt;=&lt;/span&gt; &lt;span style="color:#2aa198"&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;message&lt;/span&gt; &lt;span style="color:#268bd2"&gt;GreetResponse&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#dc322f"&gt;string&lt;/span&gt; greeting &lt;span style="color:#719e07"&gt;=&lt;/span&gt; &lt;span style="color:#2aa198"&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;service&lt;/span&gt; GreetService {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#719e07"&gt;rpc&lt;/span&gt; Greet(GreetRequest) &lt;span style="color:#719e07"&gt;returns&lt;/span&gt; (GreetResponse) {}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#719e07"&gt;rpc&lt;/span&gt; GreetTimeout(GreetRequest) &lt;span style="color:#719e07"&gt;returns&lt;/span&gt; (GreetResponse) {}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="服务端handler文件"&gt;服务端handler文件&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;Greet&lt;/code&gt;方法直接响应，&lt;code&gt;GreetRetry&lt;/code&gt;方法用于模拟重试。&lt;/p&gt;</description></item><item><title>通信协议</title><link>https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/tutorial/rpc/protocol/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/tutorial/rpc/protocol/</guid><description>&lt;p&gt;Dubbo-go 框架内置提供了两款协议：triple、dubbo，除此之外，框架还提供了多种协议扩展接入方式。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;triple，基于 HTTP/1、HTTP/2 的高性能通信协议，100% 兼容 gRPC，支持 Unary、Streming 等通信模式；支持发布 REST 风格的 HTTP 服务。&lt;/li&gt;
&lt;li&gt;dubbo，基于 TCP 的高性能私有通信协议，缺点是通用性较差，更适合在 Dubbo SDK 间使用；&lt;/li&gt;
&lt;li&gt;任意协议扩展，通过扩展 protocol 可以之前任意 RPC 协议，官方生态库提供 JsonRPC、thrift 等支持。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;本篇文档中，我们将介绍关于 triple 协议的使用方式、如何实现与已有 dubbo2 系统的互相调用、扩展更多协议支持等。更多原理性介绍请参考 &lt;a href="https://dubbo.apache.org/zh-cn/overview/reference/protocols/triple-spec/"&gt;协议规范&lt;/a&gt; 或者 &lt;a href="https://dubbo.apache.org/zh-cn/overview/mannual/java-sdk/tasks/protocols/protocol/"&gt;dubbo java 中相关描述文档&lt;/a&gt;。&lt;/p&gt;
&lt;h2 id="triple-协议"&gt;triple 协议&lt;/h2&gt;
&lt;p&gt;triple 协议支持使用 protobuf 和 non-protobuf 两种开发模式，我们 &lt;strong&gt;推荐使用 protobuf 模式开发服务&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;目前我们大部分示例都是使用这个模式开发，可查看 &lt;a href="https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/quickstart/rpc/"&gt;快速开始&lt;/a&gt; 学习完整开发示例，以下是基本步骤：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;先使用 protobuf 定义服务&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-protobuf" data-lang="protobuf"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;syntax &lt;span style="color:#719e07"&gt;=&lt;/span&gt; &lt;span style="color:#2aa198"&gt;&amp;#34;proto3&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#719e07"&gt;package&lt;/span&gt; greet;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#719e07"&gt;option&lt;/span&gt; go_package &lt;span style="color:#719e07"&gt;=&lt;/span&gt; &lt;span style="color:#2aa198"&gt;&amp;#34;github.com/apache/dubbo-go-samples/helloworld/proto;greet&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;message&lt;/span&gt; &lt;span style="color:#268bd2"&gt;GreetRequest&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#dc322f"&gt;string&lt;/span&gt; name &lt;span style="color:#719e07"&gt;=&lt;/span&gt; &lt;span style="color:#2aa198"&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;message&lt;/span&gt; &lt;span style="color:#268bd2"&gt;GreetResponse&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#dc322f"&gt;string&lt;/span&gt; greeting &lt;span style="color:#719e07"&gt;=&lt;/span&gt; &lt;span style="color:#2aa198"&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;service&lt;/span&gt; GreetService {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#719e07"&gt;rpc&lt;/span&gt; Greet(GreetRequest) &lt;span style="color:#719e07"&gt;returns&lt;/span&gt; (GreetResponse) {}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start="2"&gt;
&lt;li&gt;&lt;a href="https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/quickstart/rpc/#%E5%89%8D%E7%BD%AE%E6%9D%A1%E4%BB%B6"&gt;安装 protoc 插件&lt;/a&gt;，编译生成代码：&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-shell" data-lang="shell"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;protoc --go_out&lt;span style="color:#719e07"&gt;=&lt;/span&gt;. --go_opt&lt;span style="color:#719e07"&gt;=&lt;/span&gt;&lt;span style="color:#268bd2"&gt;paths&lt;/span&gt;&lt;span style="color:#719e07"&gt;=&lt;/span&gt;source_relative &lt;span style="color:#cb4b16"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#cb4b16"&gt;&lt;/span&gt; --go-triple_out&lt;span style="color:#719e07"&gt;=&lt;/span&gt;. --go-triple_opt&lt;span style="color:#719e07"&gt;=&lt;/span&gt;&lt;span style="color:#268bd2"&gt;paths&lt;/span&gt;&lt;span style="color:#719e07"&gt;=&lt;/span&gt;source_relative &lt;span style="color:#cb4b16"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#cb4b16"&gt;&lt;/span&gt; proto/greet.proto
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start="3"&gt;
&lt;li&gt;server 端发布服务&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;srv, err &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; server.&lt;span style="color:#268bd2"&gt;NewServer&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	server.&lt;span style="color:#268bd2"&gt;WithServerProtocol&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		protocol.&lt;span style="color:#268bd2"&gt;WithPort&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;20000&lt;/span&gt;),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		protocol.&lt;span style="color:#268bd2"&gt;WithTriple&lt;/span&gt;(),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;greet.&lt;span style="color:#268bd2"&gt;RegisterGreetServiceHandler&lt;/span&gt;(srv, &lt;span style="color:#719e07"&gt;&amp;amp;&lt;/span&gt;GreetTripleServer{})
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start="4"&gt;
&lt;li&gt;client 端调用服务&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cli, err &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; client.&lt;span style="color:#268bd2"&gt;NewClient&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	client.&lt;span style="color:#268bd2"&gt;WithClientURL&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;&amp;#34;127.0.0.1:20000&amp;#34;&lt;/span&gt;),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;svc, err &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; greet.&lt;span style="color:#268bd2"&gt;NewGreetService&lt;/span&gt;(cli)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;resp, err &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; svc.&lt;span style="color:#268bd2"&gt;Greet&lt;/span&gt;(context.&lt;span style="color:#268bd2"&gt;Background&lt;/span&gt;(), &lt;span style="color:#719e07"&gt;&amp;amp;&lt;/span&gt;greet.GreetRequest{Name: &lt;span style="color:#2aa198"&gt;&amp;#34;hello world&amp;#34;&lt;/span&gt;})
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="dubbo-java-体系互调"&gt;dubbo-java 体系互调&lt;/h2&gt;
&lt;p&gt;如果 java 和 go 都使用 triple+protobuf 模式，很明显他们是可以直接互调通信的。&lt;/p&gt;</description></item><item><title>异常类型返回值</title><link>https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/tutorial/rpc/error/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/tutorial/rpc/error/</guid><description>&lt;h2 id="1介绍"&gt;1.介绍&lt;/h2&gt;
&lt;p&gt;本文档演示如何在 RPC 调用过程中处理 error 错误类型响应，可在此查看 &lt;a href="https://github.com/apache/dubbo-go-samples/tree/main/error" target="_blank"&gt;完整示例源码地址&lt;/a&gt;。&lt;/p&gt;
&lt;h2 id="2示例详解"&gt;2.示例详解&lt;/h2&gt;
&lt;h3 id="21-服务端"&gt;2.1 服务端&lt;/h3&gt;
&lt;h4 id="服务端proto文件"&gt;服务端proto文件&lt;/h4&gt;
&lt;p&gt;源文件路径：dubbo-go-sample/error/proto/greet.proto&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-protobuf" data-lang="protobuf"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;syntax &lt;span style="color:#719e07"&gt;=&lt;/span&gt; &lt;span style="color:#2aa198"&gt;&amp;#34;proto3&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#719e07"&gt;package&lt;/span&gt; greet;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#719e07"&gt;option&lt;/span&gt; go_package &lt;span style="color:#719e07"&gt;=&lt;/span&gt; &lt;span style="color:#2aa198"&gt;&amp;#34;github.com/apache/dubbo-go-samples/error/proto;greet&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;message&lt;/span&gt; &lt;span style="color:#268bd2"&gt;GreetRequest&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#dc322f"&gt;string&lt;/span&gt; name &lt;span style="color:#719e07"&gt;=&lt;/span&gt; &lt;span style="color:#2aa198"&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;message&lt;/span&gt; &lt;span style="color:#268bd2"&gt;GreetResponse&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#dc322f"&gt;string&lt;/span&gt; greeting &lt;span style="color:#719e07"&gt;=&lt;/span&gt; &lt;span style="color:#2aa198"&gt;1&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;service&lt;/span&gt; GreetService {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#719e07"&gt;rpc&lt;/span&gt; Greet(GreetRequest) &lt;span style="color:#719e07"&gt;returns&lt;/span&gt; (GreetResponse) {}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="服务端handler文件"&gt;服务端handler文件&lt;/h4&gt;
&lt;p&gt;请注意，在本程序设计中，Greet方法只有接收到 &lt;code&gt;name=&amp;quot;right name&amp;quot;&lt;/code&gt; 时才会认为是正确请求，否则会返回错误。&lt;/p&gt;
&lt;p&gt;源文件路径：dubbo-go-sample/context/go-server/main.go&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#719e07"&gt;package&lt;/span&gt; main
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#719e07"&gt;import&lt;/span&gt; (
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#2aa198"&gt;&amp;#34;context&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#2aa198"&gt;&amp;#34;fmt&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#2aa198"&gt;&amp;#34;github.com/pkg/errors&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	_ &lt;span style="color:#2aa198"&gt;&amp;#34;dubbo.apache.org/dubbo-go/v3/imports&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#2aa198"&gt;&amp;#34;dubbo.apache.org/dubbo-go/v3/protocol&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#2aa198"&gt;&amp;#34;dubbo.apache.org/dubbo-go/v3/server&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	greet &lt;span style="color:#2aa198"&gt;&amp;#34;github.com/apache/dubbo-go-samples/helloworld/proto&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#2aa198"&gt;&amp;#34;github.com/dubbogo/gost/log/logger&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;type&lt;/span&gt; GreetTripleServer &lt;span style="color:#268bd2"&gt;struct&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;func&lt;/span&gt; (srv &lt;span style="color:#719e07"&gt;*&lt;/span&gt;GreetTripleServer) &lt;span style="color:#268bd2"&gt;Greet&lt;/span&gt;(ctx context.Context, req &lt;span style="color:#719e07"&gt;*&lt;/span&gt;greet.GreetRequest) (&lt;span style="color:#719e07"&gt;*&lt;/span&gt;greet.GreetResponse, &lt;span style="color:#dc322f"&gt;error&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	name &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; req.Name
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#719e07"&gt;if&lt;/span&gt; name &lt;span style="color:#719e07"&gt;!=&lt;/span&gt; &lt;span style="color:#2aa198"&gt;&amp;#34;right name&amp;#34;&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		errInfo &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; fmt.&lt;span style="color:#268bd2"&gt;Sprintf&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;&amp;#34;name is not right: %s&amp;#34;&lt;/span&gt;, name)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		logger.&lt;span style="color:#268bd2"&gt;Error&lt;/span&gt;(errInfo)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		&lt;span style="color:#719e07"&gt;return&lt;/span&gt; &lt;span style="color:#cb4b16"&gt;nil&lt;/span&gt;, errors.&lt;span style="color:#268bd2"&gt;New&lt;/span&gt;(errInfo)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	resp &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; &lt;span style="color:#719e07"&gt;&amp;amp;&lt;/span&gt;greet.GreetResponse{Greeting: req.Name}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#719e07"&gt;return&lt;/span&gt; resp, &lt;span style="color:#cb4b16"&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;func&lt;/span&gt; &lt;span style="color:#268bd2"&gt;main&lt;/span&gt;() {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	srv, err &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; server.&lt;span style="color:#268bd2"&gt;NewServer&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		server.&lt;span style="color:#268bd2"&gt;WithServerProtocol&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;			protocol.&lt;span style="color:#268bd2"&gt;WithPort&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;20000&lt;/span&gt;),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;			protocol.&lt;span style="color:#268bd2"&gt;WithTriple&lt;/span&gt;(),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#719e07"&gt;if&lt;/span&gt; err &lt;span style="color:#719e07"&gt;!=&lt;/span&gt; &lt;span style="color:#cb4b16"&gt;nil&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		&lt;span style="color:#b58900"&gt;panic&lt;/span&gt;(err)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#719e07"&gt;if&lt;/span&gt; err = greet.&lt;span style="color:#268bd2"&gt;RegisterGreetServiceHandler&lt;/span&gt;(srv, &lt;span style="color:#719e07"&gt;&amp;amp;&lt;/span&gt;GreetTripleServer{}); err &lt;span style="color:#719e07"&gt;!=&lt;/span&gt; &lt;span style="color:#cb4b16"&gt;nil&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		&lt;span style="color:#b58900"&gt;panic&lt;/span&gt;(err)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#719e07"&gt;if&lt;/span&gt; err = srv.&lt;span style="color:#268bd2"&gt;Serve&lt;/span&gt;(); err &lt;span style="color:#719e07"&gt;!=&lt;/span&gt; &lt;span style="color:#cb4b16"&gt;nil&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;		logger.&lt;span style="color:#268bd2"&gt;Error&lt;/span&gt;(err)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;从 rpc 方法签名中，我们可以看到 &lt;code&gt;func (srv *GreetTripleServer) Greet(ctx context.Context, req *greet.GreetRequest) (*greet.GreetResponse, error)&lt;/code&gt; 包含 error 返回值。&lt;/p&gt;</description></item><item><title>传递附加参数</title><link>https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/tutorial/rpc/attachments/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/tutorial/rpc/attachments/</guid><description>&lt;p&gt;&lt;strong&gt;理解隐式参数传递的最直接方式 http header，它的工作方式与 http header 完全一致，在 GET 或 POST 请求体之外可以传递任意多个 header 参数&lt;/strong&gt;。而对于 RPC 调用而言，context就是在方法签名的参数之外提供附加参数传递能力，在实现原理上，对于不同的协议，attachment 的实现方式略有不同：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;对于 triple 协议，attachment 会转换为标准的 http header 进行传输。&lt;/li&gt;
&lt;li&gt;对于 dubbo 协议，attachment 是编码在协议体的固定位置进行传输，具体请参见 dubbo 协议规范。、&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src="https://dubbo.apache.org/imgs/user/context.png" alt="/user-guide/images/context.png"&gt;&lt;/p&gt;


&lt;div class="alert alert-primary" role="alert"&gt;
&lt;h4 class="alert-heading"&gt;注意&lt;/h4&gt;

 &lt;ul&gt;
&lt;li&gt;在使用 triple 协议时，由于 http header 的限制，仅支持小写的 ascii 字符&lt;/li&gt;
&lt;li&gt;path, group, version, dubbo, token, timeout 等一些 key 是保留字段，传递 attachment 时应避免使用，尽量通过业务前缀等确保 key 的唯一性。&lt;/li&gt;
&lt;/ul&gt;


&lt;/div&gt;

&lt;h2 id="1介绍"&gt;1.介绍&lt;/h2&gt;
&lt;p&gt;本文档演示如何在 Dubbo-go 框架中使用 context 上下文传递和读取附加参数，来实现上下文信息传递，可在此查看 &lt;a href="https://github.com/apache/dubbo-go-samples/tree/main/context" target="_blank"&gt;完整示例源码地址&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="2使用说明"&gt;2.使用说明&lt;/h2&gt;
&lt;h3 id="21客户端使用说明"&gt;2.1客户端使用说明&lt;/h3&gt;
&lt;p&gt;在客户端中，使用下述方式传递字段, 示例中 key 为 &lt;code&gt;constant.AttachmentKey&lt;/code&gt; 即 &amp;ldquo;attachment&amp;rdquo;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	ctx &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; context.&lt;span style="color:#268bd2"&gt;Background&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	ctx = context.&lt;span style="color:#268bd2"&gt;WithValue&lt;/span&gt;(ctx, constant.AttachmentKey, &lt;span style="color:#268bd2"&gt;map&lt;/span&gt;[&lt;span style="color:#dc322f"&gt;string&lt;/span&gt;]&lt;span style="color:#268bd2"&gt;interface&lt;/span&gt;{}{
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#2aa198"&gt;&amp;#34;key1&amp;#34;&lt;/span&gt;: &lt;span style="color:#2aa198"&gt;&amp;#34;user defined value 1&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#2aa198"&gt;&amp;#34;key2&amp;#34;&lt;/span&gt;: &lt;span style="color:#2aa198"&gt;&amp;#34;user defined value 2&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	})
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="22服务端使用说明"&gt;2.2服务端使用说明&lt;/h3&gt;
&lt;p&gt;在服务端中，使用下述方式获取字段, value的类型为 map[string]interface{}：&lt;/p&gt;</description></item><item><title>启动时检查</title><link>https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/tutorial/rpc/start-check/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/tutorial/rpc/start-check/</guid><description>&lt;p&gt;Dubbo 框架缺省会在启动时检查依赖的服务是否可用（注册中心是否有可用地址），不可用时会抛出异常，阻止应用初始化完成，以便上线时，能及早发现问题，默认 check=&amp;ldquo;true&amp;rdquo;，并等待3s。&lt;/p&gt;
&lt;p&gt;可以通过 check=&amp;ldquo;false&amp;rdquo; 关闭检查，比如，测试时，有些服务不关心，或者出现了循环依赖，必须有一方先启动。&lt;/p&gt;
&lt;p&gt;关闭 check 后，请注意 provider数量比较多时， consumer 订阅 provider 生成服务地址可能会有一定延迟，如果 consumer 一启动就对外提供服务，可能会造成&amp;quot;冷启动&amp;quot;。所以在这个时候，请对服务进行预热。&lt;/p&gt;
&lt;p&gt;示例：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-yaml" data-lang="yaml"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;dubbo&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#268bd2"&gt;consumer&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#268bd2"&gt;check &lt;/span&gt;: &lt;span style="color:#cb4b16"&gt;false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#268bd2"&gt;reference&lt;/span&gt;: 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#268bd2"&gt;myserivce&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#268bd2"&gt;check&lt;/span&gt;: &lt;span style="color:#cb4b16"&gt;true&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;或者&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cli, err &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; client.&lt;span style="color:#268bd2"&gt;NewClient&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	client.&lt;span style="color:#268bd2"&gt;WithClientCheck&lt;/span&gt;(&lt;span style="color:#cb4b16"&gt;false&lt;/span&gt;),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;或者&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;svc, err &lt;span style="color:#719e07"&gt;:=&lt;/span&gt; health.&lt;span style="color:#268bd2"&gt;NewHealth&lt;/span&gt;(cli)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;svc.&lt;span style="color:#268bd2"&gt;Check&lt;/span&gt;(context.&lt;span style="color:#268bd2"&gt;Background&lt;/span&gt;(), &lt;span style="color:#719e07"&gt;&amp;amp;&lt;/span&gt;health.HealthCheckRequest{Service: &lt;span style="color:#2aa198"&gt;&amp;#34;greet.GreetService&amp;#34;&lt;/span&gt;}, client.&lt;span style="color:#268bd2"&gt;WithCheck&lt;/span&gt;(&lt;span style="color:#cb4b16"&gt;false&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item><item><title>filter拦截器</title><link>https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/tutorial/rpc/filter/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://dubbo.apache.org/zh-cn/overview/mannual/golang-sdk/tutorial/rpc/filter/</guid><description>&lt;p&gt;Filter 过滤器动态拦截请求（request）或响应（response）以转换或使用请求或响应中包含的信息。过滤器本身通常不会创建响应，而是提供可以“附加”到任何一次 RPC 请求的通用函数。Dubbo Filter 是可插拔的，我们可以在一次 RPC 请求中插入任意类型的、任意多个 Filter。&lt;/p&gt;
&lt;p&gt;Filter 工作原理如下图所示：&lt;/p&gt;
&lt;img style="max-width:800px;height:auto;" src="https://dubbo.apache.org/imgs/v3/tasks/framework/filter.png"/&gt;
&lt;h2 id="使用方式"&gt;使用方式&lt;/h2&gt;
&lt;h3 id="1-filter-拦截器概念"&gt;1. Filter 拦截器概念&lt;/h3&gt;
&lt;p&gt;Filter 定义如下：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#586e75"&gt;// Filter interface defines the functions of a filter&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#586e75"&gt;// Extension - Filter&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;type&lt;/span&gt; Filter &lt;span style="color:#268bd2"&gt;interface&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#586e75"&gt;// Invoke is the core function of a filter, it determines the process of the filter&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#268bd2"&gt;Invoke&lt;/span&gt;(context.Context, protocol.Invoker, protocol.Invocation) protocol.Result
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#586e75"&gt;// OnResponse updates the results from Invoke and then returns the modified results.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;	&lt;span style="color:#268bd2"&gt;OnResponse&lt;/span&gt;(context.Context, protocol.Result, protocol.Invoker, protocol.Invocation) protocol.Result
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Filter 可以加载在 Consumer 端或者 Provider端。当加载在 Consumer 端，其Invoke函数调用的下游为网络层，OnResponse 为请求结束从网络层获取到返回结果后被调用。当加载在 Provider 端，其 Invoke 函数调用的下游为用户代码，OnResponse 为用户代码执行结束后向下传递至网络层前被调用。&lt;/p&gt;</description></item></channel></rss>