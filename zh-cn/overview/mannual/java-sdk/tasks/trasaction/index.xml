<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>分布式事务 on Apache Dubbo</title><link>https://dubbo.apache.org/zh-cn/overview/mannual/java-sdk/tasks/trasaction/</link><description>Recent content in 分布式事务 on Apache Dubbo</description><generator>Hugo</generator><language>zh-cn</language><atom:link href="https://dubbo.apache.org/zh-cn/overview/mannual/java-sdk/tasks/trasaction/index.xml" rel="self" type="application/rss+xml"/><item><title>使用 Seata 支持分布式事务</title><link>https://dubbo.apache.org/zh-cn/overview/mannual/java-sdk/tasks/trasaction/distributed-transaction/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://dubbo.apache.org/zh-cn/overview/mannual/java-sdk/tasks/trasaction/distributed-transaction/</guid><description>&lt;p&gt;本示例演示如何使用 Apache Seata 实现 Dubbo 分布式事务功能，保证数据一致性。&lt;/p&gt;
&lt;p&gt;Apache Seata 是一款开源的分布式事务解决方案，致力于在微服务架构下提供高性能和简单易用的分布式事务服务。
在Dubbo中集成Seata实现分布式事务非常方便，只需简单几步即可完成，本文将通过一个示例带你快速体验，示例总体架构图如下：&lt;/p&gt;
&lt;p&gt;&lt;img src="https://dubbo.apache.org/imgs/docs3-v2/java-sdk/seata/flow.png" alt="seata-flow"&gt;&lt;/p&gt;
&lt;p&gt;开始前，请先完成以下内容:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;下载示例源码&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-shell" data-lang="shell"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;git clone --depth&lt;span style="color:#719e07"&gt;=&lt;/span&gt;&lt;span style="color:#2aa198"&gt;1&lt;/span&gt; https://github.com/apache/dubbo-samples.git
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;进入示例源码目录：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-shell" data-lang="shell"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#b58900"&gt;cd&lt;/span&gt; dubbo-samples/2-advanced/dubbo-samples-seata
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;下载最新版的&lt;a href="https://seata.apache.org/zh-cn/unversioned/download/seata-server"&gt;seata-server二进制包&lt;/a&gt;至本地。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="步骤-1建立数据库并初始化相关测试数据"&gt;步骤 1：建立数据库并初始化相关测试数据&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;本文将使用MySQL 5.7 (更多支持的数据库可在文末查看附录)。
进入dubbo-samples-seata的script目录，找到dubbo_biz.sql和undo_log.sql两个数据库脚本文件，内容如下:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;undo_log.sql是Seata AT 模式需要 &lt;code&gt;UNDO_LOG&lt;/code&gt; 表&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#586e75"&gt;-- for AT mode you must to init this sql for you business database. the seata server not need it.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#586e75"&gt;&lt;/span&gt;&lt;span style="color:#719e07"&gt;CREATE&lt;/span&gt; &lt;span style="color:#719e07"&gt;TABLE&lt;/span&gt; &lt;span style="color:#719e07"&gt;IF&lt;/span&gt; &lt;span style="color:#719e07"&gt;NOT&lt;/span&gt; &lt;span style="color:#719e07"&gt;EXISTS&lt;/span&gt; &lt;span style="color:#719e07"&gt;`&lt;/span&gt;undo_log&lt;span style="color:#719e07"&gt;`&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#719e07"&gt;`&lt;/span&gt;branch_id&lt;span style="color:#719e07"&gt;`&lt;/span&gt; &lt;span style="color:#b58900"&gt;BIGINT&lt;/span&gt; &lt;span style="color:#719e07"&gt;NOT&lt;/span&gt; &lt;span style="color:#719e07"&gt;NULL&lt;/span&gt; &lt;span style="color:#719e07"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#2aa198"&gt;&amp;#39;branch transaction id&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#719e07"&gt;`&lt;/span&gt;xid&lt;span style="color:#719e07"&gt;`&lt;/span&gt; &lt;span style="color:#b58900"&gt;VARCHAR&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;128&lt;/span&gt;) &lt;span style="color:#719e07"&gt;NOT&lt;/span&gt; &lt;span style="color:#719e07"&gt;NULL&lt;/span&gt; &lt;span style="color:#719e07"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#2aa198"&gt;&amp;#39;global transaction id&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#719e07"&gt;`&lt;/span&gt;context&lt;span style="color:#719e07"&gt;`&lt;/span&gt; &lt;span style="color:#b58900"&gt;VARCHAR&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;128&lt;/span&gt;) &lt;span style="color:#719e07"&gt;NOT&lt;/span&gt; &lt;span style="color:#719e07"&gt;NULL&lt;/span&gt; &lt;span style="color:#719e07"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#2aa198"&gt;&amp;#39;undo_log context,such as serialization&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#719e07"&gt;`&lt;/span&gt;rollback_info&lt;span style="color:#719e07"&gt;`&lt;/span&gt; LONGBLOB &lt;span style="color:#719e07"&gt;NOT&lt;/span&gt; &lt;span style="color:#719e07"&gt;NULL&lt;/span&gt; &lt;span style="color:#719e07"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#2aa198"&gt;&amp;#39;rollback info&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#719e07"&gt;`&lt;/span&gt;log_status&lt;span style="color:#719e07"&gt;`&lt;/span&gt; &lt;span style="color:#b58900"&gt;INT&lt;/span&gt;(&lt;span style="color:#2aa198"&gt;11&lt;/span&gt;) &lt;span style="color:#719e07"&gt;NOT&lt;/span&gt; &lt;span style="color:#719e07"&gt;NULL&lt;/span&gt; &lt;span style="color:#719e07"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#2aa198"&gt;&amp;#39;0:normal status,1:defense status&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#719e07"&gt;`&lt;/span&gt;log_created&lt;span style="color:#719e07"&gt;`&lt;/span&gt; DATETIME(&lt;span style="color:#2aa198"&gt;6&lt;/span&gt;) &lt;span style="color:#719e07"&gt;NOT&lt;/span&gt; &lt;span style="color:#719e07"&gt;NULL&lt;/span&gt; &lt;span style="color:#719e07"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#2aa198"&gt;&amp;#39;create datetime&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#719e07"&gt;`&lt;/span&gt;log_modified&lt;span style="color:#719e07"&gt;`&lt;/span&gt; DATETIME(&lt;span style="color:#2aa198"&gt;6&lt;/span&gt;) &lt;span style="color:#719e07"&gt;NOT&lt;/span&gt; &lt;span style="color:#719e07"&gt;NULL&lt;/span&gt; &lt;span style="color:#719e07"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#2aa198"&gt;&amp;#39;modify datetime&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#719e07"&gt;UNIQUE&lt;/span&gt; &lt;span style="color:#719e07"&gt;KEY&lt;/span&gt; &lt;span style="color:#719e07"&gt;`&lt;/span&gt;ux_undo_log&lt;span style="color:#719e07"&gt;`&lt;/span&gt; (&lt;span style="color:#719e07"&gt;`&lt;/span&gt;xid&lt;span style="color:#719e07"&gt;`&lt;/span&gt;, &lt;span style="color:#719e07"&gt;`&lt;/span&gt;branch_id&lt;span style="color:#719e07"&gt;`&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ) ENGINE &lt;span style="color:#719e07"&gt;=&lt;/span&gt; InnoDB AUTO_INCREMENT &lt;span style="color:#719e07"&gt;=&lt;/span&gt; &lt;span style="color:#2aa198"&gt;1&lt;/span&gt; &lt;span style="color:#719e07"&gt;DEFAULT&lt;/span&gt; CHARSET &lt;span style="color:#719e07"&gt;=&lt;/span&gt; utf8mb4 &lt;span style="color:#719e07"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#719e07"&gt;=&lt;/span&gt;&lt;span style="color:#2aa198"&gt;&amp;#39;AT transaction mode undo table&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#719e07"&gt;ALTER&lt;/span&gt; &lt;span style="color:#719e07"&gt;TABLE&lt;/span&gt; &lt;span style="color:#719e07"&gt;`&lt;/span&gt;undo_log&lt;span style="color:#719e07"&gt;`&lt;/span&gt; &lt;span style="color:#719e07"&gt;ADD&lt;/span&gt; &lt;span style="color:#719e07"&gt;INDEX&lt;/span&gt; &lt;span style="color:#719e07"&gt;`&lt;/span&gt;ix_log_created&lt;span style="color:#719e07"&gt;`&lt;/span&gt; (&lt;span style="color:#719e07"&gt;`&lt;/span&gt;log_created&lt;span style="color:#719e07"&gt;`&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;dubbo_biz.sql是示例业务表以及初始化数据&lt;/p&gt;</description></item></channel></rss>