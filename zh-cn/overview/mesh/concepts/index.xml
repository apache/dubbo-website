<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>核心功能 on Apache Dubbo</title><link>https://cn.dubbo.apache.org/zh-cn/overview/mesh/concepts/</link><description>Recent content in 核心功能 on Apache Dubbo</description><generator>Hugo</generator><language>zh-cn</language><atom:link href="https://cn.dubbo.apache.org/zh-cn/overview/mesh/concepts/index.xml" rel="self" type="application/rss+xml"/><item><title>流量管理</title><link>https://cn.dubbo.apache.org/zh-cn/overview/mesh/concepts/traffic-management/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://cn.dubbo.apache.org/zh-cn/overview/mesh/concepts/traffic-management/</guid><description>&lt;blockquote&gt;
&lt;p&gt;目前服务网格处于初步实验阶段。资源命名可能会出现变化。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="介绍"&gt;介绍&lt;/h2&gt;
&lt;p&gt;Dubbo 服务网格的流量管理模型与 Istio 保持一致，但针对 Dubbo 协议和无 Sidecar 架构进行了优化。核心组件包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ServiceRoute&lt;/strong&gt;：定义路由规则，控制请求如何路由到服务实例&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SubsetRule&lt;/strong&gt;：定义服务子集和流量策略，如负载均衡、连接池、TLS 设置等&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;通过配置这些资源，您可以实现流量路由、负载均衡、故障恢复等功能，而无需修改应用程序代码。&lt;/p&gt;
&lt;h2 id="服务路由"&gt;服务路由&lt;/h2&gt;
&lt;p&gt;ServiceRoute 是 Dubbo 服务网格中用于定义路由规则的核心资源，对应 Istio 的 VirtualService。它允许您配置如何将请求路由到服务的不同版本或实例。&lt;/p&gt;
&lt;p&gt;服务路由让您能够：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;将流量路由到服务的不同版本（如 v1、v2）&lt;/li&gt;
&lt;li&gt;基于请求属性（如头信息、路径）进行路由&lt;/li&gt;
&lt;li&gt;配置权重路由，实现流量分割和灰度发布&lt;/li&gt;
&lt;li&gt;配置超时、重试等故障恢复策略&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="服务路由示例"&gt;服务路由示例&lt;/h3&gt;
&lt;p&gt;以下示例展示了如何配置 ServiceRoute 来实现流量分割：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-yaml" data-lang="yaml"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;apiVersion&lt;/span&gt;: networking.dubbo.apache.org/v1
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;kind&lt;/span&gt;: ServiceRoute
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;metadata&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#268bd2"&gt;name&lt;/span&gt;: provider-weights
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#268bd2"&gt;namespace&lt;/span&gt;: grpc-app
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#268bd2"&gt;spec&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#268bd2"&gt;hosts&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; - provider.grpc-app.svc.cluster.local
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#268bd2"&gt;http&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; - &lt;span style="color:#268bd2"&gt;route&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; - &lt;span style="color:#268bd2"&gt;destination&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#268bd2"&gt;host&lt;/span&gt;: provider.grpc-app.svc.cluster.local
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#268bd2"&gt;subset&lt;/span&gt;: v1
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#268bd2"&gt;weight&lt;/span&gt;: &lt;span style="color:#2aa198"&gt;10&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; - &lt;span style="color:#268bd2"&gt;destination&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#268bd2"&gt;host&lt;/span&gt;: provider.grpc-app.svc.cluster.local
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#268bd2"&gt;subset&lt;/span&gt;: v2
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#268bd2"&gt;weight&lt;/span&gt;: &lt;span style="color:#2aa198"&gt;90&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="hosts-字段"&gt;hosts 字段&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;hosts&lt;/code&gt; 字段指定了 ServiceRoute 应用到的服务。可以使用完全限定域名（FQDN）或短名称。控制平面会自动将短名称解析为 FQDN。&lt;/p&gt;</description></item><item><title>安全</title><link>https://cn.dubbo.apache.org/zh-cn/overview/mesh/concepts/security/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://cn.dubbo.apache.org/zh-cn/overview/mesh/concepts/security/</guid><description>&lt;blockquote&gt;
&lt;p&gt;目前服务网格处于初步实验阶段。后续标准功能将逐步完善和支持。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="高层架构"&gt;高层架构&lt;/h2&gt;
&lt;p&gt;Dubbo 服务网格的安全架构包括两个核心组件：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;身份&lt;/strong&gt;：每个工作负载都有一个身份，用于标识其来源&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;认证&lt;/strong&gt;：认证策略定义了服务之间如何相互认证&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这些组件协同工作，为您的服务网格提供安全防护。&lt;/p&gt;
&lt;h2 id="dubbo-身份"&gt;Dubbo 身份&lt;/h2&gt;
&lt;p&gt;在 Dubbo 服务网格中，每个工作负载都有一个身份，用于标识其来源。身份基于 SPIFFE 标准，使用 SPIFFE URI 格式：&lt;code&gt;spiffe://&amp;lt;trust-domain&amp;gt;/ns/&amp;lt;namespace&amp;gt;/sa/&amp;lt;service-account&amp;gt;&lt;/code&gt;。&lt;/p&gt;
&lt;h3 id="身份格式"&gt;身份格式&lt;/h3&gt;
&lt;p&gt;Dubbo 身份由以下部分组成：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;信任域（Trust Domain）&lt;/strong&gt;：标识网格或组织边界，默认值为 &lt;code&gt;cluster.local&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;命名空间（Namespace）&lt;/strong&gt;：Kubernetes 命名空间&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;服务账户（Service Account）&lt;/strong&gt;：Kubernetes ServiceAccount&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;例如，在 &lt;code&gt;default&lt;/code&gt; 命名空间中运行的服务账户 &lt;code&gt;bookinfo-productpage&lt;/code&gt; 的身份为：
&lt;code&gt;spiffe://cluster.local/ns/default/sa/bookinfo-productpage&lt;/code&gt;&lt;/p&gt;
&lt;h3 id="信任域别名"&gt;信任域别名&lt;/h3&gt;
&lt;p&gt;Dubbo 服务网格支持信任域别名（Trust Domain Aliases），允许一个网格信任来自多个信任域的工作负载。这在跨集群或多租户场景中非常有用。通过 MeshConfig 中的 &lt;code&gt;TrustDomainAliases&lt;/code&gt; 配置，可以为给定身份自动补全多信任域变体。&lt;/p&gt;
&lt;h2 id="身份和证书管理"&gt;身份和证书管理&lt;/h2&gt;
&lt;p&gt;Dubbo 服务网格使用 SPIFFE 标准来管理工作负载身份和证书。每个工作负载都会自动获得一个 SPIFFE 身份，并可以获取相应的 X.509 证书用于双向 TLS 认证。&lt;/p&gt;
&lt;h3 id="证书颁发"&gt;证书颁发&lt;/h3&gt;
&lt;p&gt;Dubbo 控制平面包含一个证书颁发机构（CA），用于为工作负载颁发证书。工作负载通过 Dubbo Agent 与控制平面通信，请求证书并定期轮转。&lt;/p&gt;
&lt;h3 id="证书存储"&gt;证书存储&lt;/h3&gt;
&lt;p&gt;工作负载证书存储在以下位置：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;证书链：&lt;code&gt;./etc/certs/cert-chain.pem&lt;/code&gt; 或 &lt;code&gt;./var/run/secrets/workload-spiffe-uds/credentials/cert-chain.pem&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;私钥：&lt;code&gt;./etc/certs/key.pem&lt;/code&gt; 或 &lt;code&gt;./var/run/secrets/workload-spiffe-uds/credentials/key.pem&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;根证书：&lt;code&gt;./etc/certs/root-cert.pem&lt;/code&gt; 或 &lt;code&gt;./var/run/secrets/workload-spiffe-uds/credentials/root-cert.pem&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;证书可以通过 SDS（Secret Discovery Service）或文件挂载方式下发到工作负载。&lt;/p&gt;</description></item><item><title>可观测性</title><link>https://cn.dubbo.apache.org/zh-cn/overview/mesh/concepts/observability/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://cn.dubbo.apache.org/zh-cn/overview/mesh/concepts/observability/</guid><description>&lt;p&gt;敬请期待&lt;/p&gt;</description></item></channel></rss>